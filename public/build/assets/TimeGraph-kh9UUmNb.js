import{_ as S}from"./AuthenticatedLayout.vue_vue_type_script_setup_true_lang-BSKq9_hP.js";import{d as T,r as c,o as B,c as i,q as D,e as h,b,f as t,u as g,h as N,j as $,t as y,a as l,g as o,i as L}from"./app-D4sziTso.js";import{a as z}from"./api-ttKFNz3H.js";import{C as A,a as E,L as M,B as V,c as j,d as G,e as H}from"./index-Docp_qGx.js";const R={class:"py-6"},W={class:"mx-auto max-w-7xl sm:px-6 lg:px-8"},q={class:"overflow-hidden bg-white shadow-sm sm:rounded-lg"},O={class:"border-b border-gray-200 px-6 py-4 flex items-center justify-between"},P={class:"mt-1 text-sm text-gray-500"},U={class:"font-mono"},F=["disabled"],I={key:0},J={key:1},K={class:"px-6 py-4"},Q={key:0,class:"mb-4 rounded-md bg-red-50 p-4 text-sm text-red-700"},X={key:1,class:"flex items-center justify-center py-16"},Y={key:2,class:"space-y-4"},Z={key:0,class:"py-10 text-center text-sm text-gray-500"},ee={key:1,class:"h-96 w-full"},re=T({__name:"TimeGraph",setup(te){A.register(E,M,V,j,G);const r=c(!0),d=c(null),n=c([]),m=c("Asia/Manila"),f=async()=>{var a,e;r.value=!0,d.value=null;try{const{data:s}=await z.get("/my/time-graph",{params:{days:5}});n.value=s.days||[],m.value=s.timezone||"Asia/Manila"}catch(s){console.error(s),d.value=((e=(a=s==null?void 0:s.response)==null?void 0:a.data)==null?void 0:e.error)||"Unable to load time graph data. Please try again."}finally{r.value=!1}};B(f);const x=i(()=>n.value.map(a=>a.label)),v=i(()=>({label:"Shift",data:n.value.map(e=>e.shift?{x:[e.shift.start_hour,e.shift.end_hour],y:e.label}:{x:[0,0],y:e.label}),backgroundColor:"rgba(59, 130, 246, 0.4)",borderColor:"rgba(59, 130, 246, 1)",borderWidth:1,borderSkipped:!1,parsing:!1})),_=i(()=>{const a=[];return n.value.forEach(e=>{e.tasks.forEach(s=>{a.push({x:[s.start_hour,s.end_hour],y:e.label,title:s.title})})}),{label:"Tasks",data:a,backgroundColor:"rgba(16, 185, 129, 0.7)",borderColor:"rgba(5, 150, 105, 1)",borderWidth:1,borderSkipped:!1,parsing:!1}}),k=i(()=>({labels:x.value,datasets:[v.value,_.value]})),u=a=>{const e=(a%24+24)%24,s=Math.floor(e),p=s>=12?"pm":"am";return`${(s+11)%12+1}:00 ${p}`},w=i(()=>({indexAxis:"y",responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top"},tooltip:{callbacks:{label:a=>{const e=a.raw,[s,p]=e.x;return`${e.title||a.dataset.label||""}: ${u(s)} – ${u(p)}`}}}},scales:{x:{type:"linear",min:0,max:24,title:{display:!0,text:"Hours"},ticks:{stepSize:2,callback:a=>u(Number(a))}},y:{title:{display:!0,text:"Dates"}}}}));return(a,e)=>(o(),D(S,null,{header:h(()=>[...e[0]||(e[0]=[t("h2",{class:"text-xl font-semibold leading-tight text-gray-800"}," Time Graph ",-1)])]),default:h(()=>[b(g(N),{title:"Time Graph"}),t("div",R,[t("div",W,[t("div",q,[t("div",O,[t("div",null,[e[2]||(e[2]=t("h3",{class:"text-lg font-medium text-gray-900"}," Shift and Task Schedule ",-1)),t("p",P,[e[1]||(e[1]=$(" Last 5 days · Timezone: ",-1)),t("span",U,y(m.value),1)])]),t("button",{type:"button",class:"inline-flex items-center rounded-md bg-indigo-600 px-4 py-2 text-sm font-medium text-white shadow-sm hover:bg-indigo-500 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2",onClick:f,disabled:r.value},[r.value?(o(),l("span",J,"Loading…")):(o(),l("span",I,"Refresh"))],8,F)]),t("div",K,[d.value?(o(),l("div",Q,y(d.value),1)):L("",!0),r.value?(o(),l("div",X,[...e[3]||(e[3]=[t("div",{class:"inline-block h-10 w-10 animate-spin rounded-full border-b-2 border-indigo-600"},null,-1)])])):(o(),l("div",Y,[n.value.length===0?(o(),l("div",Z," No data available for the selected period. ")):(o(),l("div",ee,[b(g(H),{data:k.value,options:w.value},null,8,["data","options"])])),e[4]||(e[4]=t("div",{class:"flex items-center gap-4 text-sm text-gray-600"},[t("div",{class:"flex items-center gap-2"},[t("span",{class:"inline-block h-3 w-6 rounded-sm bg-sky-400 border border-sky-600"}),t("span",null,"Shift")]),t("div",{class:"flex items-center gap-2"},[t("span",{class:"inline-block h-3 w-6 rounded-sm bg-emerald-500 border border-emerald-700"}),t("span",null,"Task")])],-1))]))])])])])]),_:1}))}});export{re as default};
