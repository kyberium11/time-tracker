import{d as We,r as x,c as T,o as Ae,A as Fe,B as Ve,a as i,b as le,u as Re,h as ze,e as ie,f as e,i as f,g as r,n as R,t as l,j as mt,l as z,F as L,k as B,v as Mt,m as Ct,x as qe}from"./app-z0t24Ybv.js";import{_ as Ye}from"./AuthenticatedLayout.vue_vue_type_script_setup_true_lang-Dg1nimb3.js";import{a as _}from"./api-B_u7JBsw.js";const Ze={class:"py-12"},Ge={class:"mx-auto max-w-[95%] sm:px-6 lg:px-8"},Je={key:0,class:"border-b border-gray-200 mb-6"},Ke={class:"-mb-px flex space-x-8"},Qe={key:1},Xe={key:0,class:"mb-6 grid gap-4 md:grid-cols-3"},ts={class:"overflow-hidden bg-white shadow sm:rounded-lg"},es={class:"px-4 py-5 sm:p-6"},ss={class:"mt-2 text-3xl font-bold text-gray-900"},as={class:"text-xs text-gray-500"},os={key:0,class:"mt-2"},ns={class:"text-sm text-gray-600"},ls={class:"font-semibold"},is={class:"mt-4 flex flex-wrap gap-2"},rs=["disabled"],ds=["disabled"],us={class:"overflow-hidden bg-white shadow sm:rounded-lg"},cs={class:"px-4 py-5 sm:p-6"},ms={key:0,class:"mt-2"},ps={class:"text-2xl font-bold text-gray-900 mt-1"},xs={key:0,class:"text-sm font-normal text-gray-500"},gs={class:"mt-3"},vs=["disabled"],ys={key:1,class:"mt-2"},fs={class:"flex items-center gap-2 w-full"},hs=["value"],ks=["disabled"],bs={key:0,class:"text-sm text-gray-500 mt-2"},_s={class:"overflow-hidden bg-white shadow sm:rounded-lg"},ws={class:"px-4 py-5 sm:p-6"},Ss={class:"mt-2 text-3xl font-bold text-gray-900"},Ts={key:1,class:"mb-6 overflow-hidden bg-white shadow sm:rounded-lg"},Ds={class:"px-4 py-5 sm:p-6"},Ms={class:"flex items-center justify-between mb-4"},Cs=["disabled"],Ns={class:"overflow-x-auto"},$s={class:"min-w-full divide-y divide-gray-200"},Ls={class:"divide-y divide-gray-200 bg-white"},Es={class:"px-4 py-4 text-sm text-gray-900"},Is={class:"px-4 py-4 text-sm text-gray-500"},Bs={class:"px-4 py-4 text-sm text-gray-500"},Us={class:"px-4 py-4 text-sm text-gray-500"},Ps={key:0},js={key:2,class:"mb-6 overflow-hidden bg-white shadow sm:rounded-lg"},Hs={class:"px-4 py-5 sm:p-6"},Os={class:"flex items-center justify-between mb-3"},Ws={class:"flex items-center gap-2"},As=["disabled"],Fs={key:0,class:"h-3 w-3 rounded-full border-2 border-white border-t-transparent animate-spin"},Vs=["value"],Rs={class:"overflow-x-auto"},zs={class:"min-w-full divide-y divide-gray-200"},qs={class:"divide-y divide-gray-200 bg-white"},Ys={class:"whitespace-nowrap px-6 py-4 text-sm text-indigo-600"},Zs=["onClick"],Gs={class:"whitespace-nowrap px-6 py-4 text-sm text-gray-900"},Js={class:"whitespace-nowrap px-6 py-4 text-sm text-gray-900"},Ks={class:"whitespace-nowrap px-6 py-4 text-sm"},Qs={key:1,class:"text-sm text-gray-700"},Xs={class:"whitespace-nowrap px-6 py-4 text-sm text-gray-900"},ta={class:"whitespace-nowrap px-6 py-4 text-sm text-gray-500"},ea={class:"whitespace-nowrap px-6 py-4 text-sm"},sa={class:"whitespace-nowrap px-6 py-4 text-sm text-gray-900"},aa={class:"flex items-center space-x-2"},oa=["onClick","disabled","aria-label"],na={key:0,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",class:"h-4 w-4"},la={key:1,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",class:"h-4 w-4"},ia=["value","onChange"],ra=["value"],da={key:0,value:"complete"},ua={key:1,value:"done"},ca={class:"flex items-center justify-between px-6 py-3 text-sm text-gray-600"},ma={class:"space-x-2"},pa=["disabled"],xa=["disabled"],ga={class:"overflow-hidden bg-white shadow sm:rounded-lg"},va={class:"px-4 py-5 sm:p-6"},ya={key:0,class:"text-center py-8 text-gray-500"},fa={key:1,class:"overflow-x-auto"},ha={class:"min-w-full divide-y divide-gray-200"},ka={class:"divide-y divide-gray-200"},ba={class:"px-4 py-4 text-sm text-gray-900"},_a={class:"px-4 py-4 text-sm text-gray-500"},wa={class:"px-4 py-4 text-sm text-gray-500"},Sa={class:"px-4 py-4 text-sm text-gray-900 font-semibold"},Ta={class:"px-4 py-4 text-sm text-gray-500"},Da={class:"px-4 py-4 text-sm text-gray-500"},Ma={key:2,class:"space-y-6"},Ca={class:"bg-white shadow rounded-lg p-4"},Na={class:"grid gap-4 sm:grid-cols-2"},$a={class:"bg-white shadow rounded-lg p-5"},La={class:"grid gap-4 sm:grid-cols-3 lg:grid-cols-5 text-sm"},Ea={class:"font-semibold"},Ia={class:"font-semibold"},Ba={class:"font-semibold"},Ua={class:"font-semibold"},Pa={class:"bg-white shadow rounded-lg"},ja={class:"overflow-x-auto"},Ha={class:"min-w-full divide-y divide-gray-200"},Oa={class:"divide-y divide-gray-200"},Wa={class:"px-4 py-4 text-sm text-gray-900"},Aa={class:"px-4 py-4 text-sm text-gray-500"},Fa={class:"px-4 py-4 text-sm text-gray-500"},Va={class:"px-4 py-4 text-sm text-gray-900 font-semibold"},Ra={class:"px-4 py-4 text-sm text-gray-500"},za={class:"px-4 py-4 text-sm text-gray-500"},qa={key:0},Ya={key:0,class:"text-center py-8"},Za={key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50"},Ga={class:"w-full max-w-2xl rounded-lg bg-white shadow-lg"},Ja={class:"flex items-center justify-between border-b px-4 py-3"},Ka={class:"p-4"},Qa={key:0,class:"text-gray-500 text-sm"},Xa={key:1,class:"overflow-x-auto"},to={class:"min-w-full divide-y divide-gray-200"},eo={class:"divide-y divide-gray-200 bg-white"},so={class:"px-4 py-2 text-sm text-gray-900"},ao={class:"px-4 py-2 text-sm text-gray-700"},oo={class:"px-4 py-2 text-sm text-gray-700"},no={class:"px-4 py-2 text-sm text-gray-700 font-semibold"},lo={class:"px-4 py-2 text-sm text-gray-700"},io={class:"px-4 py-2 text-sm text-gray-700"},ro={key:1,class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50"},uo={class:"w-full max-w-lg rounded-lg bg-white shadow-xl"},co={class:"flex items-center justify-between border-b px-5 py-3"},mo={class:"p-5 space-y-4 text-sm text-gray-700"},po={key:0,class:"flex items-center gap-2 text-sm text-gray-500"},xo={key:1,class:"rounded-md border border-red-200 bg-red-50 p-3 text-sm text-red-700 space-y-3"},go={class:"flex flex-wrap gap-2"},vo={key:2,class:"rounded-md border border-amber-200 bg-amber-50 p-3 text-sm text-amber-900 space-y-3"},yo={key:3,class:"space-y-3"},fo={class:"flex items-center justify-between text-xs text-gray-500"},ho={class:"max-h-72 overflow-y-auto space-y-2 pr-1"},ko=["value"],bo={class:"font-medium text-gray-900"},_o={class:"text-xs text-gray-500"},wo={key:0,class:"text-xs text-gray-500"},So={class:"flex flex-wrap items-center justify-between gap-3 border-t bg-gray-50 px-5 py-3 text-xs text-gray-500"},To={class:"flex items-center gap-2 text-sm"},Do=["disabled"],Mo={key:0,class:"h-3 w-3 rounded-full border-2 border-white border-t-transparent animate-spin"},Co={key:2,class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50"},No={class:"w-full max-w-3xl rounded-lg bg-white shadow-lg"},$o={class:"p-5 text-sm text-gray-700 space-y-5"},Lo={class:"space-y-1"},Eo={key:0,class:"text-xs text-gray-500"},Io={class:"font-medium text-gray-600"},Bo={class:"grid gap-3 sm:grid-cols-2 lg:grid-cols-5"},Uo={class:"rounded-md bg-indigo-50 px-4 py-3"},Po={class:"text-xl font-semibold text-indigo-900"},jo={class:"rounded-md bg-green-50 px-4 py-3"},Ho={class:"text-xl font-semibold text-green-900"},Oo={class:"rounded-md bg-blue-50 px-4 py-3"},Wo={class:"text-xl font-semibold text-blue-900"},Ao={class:"rounded-md bg-gray-100 px-4 py-3"},Fo={class:"text-xl font-semibold text-gray-900"},Vo={class:"rounded-md bg-amber-50 px-4 py-3"},Ro={class:"text-xl font-semibold text-amber-900"},zo={key:0,class:"space-y-2"},qo={class:"max-h-48 overflow-y-auto space-y-2 pr-1"},Yo={class:"flex items-start justify-between gap-3"},Zo={class:"font-medium text-green-900 leading-tight"},Go={class:"text-xs text-green-700 whitespace-nowrap"},Jo={class:"mt-1 flex flex-wrap gap-3 text-xs text-green-800"},Ko={key:0},Qo={key:1},Xo={key:1,class:"space-y-2"},tn={class:"max-h-48 overflow-y-auto space-y-2 pr-1"},en={class:"flex items-start justify-between gap-3"},sn={class:"font-medium text-blue-900 leading-tight"},an={class:"text-xs text-blue-700 whitespace-nowrap"},on={class:"mt-1 flex flex-wrap gap-3 text-xs text-blue-800"},nn={key:0},ln={key:1},rn={key:2,class:"space-y-2"},dn={class:"max-h-40 overflow-y-auto space-y-1 pr-1"},un={class:"flex items-start justify-between gap-3"},cn={class:"font-medium leading-tight"},mn={class:"text-amber-700"},pn={key:3,class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50"},xn={class:"w-full max-w-3xl max-h-[90vh] rounded-lg bg-white shadow-lg flex flex-col"},gn={class:"flex items-center justify-between border-b px-4 py-3 flex-shrink-0"},vn={key:0,class:"p-6 text-sm text-gray-700 overflow-y-auto flex-1"},yn={class:"mb-4 pb-4 border-b"},fn={class:"font-semibold text-lg text-gray-900 mb-2"},hn={class:"flex items-center gap-3 flex-wrap"},kn={key:0,class:"text-sm"},bn={key:1,class:"ml-1 text-gray-700"},_n={key:1},wn=["href"],Sn={key:0,class:"task-content"},Tn=["innerHTML"],Dn={key:1,class:"text-gray-500 italic"},Ln=We({__name:"Dashboard",setup(Mn){const v=x(null),D=x(!1),tt=x(""),K=x(new Date),O=x("employee"),q=x([]),lt=x(null),w=x(null),Nt=x(!1),Wt=x([]),$t=x(0),Y=x([]),E=x(null),pt=x(!1),Lt=x(!1),U=x(!1),M=x(null),et=x(!1),st=x(!1),xt=x(null),W=x([]),S=x([]),At=T(()=>W.value.length>0),Ft=T(()=>At.value&&S.value.length===W.value.length),at=x("dashboard"),Q=x(""),Vt=x([]),gt=x(!1),P=x({workSeconds:0,breakSeconds:0,lunchSeconds:0,tasksCount:0,status:"No Entry",overtimeSeconds:0}),$=x([]),Et=x(""),X=x(1),it=x(10),vt=x("all"),yt=T(()=>{const s=new Set;return(q.value||[]).forEach(t=>{const o=(t.status||"").toString().trim();o&&s.add(o)}),Array.from(s).sort((t,o)=>t.localeCompare(o))}),ft=x("all"),ht=x(""),kt=x(""),It=T(()=>{const s=Et.value.trim().toLowerCase();let t=q.value;if(vt.value!=="all"){const o=vt.value.toLowerCase();t=t.filter(n=>(n.status||"").toLowerCase()===o)}if(ft.value!=="all"){const o=ft.value;t=t.filter(n=>(n.priority||"none").toLowerCase()===o)}if(ht.value){const o=new Date(ht.value).getTime();t=t.filter(n=>n.due_date?new Date(n.due_date).getTime()>=o:!1)}if(kt.value){const o=new Date(kt.value).getTime();t=t.filter(n=>n.due_date?new Date(n.due_date).getTime()<=o:!1)}return s?t.filter(o=>(o.title||"").toLowerCase().includes(s)):t}),bt=T(()=>Math.max(1,Math.ceil(It.value.length/it.value))),re=T(()=>{const t=(Math.min(X.value,bt.value)-1)*it.value;return It.value.slice(t,t+it.value)}),Z=s=>{const t=Math.max(1,Math.min(s,bt.value));X.value=t},_t=x([]),wt=x(!1),Bt=async()=>{var s;wt.value=!0;try{const t=await _.get("/admin/analytics/activity-logs",{params:{limit:100}});_t.value=((s=t.data)==null?void 0:s.data)||[]}catch{_t.value=[]}finally{wt.value=!1}};let Ut=null,rt=null;const St=x(!1),Tt=x(!1),dt=x(!1),Pt=x(!1),A=T(()=>{var s,t;return!!((s=v.value)!=null&&s.clock_in)&&!((t=v.value)!=null&&t.clock_out)}),j=T(()=>{var s,t;return!!((s=v.value)!=null&&s.break_start)&&!((t=v.value)!=null&&t.break_end)}),de=T(()=>{var s,t;return((s=v.value)==null?void 0:s.lunch_start)&&!((t=v.value)!=null&&t.lunch_end)}),Dt=T(()=>{const s=[];if(!v.value)return s;const t=v.value;if(t.clock_in&&t.clock_out){const o=Math.max(0,Math.floor((new Date(t.clock_out).getTime()-new Date(t.clock_in).getTime())/1e3)),n=t.break_start?new Date(t.break_start):null,d=t.break_end?new Date(t.break_end):null;let u=0;n&&d&&(u=Math.max(0,Math.floor((d.getTime()-n.getTime())/1e3)));const y=Math.max(0,o-u);s.push({name:"Work Hours",start:t.clock_in,end:t.clock_out,durationSeconds:y,breakDurationSeconds:u,notes:"-"})}if(t.break_start&&t.break_end){const o=Math.max(0,Math.floor((new Date(t.break_end).getTime()-new Date(t.break_start).getTime())/1e3));s.push({name:"Break",start:t.break_start,end:t.break_end,durationSeconds:o,breakDurationSeconds:o,notes:"-"})}return Y.value.forEach(o=>{var n;if(o.clock_in&&o.clock_out){const d=Math.max(0,Math.floor((new Date(o.clock_out).getTime()-new Date(o.clock_in).getTime())/1e3));s.push({name:((n=o.task)==null?void 0:n.title)||`Task #${o.task_id}`,start:o.clock_in,end:o.clock_out,durationSeconds:d,breakDurationSeconds:0,notes:"-"})}}),s.sort((o,n)=>{const d=new Date(o.start).getTime(),u=new Date(n.start).getTime();return(isNaN(u)?0:u)-(isNaN(d)?0:d)}),s}),ue=async()=>{"Notification"in window&&Notification.permission==="default"&&await Notification.requestPermission()},jt=(s,t,o)=>{"Notification"in window&&Notification.permission==="granted"&&new Notification(s,{body:t,icon:"/favicon.ico",badge:"/favicon.ico",tag:"time-tracker-notification",requireInteraction:!1,...o})},ce=()=>{var s;if(j.value&&((s=v.value)!=null&&s.break_start)){const t=new Date(v.value.break_start),o=K.value,n=Math.floor((o.getTime()-t.getTime())/1e3),d=Math.floor(n/60);d>=13&&!St.value&&(jt("Break Reminder","You're approaching the 15-minute break limit. Please end your break soon.",{tag:"break-13-min"}),St.value=!0),d>=15&&!Tt.value&&(jt("Break Over Limit","You've exceeded the 15-minute break limit. Please end your break now.",{tag:"break-15-min",requireInteraction:!0}),Tt.value=!0)}else j.value||(St.value=!1,Tt.value=!1)},Rt=async()=>{var s,t;if(!(Pt.value||dt.value)&&!A.value&&(s=v.value)!=null&&s.clock_out&&(t=v.value)!=null&&t.clock_in){const o=new Date(v.value.clock_in),n=new Date(v.value.clock_out);Math.floor((n.getTime()-o.getTime())/1e3)/3600>=1&&!v.value.lunch_start&&!dt.value&&(jt("Lunch Reminder","You've been working for 1 hour without taking lunch. Please remember to take your lunch break.",{tag:"lunch-reminder",requireInteraction:!0}),dt.value=!0,Pt.value=!0)}},me=()=>{rt&&clearInterval(rt),rt=window.setInterval(()=>{ce(),dt.value||Rt()},6e4)},zt=s=>{if(A.value)return s.preventDefault(),s.returnValue="",""};Ae(async()=>{const s=new Date;Q.value=s.toISOString().split("T")[0],await ue(),ut(),xe(),G(),Ot(),ot(),Ut=window.setInterval(()=>{K.value=new Date},1e3),me(),window.addEventListener("beforeunload",zt)}),Fe(()=>{Ut&&window.clearInterval(Ut),rt&&clearInterval(rt),window.removeEventListener("beforeunload",zt)});const ut=async()=>{try{const s=await _.get("/time-entries/current");v.value=s.data,Le(),j.value||(St.value=!1,Tt.value=!1);const t=new Date().toISOString().split("T")[0];Q.value!==t&&(dt.value=!1,Pt.value=!1)}catch(s){v.value=null,tt.value="No entry today",console.error("Error fetching current entry:",s)}},pe=Ve(),xe=async()=>{var t,o;const s=(t=pe.props.auth)==null?void 0:t.user;if(s!=null&&s.role){const n=s.role;["admin","manager","employee","developer"].includes(n)&&(O.value=n)}else try{const d=(((o=(await _.get("/admin/users")).data)==null?void 0:o.data)||[]).find(u=>(u==null?void 0:u.id)&&(u==null?void 0:u.email));if(d!=null&&d.role){const u=d.role;["admin","manager","employee","developer"].includes(u)&&(O.value=u)}}catch{}O.value==="admin"&&(await Bt(),setInterval(()=>{Bt()},5e3))},G=async()=>{try{const s=await _.get("/my/tasks");q.value=s.data}catch{}},ge=()=>{Lt.value=!1,M.value=null},qt=async(s=!1)=>{var t,o,n;if(!st.value&&!(!s&&W.value.length>0)){st.value=!0,xt.value=null;try{const u=(((t=(await _.get("/my/clickup/spaces")).data)==null?void 0:t.spaces)||[]).map(c=>({id:String(c.id),name:c.name||`Space ${c.id}`,team_id:c.team_id??null,team_name:c.team_name??null,color:c.color??null}));W.value=u;const y=u.map(c=>c.id);S.value.length===0?S.value=y:(S.value=S.value.filter(c=>y.includes(c)),S.value.length===0&&(S.value=y))}catch(d){xt.value=((n=(o=d==null?void 0:d.response)==null?void 0:o.data)==null?void 0:n.error)||"Failed to load ClickUp spaces.",W.value=[],S.value=[]}finally{st.value=!1}}},ve=async()=>{U.value||(et.value=!0,await qt(!0))},ye=()=>{if(!At.value){S.value=[];return}if(Ft.value){S.value=[];return}S.value=W.value.map(s=>s.id)},fe=async()=>{if(!(U.value||st.value)){if(!S.value.length){alert("Select at least one space to sync.");return}et.value=!1,await Zt([...S.value])}},Yt=async()=>{U.value||(et.value=!1,await Zt())},Zt=async(s=null)=>{var t,o,n,d,u,y,c;U.value=!0;try{const g=s&&s.length?{space_ids:s}:{},a=await _.post("/my/clickup/sync-tasks",g);await G();const m=((t=a.data)==null?void 0:t.summary)??{};M.value={summary:{total:m.total??0,created:m.created??0,updated:m.updated??0,unchanged:m.unchanged??0,skipped:m.skipped??0},created:((o=a.data)==null?void 0:o.created)??[],updated:((n=a.data)==null?void 0:n.updated)??[],skipped:((d=a.data)==null?void 0:d.skipped)??[],sources:((u=a.data)==null?void 0:u.sources)??[]},Lt.value=!0}catch(g){alert(((c=(y=g==null?void 0:g.response)==null?void 0:y.data)==null?void 0:c.error)||"Failed to sync tasks from ClickUp")}finally{U.value=!1}},Gt=async()=>{try{await Ee()}catch{}},he=async()=>{try{await Ie()}catch{}},ke=async()=>{try{await Be()}catch{}},Ht=async()=>{try{await Ue()}catch{}},Ot=async()=>{try{const s=await _.get("/tasks/today-entries");Y.value=s.data||[];const t=(Y.value||[]).find(o=>o.clock_in&&!o.clock_out);w.value=t?t.task_id:null}catch{Y.value=[]}},Jt=async s=>{try{const t=await _.get(`/tasks/${s}/sync`);E.value=t.data,pt.value=!0}catch{pt.value=!1}},be=async()=>{if(j.value){await Ht();return}A.value?await he():await Gt()},_e=async()=>{if(w.value){alert("Pause or stop the running task first.");return}j.value?await Ht():(A.value||await Gt(),await ke())},V=s=>s<10?`0${s}`:`${s}`,we=T(()=>{var s;return A.value&&((s=v.value)!=null&&s.clock_in)?new Date(v.value.clock_in):null}),Se=T(()=>{var s;return j.value&&((s=v.value)!=null&&s.break_start)?new Date(v.value.break_start):null}),Te=T(()=>{const s=Y.value.find(t=>t.clock_in&&!t.clock_out);return s?new Date(s.clock_in):null}),De=T(()=>{const s=we.value;if(!s)return"00:00:00";const t=K.value.getTime()-s.getTime(),o=Math.max(0,Math.floor(t/1e3)),n=Math.floor(o/3600),d=Math.floor(o%3600/60),u=o%60;return`${V(n)}:${V(d)}:${V(u)}`}),Me=T(()=>{const s=Se.value;if(!s)return"00:00:00";const t=K.value.getTime()-s.getTime(),o=Math.max(0,Math.floor(t/1e3)),n=Math.floor(o/3600),d=Math.floor(o%3600/60),u=o%60;return`${V(n)}:${V(d)}:${V(u)}`}),Ce=T(()=>{const s=Te.value;if(!s)return"00:00:00";const t=K.value.getTime()-s.getTime(),o=Math.max(0,Math.floor(t/1e3)),n=Math.floor(o/3600),d=Math.floor(o%3600/60),u=o%60;return`${V(n)}:${V(d)}:${V(u)}`}),Ne=T(()=>{var o,n;let s=$t.value||0;if(A.value&&((o=v.value)!=null&&o.clock_in)&&!((n=v.value)!=null&&n.clock_out)){const d=new Date(v.value.clock_in),u=K.value,y=Math.max(0,Math.floor((u.getTime()-d.getTime())/1e3));let c=0;if(v.value.break_start)if(v.value.break_end){const m=new Date(v.value.break_start),p=new Date(v.value.break_end);c=Math.max(0,Math.floor((p.getTime()-m.getTime())/1e3))}else{const m=new Date(v.value.break_start);c=Math.max(0,Math.floor((u.getTime()-m.getTime())/1e3))}let g=0;if(v.value.lunch_start)if(v.value.lunch_end){const m=new Date(v.value.lunch_start),p=new Date(v.value.lunch_end);g=Math.max(0,Math.floor((p.getTime()-m.getTime())/1e3))}else{const m=new Date(v.value.lunch_start);g=Math.max(0,Math.floor((u.getTime()-m.getTime())/1e3))}const a=Math.max(0,y-c-g);s+=a}return Y.value&&Y.value.length>0&&Y.value.forEach(d=>{if(d.clock_in&&!d.clock_out){const u=new Date(d.clock_in),y=K.value,c=Math.max(0,Math.floor((y.getTime()-u.getTime())/1e3));s+=c}}),(s/3600).toFixed(2)}),$e=async()=>{await ot(),Nt.value=!0},ot=async()=>{var s;try{const t=new Date().toISOString().split("T")[0],n=((s=(await _.get("/my/time-entries",{params:{start_date:t,end_date:t}})).data)==null?void 0:s.entries)||[],d=[];let u=0,y=0;const c=new Date;n.forEach(g=>{const a=g.clock_in_formatted||g.clock_in,m=g.clock_out_formatted||g.clock_out,p=J(g.clock_in),h=J(g.clock_out);if(g.is_break||g.entry_type==="break"){if(!p)return;const k=!!h;let H=0;k&&h?(H=Math.max(0,Math.floor((h.getTime()-p.getTime())/1e3)),y+=H):H=Math.max(0,Math.floor((c.getTime()-p.getTime())/1e3)),d.push({name:"Break",start:a,end:k?m:null,durationSeconds:H,breakDurationSeconds:H,notes:k?"-":"In progress"});return}if(!p)return;const I=g.task&&(g.task.title||g.task.name),b=!!h;if(!I)if(b&&h){const k=Math.max(0,Math.floor((h.getTime()-p.getTime())/1e3)),H=J(g.lunch_start),ct=J(g.lunch_end);let N=0;H&&ct&&(N=Math.max(0,Math.floor((ct.getTime()-H.getTime())/1e3)));const C=Math.max(0,k-N);u+=C,d.push({name:"Work Hours",start:a,end:m,durationSeconds:C,breakDurationSeconds:0,notes:"-"})}else{const k=Math.max(0,Math.floor((c.getTime()-p.getTime())/1e3));d.push({name:"Work Hours",start:a,end:null,durationSeconds:k,breakDurationSeconds:0,notes:"In progress"})}if(I)if(b&&h){const k=Math.max(0,Math.floor((h.getTime()-p.getTime())/1e3));d.push({name:g.task.title||g.task.name,start:a,end:m,durationSeconds:k,breakDurationSeconds:0,notes:"-"})}else{const k=Math.max(0,Math.floor((c.getTime()-p.getTime())/1e3));d.push({name:g.task.title||g.task.name,start:a,end:null,durationSeconds:k,breakDurationSeconds:0,notes:"In progress"})}}),d.sort((g,a)=>{const m=new Date(g.start).getTime(),p=new Date(a.start).getTime();return(isNaN(p)?0:p)-(isNaN(m)?0:m)}),Wt.value=d,$t.value=u}catch{Wt.value=[],$t.value=0}},Le=()=>{!v.value||!v.value.clock_in?tt.value="Not clocked in":v.value.clock_out?tt.value="Clocked out":de.value?tt.value="On lunch":j.value?tt.value="On break":tt.value="Clocked in"},Ee=async s=>{var t,o;D.value=!0;try{const n={};await _.post("/time-entries/clock-in",n),await ut(),await G(),await ot()}catch(n){alert(((o=(t=n.response)==null?void 0:t.data)==null?void 0:o.message)||"Error clocking in")}finally{D.value=!1}},Ie=async()=>{var s,t;D.value=!0;try{if(w.value){alert("Pause or stop the running task first."),D.value=!1;return}await _.post("/time-entries/clock-out"),await ut(),await G(),await ot(),setTimeout(()=>{Rt()},1e3)}catch(o){alert(((t=(s=o.response)==null?void 0:s.data)==null?void 0:t.message)||"Error clocking out")}finally{D.value=!1}},Be=async()=>{var s,t;D.value=!0;try{await _.post("/time-entries/break-start"),await ut(),await G(),await ot()}catch(o){alert(((t=(s=o.response)==null?void 0:s.data)==null?void 0:t.message)||"Error starting break")}finally{D.value=!1}},Ue=async()=>{var s,t;D.value=!0;try{await _.post("/time-entries/break-end"),await ut(),await G(),await ot()}catch(o){alert(((t=(s=o.response)==null?void 0:s.data)==null?void 0:t.message)||"Error ending break")}finally{D.value=!1}},Kt=async s=>{var t,o;if(!A.value){alert("Please Time In first before starting a task.");return}if(j.value&&await Ht(),w.value&&w.value!==s)try{await _.post("/tasks/stop")}catch{}try{await _.post("/tasks/start",{task_id:s}),w.value=s,await Ot()}catch(n){alert(((o=(t=n==null?void 0:n.response)==null?void 0:t.data)==null?void 0:o.message)||"Failed to start task")}},Qt=async()=>{try{await _.post("/tasks/stop")}catch{}w.value=null,await Ot()},Pe=async(s,t)=>{var n,d;if(!t)return;if(!confirm(`Are you sure you want to set this task to "${t}"?`)){await G();return}D.value=!0;try{await _.post(`/tasks/${s}/status`,{status:t}),await G()}catch(u){alert(((d=(n=u==null?void 0:u.response)==null?void 0:n.data)==null?void 0:d.message)||"Failed to update task status")}finally{D.value=!1}},Xt=async()=>{var s,t;if(Q.value){gt.value=!0;try{const o=await _.get("/my/time-entries",{params:{start_date:Q.value,end_date:Q.value}}),n=((s=o.data)==null?void 0:s.entries)||[];Vt.value=n,$.value=[];let d=0,u=0,y=null,c=null;const g=new Date;n.forEach(p=>{const h=p.clock_in_formatted||p.clock_in,I=p.clock_out_formatted||p.clock_out,b=J(p.clock_in),k=J(p.clock_out);if(b&&(!y||b<y)&&(y=b,c=h),p.is_break||p.entry_type==="break"){if(!b)return;const N=!!k;let C=0;N&&k?(C=Math.max(0,Math.floor((k.getTime()-b.getTime())/1e3)),u+=C):C=Math.max(0,Math.floor((g.getTime()-b.getTime())/1e3)),$.value.push({name:"Break",start:h,end:N?I:null,durationSeconds:C,breakDurationSeconds:C,notes:N?"-":"In progress"});return}if(!b)return;const H=p.task&&(p.task.title||p.task.name),ct=!!k;if(!H)if(ct&&k){const N=Math.max(0,Math.floor((k.getTime()-b.getTime())/1e3));d+=N;const C=J(p.lunch_start),oe=J(p.lunch_end);let ne=0;C&&oe&&(ne=Math.max(0,Math.floor((oe.getTime()-C.getTime())/1e3)));const Oe=Math.max(0,N-ne);$.value.push({name:"Work Hours",start:h,end:I,durationSeconds:Oe,breakDurationSeconds:0,notes:"-"})}else{const N=Math.max(0,Math.floor((g.getTime()-b.getTime())/1e3));$.value.push({name:"Work Hours",start:h,end:null,durationSeconds:N,breakDurationSeconds:0,notes:"In progress"})}if(H){const N=p.task.title||p.task.name;if(ct&&k){const C=Math.max(0,Math.floor((k.getTime()-b.getTime())/1e3));$.value.push({name:N,start:h,end:I,durationSeconds:C,breakDurationSeconds:0,notes:"-"})}else{const C=Math.max(0,Math.floor((g.getTime()-b.getTime())/1e3));$.value.push({name:N,start:h,end:null,durationSeconds:C,breakDurationSeconds:0,notes:"In progress"})}}}),$.value.sort((p,h)=>{const I=new Date(p.start).getTime(),b=new Date(h.start).getTime();return(isNaN(b)?0:b)-(isNaN(I)?0:I)});const a=$.value.filter(p=>p.name==="Work Hours").reduce((p,h)=>p+(h.durationSeconds||0),0),m=$.value.filter(p=>p.name==="Break").reduce((p,h)=>p+(h.durationSeconds||0),0);if((t=o.data)!=null&&t.daily_totals)P.value={workSeconds:a,breakSeconds:m,lunchSeconds:o.data.daily_totals.lunch_seconds||0,tasksCount:o.data.daily_totals.tasks_count||0,status:o.data.daily_totals.status||"No Entry",overtimeSeconds:o.data.daily_totals.overtime_seconds||0};else{const h=Math.max(0,a-28800);let I="No Entry";if(y){const b=(y.getUTCHours()+8)%24,k=y.getUTCMinutes();I=b<8||b===8&&k<=30?"Perfect":"Late"}P.value={workSeconds:a,breakSeconds:m,lunchSeconds:0,tasksCount:$.value.length,status:I,overtimeSeconds:h}}}catch(o){console.error("Error loading time entries",o),Vt.value=[],$.value=[],P.value={workSeconds:0,breakSeconds:0,lunchSeconds:0,tasksCount:0,status:"No Entry",overtimeSeconds:0}}finally{gt.value=!1}}},J=s=>{if(!s)return null;const t=s.match(/^(\d{4})-(\d{2})-(\d{2})[ T](\d{2}):(\d{2})(?::(\d{2}))?/);if(t){const d=Number(t[1]),u=Number(t[2])-1,y=Number(t[3]),c=Number(t[4]),g=Number(t[5]),a=Number(t[6]||"0");return new Date(Date.UTC(d,u,y,c-8,g,a))}const o=s.includes("T")?s:s.replace(" ","T"),n=new Date(o);return isNaN(n.getTime())?null:n},nt=s=>{if(!s)return"--";try{const o=new Date(s);if(!isNaN(o.getTime()))return o.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!0,timeZone:"Asia/Manila"})}catch{}const t=s.match(/\b(\d{1,2}):(\d{2})(?::(\d{2}))?/);if(t){let o=parseInt(t[1],10);const n=t[2],d=o>=12?"PM":"AM";return o=o%12,o===0&&(o=12),`${o}:${n} ${d}`}return"--"},F=s=>{const t=typeof s=="number"&&isFinite(s)?Math.max(0,Math.floor(s)):0,o=Math.floor(t/3600),n=Math.floor(t%3600/60),d=t%60,u=y=>y<10?`0${y}`:`${y}`;return`${u(o)}:${u(n)}:${u(d)}`},te=s=>{if(!s)return"--";const t=new Date(s);return isNaN(t.getTime())?s:t.toLocaleDateString("en-US",{month:"short",day:"2-digit",year:"numeric"})},ee=s=>{if(!s||s===0)return"--";const t=Math.floor(s/1e3);return F(t)},se=s=>{if(!s)return"";const t=s.toLowerCase().trim();return t==="to do"||t==="todo"?"text-gray-700":t.includes("complete")||t.includes("done")||t.includes("finished")?"bg-green-100 text-green-800":t.includes("progress")||t.includes("doing")||t.includes("in progress")||t.includes("working")?"bg-blue-100 text-blue-800":t.includes("pending")||t.includes("waiting")?"bg-yellow-100 text-yellow-800":t.includes("blocked")||t.includes("stuck")?"bg-red-100 text-red-800":t.includes("review")||t.includes("testing")?"bg-purple-100 text-purple-800":t.includes("cancel")||t.includes("closed")?"bg-gray-100 text-gray-800":"bg-indigo-100 text-indigo-800"},je=s=>{if(!s)return"bg-gray-100 text-gray-800";const t=s.toLowerCase().trim();return t==="urgent"||t==="critical"?"bg-red-100 text-red-800":t==="high"?"bg-orange-100 text-orange-800":t==="normal"||t==="medium"?"bg-yellow-100 text-yellow-800":t==="low"?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"},ae=s=>{if(!s)return!1;const t=s.toLowerCase().trim();return t!=="to do"&&t!=="todo"},He=s=>{if(!s)return"";const t=s.split(`
`),o=[];let n=!1,d=[];for(let y=0;y<t.length;y++){const c=t[y].trim();if(!c){n&&d.length>0&&(o.push(`<ul class="list-disc ml-6 mb-3 space-y-1">${d.join("")}</ul>`),d=[],n=!1),o.length>0&&!o[o.length-1].startsWith("<")&&o.push('</p><p class="mb-2">');continue}if(c.match(/^#{1,3}\s+/)){n&&d.length>0&&(o.push(`<ul class="list-disc ml-6 mb-3 space-y-1">${d.join("")}</ul>`),d=[],n=!1),c.startsWith("###")?o.push(`<h3 class="font-semibold text-gray-900 mt-4 mb-2 text-base">${c.replace(/^###\s+/,"")}</h3>`):c.startsWith("##")?o.push(`<h2 class="font-bold text-gray-900 mt-5 mb-3 text-lg">${c.replace(/^##\s+/,"")}</h2>`):c.startsWith("#")&&o.push(`<h1 class="font-bold text-gray-900 mt-6 mb-4 text-xl">${c.replace(/^#\s+/,"")}</h1>`);continue}if(c.match(/^[\-\*â€¢]\s+/)){n||(n=!0);const a=c.replace(/^[\-\*â€¢]\s+/,"").trim();d.push(`<li class="mb-1">${a}</li>`);continue}if(c.match(/^\d+\.\s+/)){n||(n=!0);const a=c.replace(/^\d+\.\s+/,"").trim();d.push(`<li class="mb-1 list-decimal">${a}</li>`);continue}n&&d.length>0&&(o.push(`<ul class="list-disc ml-6 mb-3 space-y-1">${d.join("")}</ul>`),d=[],n=!1);let g=c.replace(/\*\*(.+?)\*\*/g,'<strong class="font-semibold">$1</strong>').replace(/\*(.+?)\*/g,'<em class="italic">$1</em>');o.push(g)}n&&d.length>0&&o.push(`<ul class="list-disc ml-6 mb-3 space-y-1">${d.join("")}</ul>`);let u=o.join("<br>");return u.startsWith("<")||(u='<p class="mb-2">'+u),u.endsWith(">")||(u=u+"</p>"),u};return(s,t)=>(r(),i(L,null,[le(Re(ze),{title:"Dashboard"}),le(Ye,null,{header:ie(()=>[...t[27]||(t[27]=[e("h2",{class:"text-xl font-semibold leading-tight text-gray-800"}," Time Tracker Dashboard ",-1)])]),default:ie(()=>{var o,n,d,u,y,c,g;return[e("div",Ze,[e("div",Ge,[O.value!=="admin"?(r(),i("div",Je,[e("nav",Ke,[e("button",{onClick:t[0]||(t[0]=a=>at.value="dashboard"),class:R(["whitespace-nowrap border-b-2 py-4 px-1 text-sm font-medium",at.value==="dashboard"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700"])}," Dashboard ",2),e("button",{onClick:t[1]||(t[1]=a=>{at.value="time-entries",Xt()}),class:R(["whitespace-nowrap border-b-2 py-4 px-1 text-sm font-medium",at.value==="time-entries"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700"])}," Time Entries ",2)])])):f("",!0),at.value==="dashboard"||O.value==="admin"||O.value==="developer"?(r(),i("div",Qe,[O.value!=="admin"?(r(),i("div",Xe,[e("div",ts,[e("div",es,[t[29]||(t[29]=e("h3",{class:"text-xs font-semibold uppercase tracking-wide text-gray-500"},"Work Day Timer",-1)),e("p",ss,l(De.value),1),e("p",as,l(A.value?"Working":"Idle"),1),j.value?(r(),i("div",os,[e("p",ns,[t[28]||(t[28]=mt("Break Timer: ",-1)),e("span",ls,l(Me.value),1)])])):f("",!0),e("div",is,[e("button",{onClick:be,disabled:D.value,class:R(["rounded-md px-3 py-1.5 text-xs font-semibold text-white",A.value?"bg-red-600 hover:bg-red-700":"bg-green-600 hover:bg-green-700"])},l(A.value?"Time Out":"Time In"),11,rs),e("button",{onClick:_e,disabled:D.value,class:R(["rounded-md px-3 py-1.5 text-xs font-semibold text-white",j.value?"bg-orange-600 hover:bg-orange-700":"bg-yellow-600 hover:bg-yellow-700"])},l(j.value?"Break Out":"Break In"),11,ds)])])]),e("div",us,[e("div",cs,[t[31]||(t[31]=e("h3",{class:"text-xs font-semibold uppercase tracking-wide text-gray-500"},"Running Task",-1)),w.value?(r(),i("div",ms,[e("button",{onClick:t[2]||(t[2]=a=>Jt(w.value)),class:"text-indigo-600 hover:underline text-sm"},l(((o=q.value.find(a=>a.id===w.value))==null?void 0:o.title)||"#"+w.value),1),e("p",ps,[mt(l(Ce.value),1),(n=q.value.find(a=>a.id===w.value))!=null&&n.estimated_time?(r(),i("span",xs," / "+l(ee((d=q.value.find(a=>a.id===w.value))==null?void 0:d.estimated_time)),1)):f("",!0)]),e("div",gs,[e("button",{onClick:t[3]||(t[3]=a=>Qt()),disabled:D.value,class:"rounded-md bg-yellow-600 px-3 py-1.5 text-xs font-semibold text-white hover:bg-yellow-700"},"Pause",8,vs)])])):(r(),i("div",ys,[e("div",fs,[z(e("select",{"onUpdate:modelValue":t[4]||(t[4]=a=>lt.value=a),class:"w-full rounded-md border-gray-300 text-sm shadow-sm"},[t[30]||(t[30]=e("option",{value:null},"Select a task",-1)),(r(!0),i(L,null,B(q.value,a=>(r(),i("option",{key:a.id,value:a.id},l(a.title),9,hs))),128))],512),[[Mt,lt.value]]),e("button",{onClick:t[5]||(t[5]=a=>lt.value?Kt(lt.value):void 0),disabled:D.value||!lt.value,class:"rounded-md bg-green-600 px-3 py-1.5 text-xs font-semibold text-white hover:bg-green-700 disabled:opacity-50"},"Start",8,ks)]),q.value.length?f("",!0):(r(),i("p",bs,"No tasks available."))]))])]),e("div",_s,[e("div",ws,[t[33]||(t[33]=e("h3",{class:"text-xs font-semibold uppercase tracking-wide text-gray-500"},"Daily Logs",-1)),e("p",Ss,[mt(l(Ne.value),1),t[32]||(t[32]=e("span",{class:"text-sm font-normal text-gray-500"}," / 8 Hours",-1))]),e("div",{class:"mt-4 flex space-x-2"},[e("button",{onClick:$e,class:"rounded-md bg-indigo-600 px-3 py-1.5 text-xs font-semibold text-white hover:bg-indigo-700"},"Daily Logs")])])])])):f("",!0),O.value==="admin"?(r(),i("div",Ts,[e("div",Ds,[e("div",Ms,[t[34]||(t[34]=e("h3",{class:"text-lg font-medium leading-6 text-gray-900"},"Real-Time Activity Log",-1)),e("button",{onClick:Bt,disabled:wt.value,class:"rounded-md bg-indigo-600 px-3 py-1.5 text-xs font-semibold text-white hover:bg-indigo-500"},"Refresh",8,Cs)]),e("div",Ns,[e("table",$s,[t[36]||(t[36]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"User"),e("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Action"),e("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Description"),e("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Time")])],-1)),e("tbody",Ls,[(r(!0),i(L,null,B(_t.value,a=>{var m;return r(),i("tr",{key:a.id},[e("td",Es,l(((m=a.user)==null?void 0:m.name)||"Unknown"),1),e("td",Is,l(a.action),1),e("td",Bs,l(a.description),1),e("td",Us,l(new Date(a.created_at).toLocaleString()),1)])}),128)),_t.value.length===0&&!wt.value?(r(),i("tr",Ps,[...t[35]||(t[35]=[e("td",{colspan:"4",class:"px-4 py-4 text-center text-sm text-gray-500"},"No activity logs found",-1)])])):f("",!0)])])])])])):f("",!0),O.value!=="admin"?(r(),i("div",js,[e("div",Hs,[e("div",Os,[t[40]||(t[40]=e("h3",{class:"text-lg font-medium leading-6 text-gray-900"},"My Tasks",-1)),e("div",Ws,[e("button",{onClick:ve,disabled:U.value,class:"rounded-md bg-green-600 px-3 py-1.5 text-xs font-semibold text-white hover:bg-green-700 disabled:opacity-60 disabled:cursor-not-allowed flex items-center gap-2"},[U.value?(r(),i("span",Fs)):f("",!0),e("span",null,l(U.value?"Syncingâ€¦":"Refresh from ClickUp"),1)],8,As),z(e("input",{"onUpdate:modelValue":t[6]||(t[6]=a=>Et.value=a),onInput:t[7]||(t[7]=a=>Z(1)),type:"text",placeholder:"Search tasks",class:"rounded-md border-gray-300 text-sm shadow-sm"},null,544),[[Ct,Et.value]]),z(e("select",{"onUpdate:modelValue":t[8]||(t[8]=a=>vt.value=a),onChange:t[9]||(t[9]=a=>Z(1)),class:"rounded-md border-gray-300 text-sm shadow-sm"},[t[37]||(t[37]=e("option",{value:"all"},"All",-1)),(r(!0),i(L,null,B(yt.value,a=>(r(),i("option",{key:a,value:a},l(a),9,Vs))),128))],544),[[Mt,vt.value]]),z(e("select",{"onUpdate:modelValue":t[10]||(t[10]=a=>ft.value=a),onChange:t[11]||(t[11]=a=>Z(1)),class:"rounded-md border-gray-300 text-sm shadow-sm"},[...t[38]||(t[38]=[e("option",{value:"all"},"All priorities",-1),e("option",{value:"urgent"},"Urgent",-1),e("option",{value:"high"},"High",-1),e("option",{value:"normal"},"Normal",-1),e("option",{value:"low"},"Low",-1),e("option",{value:"none"},"None",-1)])],544),[[Mt,ft.value]]),z(e("input",{"onUpdate:modelValue":t[12]||(t[12]=a=>ht.value=a),onChange:t[13]||(t[13]=a=>Z(1)),type:"date",class:"rounded-md border-gray-300 text-sm shadow-sm"},null,544),[[Ct,ht.value]]),z(e("input",{"onUpdate:modelValue":t[14]||(t[14]=a=>kt.value=a),onChange:t[15]||(t[15]=a=>Z(1)),type:"date",class:"rounded-md border-gray-300 text-sm shadow-sm"},null,544),[[Ct,kt.value]]),z(e("select",{"onUpdate:modelValue":t[16]||(t[16]=a=>it.value=a),onChange:t[17]||(t[17]=a=>Z(1)),class:"rounded-md border-gray-300 text-sm shadow-sm"},[...t[39]||(t[39]=[e("option",{value:5},"5",-1),e("option",{value:10},"10",-1),e("option",{value:20},"20",-1),e("option",{value:50},"50",-1)])],544),[[Mt,it.value,void 0,{number:!0}]])])]),e("div",Rs,[e("table",zs,[t[44]||(t[44]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Task"),e("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Campaign"),e("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Parent Task"),e("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Status"),e("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Due Date"),e("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Estimated Time"),e("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Priority"),e("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Actions")])],-1)),e("tbody",qs,[(r(!0),i(L,null,B(re.value,a=>(r(),i("tr",{key:a.id},[e("td",Ys,[e("button",{onClick:m=>Jt(a.id),class:"hover:underline"},l(a.title),9,Zs)]),e("td",Gs,l(a.clickup_list_name||"--"),1),e("td",Js,l(a.parent_task_name||"N/A"),1),e("td",Ks,[ae(a.status)?(r(),i("span",{key:0,class:R(["inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-semibold",se(a.status)])},l(a.status||"â€”"),3)):(r(),i("span",Qs,l(a.status||"â€”"),1))]),e("td",Xs,l(a.due_date?new Date(a.due_date).toLocaleDateString():"--"),1),e("td",ta,l(ee(a.estimated_time)),1),e("td",ea,[e("span",{class:R(["inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-semibold",je(a.priority||null)])},l(a.priority||"None"),3)]),e("td",sa,[e("div",aa,[e("button",{onClick:m=>w.value===a.id?Qt():Kt(a.id),disabled:D.value,class:R(["rounded-full p-2 text-white",w.value===a.id?"bg-yellow-600 hover:bg-yellow-700":"bg-green-600 hover:bg-green-700"]),"aria-label":w.value===a.id?"Pause":"Play"},[w.value!==a.id?(r(),i("svg",na,[...t[41]||(t[41]=[e("path",{d:"M8 5v14l11-7z"},null,-1)])])):(r(),i("svg",la,[...t[42]||(t[42]=[e("path",{d:"M6 5h4v14H6zM14 5h4v14h-4z"},null,-1)])]))],10,oa),e("select",{value:a.status||"",onChange:m=>Pe(a.id,m.target.value),class:"rounded-md border-gray-300 text-xs shadow-sm"},[t[43]||(t[43]=e("option",{disabled:"",value:""},"Set statusâ€¦",-1)),(r(!0),i(L,null,B(yt.value,m=>(r(),i("option",{key:m+a.id,value:m},l(m),9,ra))),128)),yt.value.includes("complete")?f("",!0):(r(),i("option",da,"complete")),yt.value.includes("done")?f("",!0):(r(),i("option",ua,"done"))],40,ia)])])]))),128))])]),e("div",ca,[e("div",null," Page "+l(X.value)+" of "+l(bt.value)+" â€¢ "+l(It.value.length)+" total ",1),e("div",ma,[e("button",{onClick:t[18]||(t[18]=a=>Z(X.value-1)),disabled:X.value<=1,class:"rounded-md border px-3 py-1 disabled:opacity-50"},"Prev",8,pa),e("button",{onClick:t[19]||(t[19]=a=>Z(X.value+1)),disabled:X.value>=bt.value,class:"rounded-md border px-3 py-1 disabled:opacity-50"},"Next",8,xa)])])])])])):f("",!0),e("div",ga,[e("div",va,[t[46]||(t[46]=e("h3",{class:"text-lg font-medium leading-6 text-gray-900 mb-4"},"Today's Time Events",-1)),Dt.value.length===0?(r(),i("div",ya," No time entries recorded today. Clock in to start tracking time. ")):(r(),i("div",fa,[e("table",ha,[t[45]||(t[45]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Task"),e("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Start Time"),e("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"End Time"),e("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Duration"),e("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Break Duration"),e("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Notes")])],-1)),e("tbody",ka,[(r(!0),i(L,null,B(Dt.value,(a,m)=>(r(),i("tr",{key:m},[e("td",ba,l(a.name),1),e("td",_a,l(nt(a.start)),1),e("td",wa,l(nt(a.end)),1),e("td",Sa,l(F(a.durationSeconds)),1),e("td",Ta,l(F(a.breakDurationSeconds||0)),1),e("td",Da,l(a.notes||"-"),1)]))),128))])])]))])])])):f("",!0),at.value==="time-entries"&&O.value!=="admin"?(r(),i("div",Ma,[e("div",Ca,[e("div",Na,[e("div",null,[t[47]||(t[47]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Date",-1)),z(e("input",{"onUpdate:modelValue":t[20]||(t[20]=a=>Q.value=a),onChange:Xt,type:"date",class:"w-full rounded-md border-gray-300 shadow-sm"},null,544),[[Ct,Q.value]])])])]),e("div",$a,[t[53]||(t[53]=e("h3",{class:"text-lg font-medium leading-6 text-gray-900 mb-4"},"Daily Summary",-1)),e("div",La,[e("div",null,[t[48]||(t[48]=e("div",{class:"text-gray-500"},"ðŸ•’ Time In Hours",-1)),e("div",Ea,l(F(P.value.workSeconds)),1)]),e("div",null,[t[49]||(t[49]=e("div",{class:"text-gray-500"},"â˜• Total Breaks",-1)),e("div",Ia,l(F(P.value.breakSeconds)),1)]),e("div",null,[t[50]||(t[50]=e("div",{class:"text-gray-500"},"ðŸ“‹ Entries",-1)),e("div",Ba,l(P.value.tasksCount),1)]),e("div",null,[t[51]||(t[51]=e("div",{class:"text-gray-500"},"â° Status",-1)),e("div",{class:R(["font-semibold",{"text-green-700":P.value.status==="Perfect","text-yellow-700":P.value.status==="Late","text-gray-700":P.value.status==="No Entry"}])},l(P.value.status),3)]),e("div",null,[t[52]||(t[52]=e("div",{class:"text-gray-500"},"âš¡ Overtime",-1)),e("div",Ua,l(F(P.value.overtimeSeconds)),1)])])]),e("div",Pa,[e("div",ja,[e("table",Ha,[t[55]||(t[55]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Task"),e("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Start Time"),e("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"End Time"),e("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Duration"),e("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Break Duration"),e("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Notes")])],-1)),e("tbody",Oa,[(r(!0),i(L,null,B($.value,(a,m)=>(r(),i("tr",{key:m},[e("td",Wa,l(a.name),1),e("td",Aa,l(nt(a.start)),1),e("td",Fa,l(nt(a.end)),1),e("td",Va,l(F(a.durationSeconds)),1),e("td",Ra,l(F(a.breakDurationSeconds||0)),1),e("td",za,l(a.notes||"-"),1)]))),128)),$.value.length===0&&!gt.value?(r(),i("tr",qa,[...t[54]||(t[54]=[e("td",{colspan:"6",class:"px-4 py-4 text-center text-sm text-gray-500"},"No entries for selected day",-1)])])):f("",!0)])])]),gt.value?(r(),i("div",Ya,[...t[56]||(t[56]=[e("div",{class:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600"},null,-1),e("p",{class:"mt-2 text-sm text-gray-500"},"Loading...",-1)])])):f("",!0)])])):f("",!0)]),Nt.value?(r(),i("div",Za,[e("div",Ga,[e("div",Ja,[t[57]||(t[57]=e("h4",{class:"text-md font-semibold"},"Daily Logs",-1)),e("button",{onClick:t[21]||(t[21]=a=>Nt.value=!1),class:"rounded-md bg-gray-100 px-2 py-1 text-xs"},"Close")]),e("div",Ka,[Dt.value.length===0?(r(),i("div",Qa,"No entry today.")):(r(),i("div",Xa,[e("table",to,[t[58]||(t[58]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-4 py-2 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Task"),e("th",{class:"px-4 py-2 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Start Time"),e("th",{class:"px-4 py-2 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"End Time"),e("th",{class:"px-4 py-2 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Duration"),e("th",{class:"px-4 py-2 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Break Duration"),e("th",{class:"px-4 py-2 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Notes")])],-1)),e("tbody",eo,[(r(!0),i(L,null,B(Dt.value,(a,m)=>(r(),i("tr",{key:m},[e("td",so,l(a.name),1),e("td",ao,l(nt(a.start)),1),e("td",oo,l(nt(a.end)),1),e("td",no,l(F(a.durationSeconds)),1),e("td",lo,l(F(a.breakDurationSeconds||0)),1),e("td",io,l(a.notes||"-"),1)]))),128))])])]))])])])):f("",!0),et.value?(r(),i("div",ro,[e("div",uo,[e("div",co,[t[59]||(t[59]=e("h4",{class:"text-md font-semibold text-gray-900"},"Select ClickUp Spaces",-1)),e("button",{onClick:t[22]||(t[22]=a=>et.value=!1),class:"rounded-md bg-gray-100 px-2 py-1 text-xs hover:bg-gray-200"},"Close")]),e("div",mo,[t[62]||(t[62]=e("p",null,"Select the ClickUp spaces you want to sync tasks from. Limiting the sync to specific spaces reduces the chance of hitting ClickUp rate limits.",-1)),st.value?(r(),i("div",po,[...t[60]||(t[60]=[e("span",{class:"h-3 w-3 rounded-full border-2 border-gray-300 border-t-indigo-600 animate-spin"},null,-1),e("span",null,"Loading spacesâ€¦",-1)])])):xt.value?(r(),i("div",xo,[e("p",null,l(xt.value),1),e("div",go,[e("button",{onClick:t[23]||(t[23]=a=>qt(!0)),class:"rounded-md bg-white px-3 py-1.5 text-xs font-medium text-red-700 shadow hover:bg-red-50"},"Try again"),e("button",{onClick:Yt,class:"rounded-md bg-red-600 px-3 py-1.5 text-xs font-semibold text-white hover:bg-red-700"},"Sync without filtering")])])):W.value.length?(r(),i("div",yo,[e("div",fo,[e("span",null,l(S.value.length)+" of "+l(W.value.length)+" selected",1),e("button",{type:"button",class:"text-indigo-600 hover:text-indigo-800",onClick:ye},l(Ft.value?"Clear all":"Select all"),1)]),e("div",ho,[(r(!0),i(L,null,B(W.value,a=>(r(),i("label",{key:a.id,class:"flex items-start gap-3 rounded-md border border-gray-200 px-3 py-2 text-sm shadow-sm hover:border-indigo-300"},[z(e("input",{type:"checkbox",class:"mt-1 h-4 w-4 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500",value:a.id,"onUpdate:modelValue":t[24]||(t[24]=m=>S.value=m)},null,8,ko),[[qe,S.value]]),e("div",null,[e("p",bo,[mt(l(a.name)+" ",1),e("span",_o,"("+l(a.id)+")",1)]),a.team_name||a.team_id?(r(),i("p",wo,l(a.team_name||"Team "+a.team_id),1)):f("",!0)])]))),128))])])):(r(),i("div",vo,[t[61]||(t[61]=e("p",null,"No ClickUp spaces are available from the configured workspaces.",-1)),e("button",{onClick:Yt,class:"rounded-md bg-amber-600 px-3 py-1.5 text-xs font-semibold text-white hover:bg-amber-700"},"Sync everything instead")]))]),e("div",So,[t[63]||(t[63]=e("p",null,"Selecting fewer spaces can keep the sync fast and within ClickUp limits.",-1)),e("div",To,[e("button",{onClick:t[25]||(t[25]=a=>et.value=!1),class:"rounded-md bg-white px-3 py-1.5 text-xs font-medium text-gray-600 shadow hover:bg-gray-100"},"Cancel"),e("button",{onClick:fe,disabled:U.value||st.value||!S.value.length||!W.value.length,class:"rounded-md bg-green-600 px-3 py-1.5 text-xs font-semibold text-white hover:bg-green-700 disabled:cursor-not-allowed disabled:opacity-60 flex items-center gap-2"},[U.value?(r(),i("span",Mo)):f("",!0),e("span",null,l(U.value?"Syncingâ€¦":"Sync selected"),1)],8,Do)])])])])):f("",!0),Lt.value&&M.value?(r(),i("div",Co,[e("div",No,[e("div",{class:"flex items-center justify-between border-b px-4 py-3"},[t[64]||(t[64]=e("h4",{class:"text-md font-semibold"},"ClickUp Sync Summary",-1)),e("button",{onClick:ge,class:"rounded-md bg-gray-100 px-2 py-1 text-xs hover:bg-gray-200"},"Close")]),e("div",$o,[e("div",Lo,[t[66]||(t[66]=e("p",null,"Latest sync completed successfully.",-1)),M.value.sources.length?(r(),i("p",Eo,[t[65]||(t[65]=mt(" Sources: ",-1)),e("span",Io,l(M.value.sources.join(", ")),1)])):f("",!0)]),e("div",Bo,[e("div",Uo,[t[67]||(t[67]=e("div",{class:"text-xs uppercase tracking-wide text-indigo-600"},"Total Processed",-1)),e("div",Po,l(M.value.summary.total),1)]),e("div",jo,[t[68]||(t[68]=e("div",{class:"text-xs uppercase tracking-wide text-green-600"},"Created",-1)),e("div",Ho,l(M.value.summary.created),1)]),e("div",Oo,[t[69]||(t[69]=e("div",{class:"text-xs uppercase tracking-wide text-blue-600"},"Updated",-1)),e("div",Wo,l(M.value.summary.updated),1)]),e("div",Ao,[t[70]||(t[70]=e("div",{class:"text-xs uppercase tracking-wide text-gray-600"},"No Changes",-1)),e("div",Fo,l(M.value.summary.unchanged),1)]),e("div",Vo,[t[71]||(t[71]=e("div",{class:"text-xs uppercase tracking-wide text-amber-600"},"Skipped",-1)),e("div",Ro,l(M.value.summary.skipped),1)])]),M.value.created.length?(r(),i("div",zo,[t[72]||(t[72]=e("h5",{class:"text-sm font-semibold text-gray-900"},"New tasks",-1)),e("ul",qo,[(r(!0),i(L,null,B(M.value.created,a=>(r(),i("li",{key:"created-"+a.id,class:"rounded-md border border-green-200 bg-green-50 px-3 py-2"},[e("div",Yo,[e("span",Zo,l(a.title),1),e("span",Go,l(te(a.due_date)),1)]),e("div",Jo,[a.status?(r(),i("span",Ko,"Status: "+l(a.status),1)):f("",!0),a.priority?(r(),i("span",Qo,"Priority: "+l(a.priority),1)):f("",!0)])]))),128))])])):f("",!0),M.value.updated.length?(r(),i("div",Xo,[t[73]||(t[73]=e("h5",{class:"text-sm font-semibold text-gray-900"},"Updated tasks",-1)),e("ul",tn,[(r(!0),i(L,null,B(M.value.updated,a=>(r(),i("li",{key:"updated-"+a.id,class:"rounded-md border border-blue-200 bg-blue-50 px-3 py-2"},[e("div",en,[e("span",sn,l(a.title),1),e("span",an,l(te(a.due_date)),1)]),e("div",on,[a.status?(r(),i("span",nn,"Status: "+l(a.status),1)):f("",!0),a.priority?(r(),i("span",ln,"Priority: "+l(a.priority),1)):f("",!0)])]))),128))])])):f("",!0),M.value.skipped.length?(r(),i("div",rn,[t[74]||(t[74]=e("h5",{class:"text-sm font-semibold text-gray-900"},"Skipped items",-1)),e("ul",dn,[(r(!0),i(L,null,B(M.value.skipped,a=>(r(),i("li",{key:"skipped-"+a.id,class:"rounded-md border border-amber-200 bg-amber-50 px-3 py-2 text-xs text-amber-900"},[e("div",un,[e("span",cn,l(a.id),1),e("span",mn,l(a.reason),1)])]))),128))])])):f("",!0)])])])):f("",!0),pt.value?(r(),i("div",pn,[e("div",xn,[e("div",gn,[t[75]||(t[75]=e("h4",{class:"text-md font-semibold"},"Task Details",-1)),e("button",{onClick:t[26]||(t[26]=a=>pt.value=!1),class:"rounded-md bg-gray-100 px-2 py-1 text-xs hover:bg-gray-200"},"Close")]),E.value?(r(),i("div",vn,[e("div",yn,[e("h2",fn,l((u=E.value.task)==null?void 0:u.title),1),e("div",hn,[(y=E.value.task)!=null&&y.status?(r(),i("span",kn,[t[76]||(t[76]=e("span",{class:"text-gray-600"},"Status:",-1)),ae(E.value.task.status)?(r(),i("span",{key:0,class:R(["inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-semibold ml-1",se(E.value.task.status)])},l(E.value.task.status),3)):(r(),i("span",bn,l(E.value.task.status),1))])):f("",!0),(c=E.value.clickup)!=null&&c.url?(r(),i("span",_n,[e("a",{href:E.value.clickup.url,target:"_blank",class:"text-indigo-600 hover:underline text-sm font-medium"},"Open in ClickUp â†’",8,wn)])):f("",!0)])]),(g=E.value.clickup)!=null&&g.text_content?(r(),i("div",Sn,[e("div",{innerHTML:He(E.value.clickup.text_content),class:"prose prose-sm max-w-none"},null,8,Tn)])):(r(),i("div",Dn," No additional details available. "))])):f("",!0)])])):f("",!0)])]}),_:1})],64))}});export{Ln as default};
