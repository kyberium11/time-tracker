import{d as Zt,r as d,c as ut,u as Gt,o as Qt,w as ct,a as l,b as Mt,e as Yt,h as Jt,f as Et,g as t,i as f,n as $,j as n,t as r,k as mt,F as h,l as k,m as U,v as ft,p as X}from"./app-MFIA-bLi.js";import{_ as Kt}from"./AuthenticatedLayout.vue_vue_type_script_setup_true_lang-BTDgZHqA.js";import{a as I}from"./api-DepQgIp9.js";const Xt={class:"py-12"},te={class:"mx-auto max-w-7xl sm:px-6 lg:px-8"},ee={class:"border-b border-gray-200 mb-6"},se={class:"-mb-px flex space-x-8"},ae={key:0,class:"space-y-8"},oe={class:"space-y-6"},le={class:"flex flex-wrap items-center justify-between gap-3"},ne={key:0,class:"text-sm text-gray-500"},re={class:"flex items-center gap-2"},ie=["disabled"],de={key:0,class:"h-3 w-3 animate-spin rounded-full border-2 border-indigo-500 border-t-transparent"},ue={key:0,class:"bg-white shadow rounded-lg p-10 text-center text-sm text-gray-500"},ce={key:1,class:"bg-red-50 border border-red-200 text-red-700 rounded-lg p-6 flex flex-col gap-4"},me={class:"text-sm"},ve={key:2,class:"space-y-8"},ge={class:"grid gap-4 md:grid-cols-2 xl:grid-cols-3"},xe={class:"text-sm font-semibold uppercase tracking-wide text-gray-500"},pe={class:"mt-2 text-3xl font-bold"},ye={class:"mt-2 text-sm text-gray-600"},be={class:"grid gap-6 lg:grid-cols-2"},fe={class:"rounded-xl bg-white shadow-sm"},he={class:"border-b border-gray-100 px-5 py-4"},_e={class:"text-sm text-gray-500"},ke={key:0,class:"divide-y divide-gray-100"},we={class:"font-medium text-gray-900"},Se={class:"text-sm text-gray-500"},Te={key:0,class:"ml-1 text-gray-400"},De={class:"text-right"},Ue={class:"text-sm font-semibold text-indigo-600"},He={class:"text-xs text-gray-500"},Ce={key:1,class:"px-5 py-6 text-sm text-gray-500"},Me={class:"rounded-xl bg-white shadow-sm"},Ee={class:"space-y-4 px-5 py-6"},$e={class:"text-sm font-medium text-gray-600"},Ie={class:"text-sm font-semibold text-gray-900 text-right"},Le={key:1,class:"space-y-6"},Ne={class:"bg-white shadow rounded-lg p-4"},Ae={class:"grid gap-4 sm:grid-cols-3"},Oe=["value"],Fe={class:"flex items-end gap-2"},Ve=["disabled"],We=["disabled"],Pe={class:"bg-white shadow rounded-lg p-5"},Re={class:"grid gap-4 sm:grid-cols-3 lg:grid-cols-5 text-sm"},je={class:"font-semibold"},Be={class:"font-semibold"},qe={class:"font-semibold"},ze={class:"font-semibold"},Ze={class:"bg-white shadow rounded-lg"},Ge={class:"overflow-x-auto"},Qe={class:"min-w-full divide-y divide-gray-200"},Ye={class:"bg-gray-50"},Je={key:0,class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},Ke={class:"divide-y divide-gray-200"},Xe={class:"px-4 py-4 text-sm text-gray-900"},ts={class:"px-4 py-4 text-sm text-gray-500"},es={class:"px-4 py-4 text-sm text-gray-500"},ss={class:"px-4 py-4 text-sm text-gray-900 font-semibold"},as={class:"px-4 py-4 text-sm text-gray-500"},os={class:"px-4 py-4 text-sm text-gray-500"},ls={key:0,class:"px-4 py-4 text-sm"},ns=["onClick"],rs={key:1,class:"text-gray-400 text-xs"},is={key:0},ds=["colspan"],us={key:0,class:"text-center py-8"},cs={key:2,class:"space-y-6"},ms={class:"bg-white shadow rounded-lg p-4"},vs={class:"flex justify-between items-center mb-4"},gs={class:"flex items-center gap-2"},xs={class:"grid gap-4 sm:grid-cols-2"},ps={class:"bg-white shadow rounded-lg"},ys={class:"overflow-x-auto"},bs={class:"min-w-full divide-y divide-gray-200"},fs={class:"divide-y divide-gray-200 bg-white"},hs={class:"px-4 py-4 whitespace-nowrap"},_s={class:"flex items-center"},ks={class:"flex-shrink-0 h-10 w-10"},ws={class:"h-10 w-10 rounded-full bg-indigo-100 flex items-center justify-center"},Ss={class:"text-indigo-600 font-medium"},Ts={class:"ml-4"},Ds={class:"text-sm font-medium text-gray-900"},Us={class:"text-sm text-gray-500"},Hs={class:"px-4 py-4 whitespace-nowrap"},Cs={class:"px-4 py-4"},Ms={class:"text-sm text-gray-900"},Es={class:"px-4 py-4 whitespace-nowrap text-sm text-gray-500"},$s={class:"text-xs text-gray-400"},Is={key:0},Ls={key:0,class:"text-center py-8"},Ns={key:3,class:"space-y-6"},As={class:"bg-white shadow rounded-lg p-4 flex flex-wrap items-end gap-4"},Os={class:"ml-auto flex flex-wrap items-end gap-3"},Fs={key:0},Vs=["value"],Ws=["disabled"],Ps={key:0,class:"h-3 w-3 animate-spin rounded-full border-2 border-white border-t-transparent"},Rs={key:0,class:"bg-red-50 border border-red-200 text-red-700 rounded-lg p-4"},js={class:"text-sm"},Bs={key:1,class:"bg-white shadow rounded-lg"},qs={key:0,class:"p-8 text-center text-sm text-gray-500"},zs={key:1,class:"p-8 text-center text-sm text-gray-500"},Zs={key:2,class:"overflow-x-auto"},Gs={class:"min-w-full divide-y divide-gray-200"},Qs={class:"bg-gray-50"},Ys={class:"divide-y divide-gray-200 bg-white"},Js={class:"px-4 py-3 text-sm text-gray-900 whitespace-nowrap"},Ks=["title"],Xs={key:0,class:"space-y-0.5"},ta={class:"text-sm font-semibold text-gray-900"},ea={class:"text-xs text-gray-500"},sa={key:1,class:"text-xs text-gray-300"},aa={class:"bg-gray-50 border-t border-gray-200"},oa={class:"font-semibold text-indigo-700"},la={class:"text-gray-700"},na={key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50"},ra={class:"w-full max-w-md rounded-lg bg-white shadow-lg"},ia={class:"p-4"},da={class:"mb-4"},ua=["value"],ca={class:"mb-4"},ma={class:"mb-4"},va={class:"flex justify-end gap-2"},ga=["disabled"],xa="Asia/Manila",ha=Zt({__name:"Analytics",setup(pa){const b=d(null),vt=d(!0),tt=d(null),B=d(!1),gt=async()=>{var a,e;try{tt.value=null;const{data:s}=await I.get("/admin/analytics/summary");b.value=s}catch(s){console.error(s),tt.value=((e=(a=s==null?void 0:s.response)==null?void 0:a.data)==null?void 0:e.error)||"Unable to load analytics summary.",b.value=null}finally{vt.value=!1,B.value=!1}},ht=async()=>{B.value=!0,await gt()},xt=a=>`${a.toFixed(2)} h`,q=a=>a.toLocaleString(),pt=a=>new Date(a).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),_t=a=>new Date(a).toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"}),$t=a=>{if(a===null)return"--";const e=Math.floor(a/60),s=a%60;return e===0?`${s}m`:`${e}h ${s}m`},It=a=>a?new Date(a).toLocaleString("en-US",{hour:"numeric",minute:"2-digit"}):"--",Lt=ut(()=>{if(!b.value)return[];const a=b.value.totals;return[{title:"Hours Logged Today",value:xt(a.hours_today),subtitle:"Completed work hours",accent:"border-blue-500 bg-blue-50 text-blue-700"},{title:"Hours Logged This Week",value:xt(a.hours_week),subtitle:"Monâ€“Sun total",accent:"border-indigo-500 bg-indigo-50 text-indigo-700"},{title:"Active Users Today",value:q(a.active_users_today),subtitle:"Unique employees with activity",accent:"border-emerald-500 bg-emerald-50 text-emerald-700"},{title:"Active Users This Week",value:q(a.active_users_week),subtitle:"Unique employees this week",accent:"border-teal-500 bg-teal-50 text-teal-700"},{title:"Avg Hours / User (Week)",value:xt(a.average_hours_per_user_week),subtitle:"Hours per active user",accent:"border-purple-500 bg-purple-50 text-purple-700"},{title:"Open Clock-ins",value:q(a.open_entries),subtitle:"Users still on the clock",accent:"border-amber-500 bg-amber-50 text-amber-700"}]}),Nt=ut(()=>{if(!b.value)return[];const a=b.value.totals;return[{label:"Late clock-ins today",value:q(a.late_clock_ins_today)},{label:"Completed entries today",value:q(a.total_entries_today)},{label:"Week window",value:`${pt(b.value.dates.week_start)} â†’ ${pt(b.value.dates.week_end)}`},{label:"Report generated",value:_t(b.value.generated_at)}]}),kt=ut(()=>{var a;return(((a=b.value)==null?void 0:a.open_entries.length)??0)>0}),x=d("overview"),g=d(null),w=d(""),L=d([]),wt=d([]),et=d(!1),_=d([]),S=d({workSeconds:0,breakSeconds:0,lunchSeconds:0,tasksCount:0,status:"No Entry",overtimeSeconds:0});d([]);const yt=d([]),st=d(!1),z=d(""),At=d(Date.now()),Ot=Gt(),at=ut(()=>{var e;const a=(e=Ot.props.auth)==null?void 0:e.user;return(a==null?void 0:a.role)==="developer"}),H=d(null),N=d(""),A=d(""),ot=d(!1),St=a=>{if(!a)return"";const e=new Date(a),s=e.getFullYear(),i=String(e.getMonth()+1).padStart(2,"0"),c=String(e.getDate()).padStart(2,"0"),m=String(e.getHours()).padStart(2,"0"),p=String(e.getMinutes()).padStart(2,"0"),C=String(e.getSeconds()).padStart(2,"0");return`${s}-${i}-${c}T${m}:${p}:${C}`},Ft=(a,e)=>{if(!a.entryId){alert("Cannot edit this entry - no entry ID found");return}H.value={index:e,name:a.name,start:a.start,end:a.end,entryId:a.entryId},N.value=a.start?St(a.start):"",A.value=a.end?St(a.end):""},bt=()=>{H.value=null,N.value="",A.value=""},Vt=async()=>{var a,e;if(!(!H.value||!H.value.entryId)){ot.value=!0;try{const s=N.value?new Date(N.value).toISOString():null,i=A.value?new Date(A.value).toISOString():null;await I.put(`/admin/time-entries/${H.value.entryId}`,{clock_in:s,clock_out:i}),await it(),bt()}catch(s){alert(((e=(a=s==null?void 0:s.response)==null?void 0:a.data)==null?void 0:e.message)||"Failed to update time entry")}finally{ot.value=!1}}},O=d(""),F=d(""),V=d([]),Z=d([]),lt=d({}),G=d([]),nt=d(null),W=d(!1),rt=d(null),Tt=()=>{const a=new Date,e=new Date;e.setDate(a.getDate()-13),O.value=e.toISOString().split("T")[0],F.value=a.toISOString().split("T")[0]},Wt=async()=>{try{const{data:a}=await I.get("/admin/teams",{params:{per_page:1e3}});Array.isArray(a)?G.value=a.map(e=>({id:e.id,name:e.name})):G.value=[]}catch(a){console.error("Error loading teams for user hours matrix",a),G.value=[]}},Pt=a=>a?a.split("T")[0]||a:"",Rt=(a,e)=>{const s=a.cells[e];if(!s)return"";const i=[];return s.timeIn&&i.push(`Time in: ${Y(s.timeIn)}`),s.timeOut&&i.push(`Time out: ${Y(s.timeOut)}`),i.join(`
`)},Dt=async()=>{var a,e;W.value=!0,rt.value=null;try{const s={};O.value&&(s.start_date=O.value),F.value&&(s.end_date=F.value),nt.value&&(s.team_id=nt.value);const{data:i}=await I.get("/admin/analytics/utilization/gaps",{params:s}),c=(i==null?void 0:i.data)||[];if(!c.length){V.value=[],Z.value=[],lt.value={};return}const m=new Set,p=new Set;c.forEach(o=>{o.user&&m.add(o.user),o.date&&p.add(o.date)});const C=Array.from(m).sort((o,u)=>o.localeCompare(u)),R=Array.from(p).sort((o,u)=>o.localeCompare(u)),M={},T={};R.forEach(o=>{M[o]={date:o,cells:{}}}),c.forEach(o=>{const u=M[o.date];if(!u)return;const v=o.user||"Unknown";u.cells[v]||(u.cells[v]={taskHours:0,workHours:0,timeIn:null,timeOut:null});const y=u.cells[v],J=Number.isFinite(o.worked_hours)?o.worked_hours:0,K=Number.isFinite(o.task_hours)?o.task_hours:0;y.workHours+=J,y.taskHours+=K,o.first_clock_in&&(!y.timeIn||new Date(o.first_clock_in)<new Date(y.timeIn))&&(y.timeIn=o.first_clock_in),o.last_clock_out&&(!y.timeOut||new Date(o.last_clock_out)>new Date(y.timeOut))&&(y.timeOut=o.last_clock_out),T[v]||(T[v]={taskHours:0,workHours:0}),T[v].workHours+=J,T[v].taskHours+=K}),V.value=C,Z.value=R.map(o=>M[o]),lt.value=T}catch(s){console.error("Error loading user hours matrix",s),rt.value=((e=(a=s==null?void 0:s.response)==null?void 0:a.data)==null?void 0:e.error)||"Unable to load user hours.",V.value=[],Z.value=[]}finally{W.value=!1}},Q=a=>{const e=typeof a=="number"&&isFinite(a)?Math.max(0,Math.floor(a)):0,s=Math.floor(e/3600),i=Math.floor(e%3600/60),c=e%60,m=p=>p<10?`0${p}`:`${p}`;return`${m(s)}:${m(i)}:${m(c)}`},Y=a=>{if(!a)return"--";try{const s=new Date(a);if(!isNaN(s.getTime()))return s.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!0,timeZone:xa})}catch{}const e=a.match(/\b(\d{1,2}):(\d{2})(?::(\d{2}))?/);if(e){let s=parseInt(e[1],10);const i=e[2],c=s>=12?"PM":"AM";return s=s%12,s===0&&(s=12),`${s}:${i} ${c}`}return"--"},P=a=>{if(!a)return null;const e=a.match(/^(\d{4})-(\d{2})-(\d{2})[ T](\d{2}):(\d{2})(?::(\d{2}))?/);if(e){const c=Number(e[1]),m=Number(e[2])-1,p=Number(e[3]),C=Number(e[4]),R=Number(e[5]),M=Number(e[6]||"0");return new Date(Date.UTC(c,m,p,C-8,R,M))}const s=a.includes("T")?a:a.replace(" ","T"),i=new Date(s);return isNaN(i.getTime())?null:i},jt=async()=>{try{const a=await I.get("/admin/analytics/users");L.value=a.data,!g.value&&L.value.length>0&&(g.value=L.value[0].id)}catch(a){console.error("Error loading users:",a)}},it=async()=>{var a;if(g.value){et.value=!0;try{const e=await I.get(`/admin/analytics/user/${g.value}`,{params:{start_date:w.value,end_date:w.value}}),s=((a=e.data)==null?void 0:a.entries)||e.data||[];wt.value=s,_.value=[];let i=0,c=0,m=null;s.forEach(o=>{var J,K,Ut,Ht;if(o.entry_type==="break"||o.is_break){const D=P(o.clock_in),E=P(o.clock_out);if(D&&E){const j=Math.max(0,Math.floor((E.getTime()-D.getTime())/1e3));c+=j,_.value.push({name:"Break",start:o.clock_in_formatted||o.clock_in,end:o.clock_out_formatted||o.clock_out,durationSeconds:j,breakDurationSeconds:j,notes:"-",entryId:o.id,entryType:"break"})}return}const u=P(o.clock_in),v=P(o.clock_out);u&&(!m||u<m)&&(m=u);const y=!!o.task&&(o.task.title||o.task.name);if(u&&v&&!y){const D=Math.max(0,Math.floor((v.getTime()-u.getTime())/1e3));i+=D;const E=P(o.lunch_start),j=P(o.lunch_end);let Ct=0;E&&j&&(Ct=Math.max(0,Math.floor((j.getTime()-E.getTime())/1e3)));const zt=Math.max(0,D-Ct);_.value.push({name:"Work Hours",start:o.clock_in_formatted||o.clock_in,end:o.clock_out_formatted||o.clock_out,durationSeconds:zt,breakDurationSeconds:0,notes:"-",entryId:o.id,entryType:"work"})}if(y&&u&&v){const D=Math.max(0,Math.floor((v.getTime()-u.getTime())/1e3));_.value.push({name:((J=o.task)==null?void 0:J.title)||((K=o.task)==null?void 0:K.name)||"Task",start:o.clock_in_formatted||o.clock_in,end:o.clock_out_formatted||o.clock_out,durationSeconds:D,breakDurationSeconds:0,notes:"-",entryId:o.id,entryType:"task"})}else if(y&&u&&!v){const E=Math.max(0,Math.floor((new Date().getTime()-u.getTime())/1e3));_.value.push({name:((Ut=o.task)==null?void 0:Ut.title)||((Ht=o.task)==null?void 0:Ht.name)||"Task",start:o.clock_in_formatted||o.clock_in,end:null,durationSeconds:E,breakDurationSeconds:0,notes:"In progress",entryId:o.id,entryType:"task"})}}),_.value.sort((o,u)=>{const v=new Date(o.start??"").getTime(),y=new Date(u.start??"").getTime();return(isNaN(y)?0:y)-(isNaN(v)?0:v)});const p=_.value.filter(o=>o.name==="Work Hours").reduce((o,u)=>o+(u.durationSeconds||0),0),C=_.value.filter(o=>o.name==="Break").reduce((o,u)=>o+(u.durationSeconds||0),0),R=8*3600,M=Math.max(0,p-R);let T="No Entry";if(m){const o=m,u=(o.getUTCHours()+8)%24,v=o.getUTCMinutes();T=u<8||u===8&&v<=30?"Perfect":"Late"}S.value={workSeconds:p,breakSeconds:C,lunchSeconds:0,tasksCount:_.value.length,status:T,overtimeSeconds:M}}catch(e){console.error("Error loading user daily analytics",e),wt.value=[],S.value={workSeconds:0,breakSeconds:0,lunchSeconds:0,tasksCount:0,status:"No Entry",overtimeSeconds:0}}finally{et.value=!1}}},dt=async(a=!1)=>{a||(st.value=!0);try{const e={limit:100};z.value&&(e.action=z.value);const s=await I.get("/admin/analytics/activity-logs",{params:e});yt.value=s.data.data,At.value=Date.now()}catch(e){console.error("Error loading activity logs:",e),a||alert("Failed to load activity logs")}finally{st.value=!1}},Bt=()=>{if(!g.value){alert("Please select a user first");return}const a=new URLSearchParams({user_id:String(g.value),start_date:w.value,end_date:w.value});window.location.href=`/api/admin/analytics/user-summary/export/csv?${a.toString()}`},qt=()=>{if(!g.value){alert("Please select a user first");return}const a=new URLSearchParams({user_id:String(g.value),start_date:w.value,end_date:w.value});window.location.href=`/api/admin/analytics/user-summary/export/pdf?${a.toString()}`};return Qt(()=>{const a=new Date;w.value=a.toISOString().split("T")[0],jt(),dt(),gt(),Tt(),Wt()}),ct(x,a=>{a==="overview"?gt():a==="summary"?(!g.value&&L.value.length>0&&(g.value=L.value[0].id),g.value&&it()):a==="activity"?dt(!0):a==="user-hours"&&((!O.value||!F.value)&&Tt(),Dt())}),ct(g,a=>{x.value==="summary"&&a&&it()}),ct(w,()=>{x.value==="summary"&&g.value&&it()}),ct(z,()=>{x.value==="activity"&&dt(!0)}),(a,e)=>(n(),l(h,null,[Mt(Yt(Jt),{title:"Analytics"}),Mt(Kt,null,{header:Et(()=>[...e[13]||(e[13]=[t("h2",{class:"text-xl font-semibold leading-tight text-gray-800"}," Analytics & Reports ",-1)])]),default:Et(()=>[t("div",Xt,[t("div",te,[t("div",ee,[t("nav",se,[t("button",{onClick:e[0]||(e[0]=s=>x.value="overview"),class:$(["whitespace-nowrap border-b-2 py-4 px-1 text-sm font-medium",x.value==="overview"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700"])}," Overview ",2),t("button",{onClick:e[1]||(e[1]=s=>x.value="summary"),class:$(["whitespace-nowrap border-b-2 py-4 px-1 text-sm font-medium",x.value==="summary"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700"])}," User Summary ",2),t("button",{onClick:e[2]||(e[2]=s=>x.value="user-hours"),class:$(["whitespace-nowrap border-b-2 py-4 px-1 text-sm font-medium",x.value==="user-hours"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700"])}," User Hours ",2),t("button",{onClick:e[3]||(e[3]=s=>x.value="activity"),class:$(["whitespace-nowrap border-b-2 py-4 px-1 text-sm font-medium",x.value==="activity"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700"])}," Activity Log ",2)])]),x.value==="overview"?(n(),l("div",ae,[t("section",oe,[t("div",le,[t("div",null,[e[14]||(e[14]=t("h3",{class:"text-lg font-semibold text-gray-900"},"Company Health Overview",-1)),b.value?(n(),l("p",ne," As of "+r(_t(b.value.generated_at)),1)):f("",!0)]),t("div",re,[t("button",{type:"button",onClick:ht,disabled:B.value||vt.value,class:"inline-flex items-center gap-2 rounded-md border border-indigo-200 bg-white px-4 py-2 text-sm font-medium text-indigo-600 shadow-sm transition hover:bg-indigo-50 disabled:cursor-not-allowed disabled:border-gray-200 disabled:text-gray-400"},[B.value?(n(),l("span",de)):f("",!0),t("span",null,r(B.value?"Refreshingâ€¦":"Refresh"),1)],8,ie)])]),vt.value?(n(),l("div",ue,[...e[15]||(e[15]=[t("div",{class:"mx-auto mb-3 h-8 w-8 animate-spin rounded-full border-b-2 border-indigo-600"},null,-1),mt(" Loading analytics summaryâ€¦ ",-1)])])):tt.value?(n(),l("div",ce,[t("div",null,[e[16]||(e[16]=t("h4",{class:"font-semibold text-red-800"},"We couldnâ€™t load the analytics overview.",-1)),t("p",me,r(tt.value),1)]),t("div",null,[t("button",{type:"button",onClick:ht,class:"inline-flex items-center rounded-md bg-red-600 px-4 py-2 text-sm font-medium text-white shadow-sm transition hover:bg-red-500"}," Try again ")])])):b.value?(n(),l("div",ve,[t("div",ge,[(n(!0),l(h,null,k(Lt.value,s=>(n(),l("div",{key:s.title,class:$(["rounded-xl border bg-white p-6 shadow-sm transition hover:-translate-y-1 hover:shadow-md",s.accent])},[t("h4",xe,r(s.title),1),t("p",pe,r(s.value),1),t("p",ye,r(s.subtitle),1)],2))),128))]),t("div",be,[t("div",fe,[t("div",he,[e[17]||(e[17]=t("h4",{class:"text-base font-semibold text-gray-800"},"Whoâ€™s still on the clock",-1)),t("p",_e,r(kt.value?"Top 10 current sessions":"No one is clocked in right now."),1)]),kt.value?(n(),l("div",ke,[(n(!0),l(h,null,k(b.value.open_entries,s=>(n(),l("div",{key:s.entry_id,class:"flex items-center justify-between gap-3 px-5 py-4"},[t("div",null,[t("p",we,r(s.user.name||"Unknown User"),1),t("p",Se,[mt(r(s.user.email||"No email listed")+" ",1),s.user.team?(n(),l("span",Te,"Â· "+r(s.user.team),1)):f("",!0)])]),t("div",De,[t("p",Ue,r($t(s.minutes_running)),1),t("p",He,"since "+r(It(s.clock_in)),1)])]))),128))])):(n(),l("div",Ce," All clocks are cleared for today. Great job! "))]),t("div",Me,[e[18]||(e[18]=t("div",{class:"border-b border-gray-100 px-5 py-4"},[t("h4",{class:"text-base font-semibold text-gray-800"},"At a glance"),t("p",{class:"text-sm text-gray-500"},"Quick context for today and the week.")],-1)),t("dl",Ee,[(n(!0),l(h,null,k(Nt.value,s=>(n(),l("div",{key:s.label,class:"flex items-center justify-between gap-4"},[t("dt",$e,r(s.label),1),t("dd",Ie,r(s.value),1)]))),128))])])])])):f("",!0)])])):x.value==="summary"?(n(),l("div",Le,[t("div",Ne,[t("div",Ae,[t("div",null,[e[20]||(e[20]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"User",-1)),U(t("select",{"onUpdate:modelValue":e[4]||(e[4]=s=>g.value=s),class:"w-full rounded-md border-gray-300 shadow-sm"},[e[19]||(e[19]=t("option",{value:null},"Select User",-1)),(n(!0),l(h,null,k(L.value,s=>(n(),l("option",{key:s.id,value:s.id},r(s.name),9,Oe))),128))],512),[[ft,g.value]])]),t("div",null,[e[21]||(e[21]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Date",-1)),U(t("input",{"onUpdate:modelValue":e[5]||(e[5]=s=>w.value=s),type:"date",class:"w-full rounded-md border-gray-300 shadow-sm"},null,512),[[X,w.value]])]),t("div",Fe,[t("button",{onClick:Bt,disabled:!g.value,class:"flex-1 rounded-md bg-green-600 px-4 py-2 text-sm font-medium text-white shadow-sm hover:bg-green-500 disabled:bg-gray-400 disabled:cursor-not-allowed"}," Export CSV ",8,Ve),t("button",{onClick:qt,disabled:!g.value,class:"flex-1 rounded-md bg-red-600 px-4 py-2 text-sm font-medium text-white shadow-sm hover:bg-red-500 disabled:bg-gray-400 disabled:cursor-not-allowed"}," Export PDF ",8,We)])])]),t("div",Pe,[e[27]||(e[27]=t("h3",{class:"text-lg font-medium leading-6 text-gray-900 mb-4"},"Daily Summary",-1)),t("div",Re,[t("div",null,[e[22]||(e[22]=t("div",{class:"text-gray-500"},"ðŸ•’ Time In Hours",-1)),t("div",je,r(Q(S.value.workSeconds)),1)]),t("div",null,[e[23]||(e[23]=t("div",{class:"text-gray-500"},"â˜• Total Breaks",-1)),t("div",Be,r(Q(S.value.breakSeconds)),1)]),t("div",null,[e[24]||(e[24]=t("div",{class:"text-gray-500"},"ðŸ“‹ Entries",-1)),t("div",qe,r(S.value.tasksCount),1)]),t("div",null,[e[25]||(e[25]=t("div",{class:"text-gray-500"},"â° Status",-1)),t("div",{class:$(["font-semibold",{"text-green-700":S.value.status==="Perfect","text-yellow-700":S.value.status==="Late","text-gray-700":S.value.status==="No Entry"}])},r(S.value.status),3)]),t("div",null,[e[26]||(e[26]=t("div",{class:"text-gray-500"},"âš¡ Overtime",-1)),t("div",ze,r(Q(S.value.overtimeSeconds)),1)])])]),t("div",Ze,[t("div",Ge,[t("table",Qe,[t("thead",Ye,[t("tr",null,[e[28]||(e[28]=t("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Task",-1)),e[29]||(e[29]=t("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Start Time",-1)),e[30]||(e[30]=t("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"End Time",-1)),e[31]||(e[31]=t("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Duration",-1)),e[32]||(e[32]=t("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Break Duration",-1)),e[33]||(e[33]=t("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Notes",-1)),at.value?(n(),l("th",Je,"Actions")):f("",!0)])]),t("tbody",Ke,[(n(!0),l(h,null,k(_.value,(s,i)=>(n(),l("tr",{key:i},[t("td",Xe,r(s.name),1),t("td",ts,r(Y(s.start)),1),t("td",es,r(Y(s.end)),1),t("td",ss,r(Q(s.durationSeconds)),1),t("td",as,r(Q(s.breakDurationSeconds||0)),1),t("td",os,r(s.notes||"-"),1),at.value?(n(),l("td",ls,[s.entryId?(n(),l("button",{key:0,onClick:c=>Ft(s,i),class:"text-indigo-600 hover:text-indigo-900 text-xs font-medium"}," Edit ",8,ns)):(n(),l("span",rs,"-"))])):f("",!0)]))),128)),_.value.length===0&&!et.value?(n(),l("tr",is,[t("td",{colspan:at.value?7:6,class:"px-4 py-4 text-center text-sm text-gray-500"},"No entries for selected day",8,ds)])):f("",!0)])])]),et.value?(n(),l("div",us,[...e[34]||(e[34]=[t("div",{class:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600"},null,-1),t("p",{class:"mt-2 text-sm text-gray-500"},"Loading...",-1)])])):f("",!0)])])):x.value==="activity"?(n(),l("div",cs,[t("div",ms,[t("div",vs,[e[36]||(e[36]=t("h3",{class:"text-lg font-medium text-gray-900"},"Real-Time Activity Log",-1)),t("div",gs,[e[35]||(e[35]=t("div",{class:"flex items-center gap-2 text-sm text-gray-600"},[t("span",{class:"inline-block w-2 h-2 bg-green-500 rounded-full animate-pulse"}),t("span",null,"Live Updates")],-1)),t("button",{onClick:e[6]||(e[6]=s=>dt()),class:"rounded-md bg-indigo-600 px-3 py-1.5 text-xs font-medium text-white shadow-sm hover:bg-indigo-500"}," Refresh ")])]),t("div",xs,[t("div",null,[e[38]||(e[38]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Filter by Action",-1)),U(t("select",{"onUpdate:modelValue":e[7]||(e[7]=s=>z.value=s),class:"w-full rounded-md border-gray-300 shadow-sm"},[...e[37]||(e[37]=[t("option",{value:""},"All Actions",-1),t("option",{value:"clock_in"},"Clock In",-1),t("option",{value:"clock_out"},"Clock Out",-1),t("option",{value:"break_start"},"Break Start",-1),t("option",{value:"break_end"},"Break End",-1),t("option",{value:"lunch_start"},"Lunch Start",-1),t("option",{value:"lunch_end"},"Lunch End",-1)])],512),[[ft,z.value]])])])]),t("div",ps,[t("div",ys,[t("table",bs,[e[40]||(e[40]=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"User"),t("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Action"),t("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Description"),t("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Time")])],-1)),t("tbody",fs,[(n(!0),l(h,null,k(yt.value,s=>{var i,c,m;return n(),l("tr",{key:s.id,class:"hover:bg-gray-50"},[t("td",hs,[t("div",_s,[t("div",ks,[t("div",ws,[t("span",Ss,r((i=s.user)!=null&&i.name?s.user.name.charAt(0).toUpperCase():"?"),1)])]),t("div",Ts,[t("div",Ds,r(((c=s.user)==null?void 0:c.name)||"Unknown User"),1),t("div",Us,r((m=s.user)==null?void 0:m.email),1)])])]),t("td",Hs,[t("span",{class:$(["px-2 inline-flex text-xs leading-5 font-semibold rounded-full",{"bg-green-100 text-green-800":s.action==="clock_in","bg-red-100 text-red-800":s.action==="clock_out","bg-yellow-100 text-yellow-800":s.action.includes("break"),"bg-blue-100 text-blue-800":s.action.includes("lunch")}])},r(s.action.replace("_"," ").replace(/\b\w/g,p=>p.toUpperCase())),3)]),t("td",Cs,[t("div",Ms,r(s.description),1)]),t("td",Es,[mt(r(pt(s.created_at))+" ",1),t("div",$s,r(Y(s.created_at)),1)])])}),128)),yt.value.length===0&&!st.value?(n(),l("tr",Is,[...e[39]||(e[39]=[t("td",{colspan:"4",class:"px-4 py-4 text-center text-sm text-gray-500"},"No activity logs found",-1)])])):f("",!0)])])]),st.value?(n(),l("div",Ls,[...e[41]||(e[41]=[t("div",{class:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600"},null,-1),t("p",{class:"mt-2 text-sm text-gray-500"},"Loading...",-1)])])):f("",!0)])])):x.value==="user-hours"?(n(),l("div",Ns,[t("div",As,[e[46]||(e[46]=t("div",null,[t("h3",{class:"text-lg font-semibold text-gray-900"},"User Hours Matrix"),t("p",{class:"text-sm text-gray-500"}," Each cell shows Task Hours / Work Hours for that user and date. Totals per user are shown in the bottom row. ")],-1)),t("div",Os,[G.value.length?(n(),l("div",Fs,[e[43]||(e[43]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Team",-1)),U(t("select",{"onUpdate:modelValue":e[8]||(e[8]=s=>nt.value=s),class:"rounded-md border-gray-300 shadow-sm text-sm min-w-[10rem]"},[e[42]||(e[42]=t("option",{value:null},"All Teams",-1)),(n(!0),l(h,null,k(G.value,s=>(n(),l("option",{key:s.id,value:s.id},r(s.name),9,Vs))),128))],512),[[ft,nt.value,void 0,{number:!0}]])])):f("",!0),t("div",null,[e[44]||(e[44]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Start Date",-1)),U(t("input",{type:"date","onUpdate:modelValue":e[9]||(e[9]=s=>O.value=s),class:"rounded-md border-gray-300 shadow-sm text-sm"},null,512),[[X,O.value]])]),t("div",null,[e[45]||(e[45]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"End Date",-1)),U(t("input",{type:"date","onUpdate:modelValue":e[10]||(e[10]=s=>F.value=s),class:"rounded-md border-gray-300 shadow-sm text-sm"},null,512),[[X,F.value]])]),t("button",{type:"button",onClick:Dt,disabled:W.value,class:"inline-flex items-center gap-2 rounded-md bg-indigo-600 px-4 py-2 text-sm font-medium text-white shadow-sm hover:bg-indigo-500 disabled:opacity-60 disabled:cursor-not-allowed"},[W.value?(n(),l("span",Ps)):f("",!0),t("span",null,r(W.value?"Loadingâ€¦":"Apply"),1)],8,Ws)])]),rt.value?(n(),l("div",Rs,[t("p",js,r(rt.value),1)])):(n(),l("div",Bs,[W.value?(n(),l("div",qs,[...e[47]||(e[47]=[t("div",{class:"mx-auto mb-3 h-8 w-8 animate-spin rounded-full border-b-2 border-indigo-600"},null,-1),mt(" Loading user hoursâ€¦ ",-1)])])):Z.value.length?(n(),l("div",Zs,[t("table",Gs,[t("thead",Qs,[t("tr",null,[e[48]||(e[48]=t("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"}," Date ",-1)),(n(!0),l(h,null,k(V.value,s=>(n(),l("th",{key:s,class:"px-4 py-3 text-center text-xs font-medium uppercase tracking-wider text-gray-500"},r(s),1))),128))])]),t("tbody",Ys,[(n(!0),l(h,null,k(Z.value,s=>(n(),l("tr",{key:s.date},[t("td",Js,r(Pt(s.date)),1),(n(!0),l(h,null,k(V.value,i=>(n(),l("td",{key:i+s.date,class:"px-4 py-3 text-center align-top",title:Rt(s,i)},[s.cells[i]?(n(),l("div",Xs,[t("div",ta," Work: "+r(s.cells[i].workHours.toFixed(2))+" h ",1),t("div",ea," Task: "+r(s.cells[i].taskHours.toFixed(2))+" h ",1)])):(n(),l("div",sa,"â€”"))],8,Ks))),128))]))),128))]),t("tfoot",aa,[t("tr",null,[e[49]||(e[49]=t("th",{class:"px-4 py-3 text-sm font-semibold text-gray-900 text-right"}," Totals ",-1)),(n(!0),l(h,null,k(V.value,s=>{var i,c;return n(),l("td",{key:s+"-total",class:"px-4 py-3 text-xs text-gray-900 text-center"},[t("div",oa," Task: "+r((((i=lt.value[s])==null?void 0:i.taskHours)??0).toFixed(2))+" h ",1),t("div",la," Work: "+r((((c=lt.value[s])==null?void 0:c.workHours)??0).toFixed(2))+" h ",1)])}),128))])])])])):(n(),l("div",zs," No data for selected range. "))]))])):f("",!0)])]),H.value&&at.value?(n(),l("div",na,[t("div",ra,[t("div",{class:"flex items-center justify-between border-b px-4 py-3"},[e[50]||(e[50]=t("h4",{class:"text-md font-semibold"},"Edit Time Entry",-1)),t("button",{onClick:bt,class:"rounded-md bg-gray-100 px-2 py-1 text-xs hover:bg-gray-200"},"Close")]),t("div",ia,[t("div",da,[e[51]||(e[51]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Task",-1)),t("input",{type:"text",value:H.value.name,disabled:"",class:"w-full rounded-md border-gray-300 bg-gray-50 text-sm"},null,8,ua)]),t("div",ca,[e[52]||(e[52]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Start Time",-1)),U(t("input",{"onUpdate:modelValue":e[11]||(e[11]=s=>N.value=s),type:"datetime-local",class:"w-full rounded-md border-gray-300 shadow-sm text-sm",step:"1"},null,512),[[X,N.value]])]),t("div",ma,[e[53]||(e[53]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"End Time",-1)),U(t("input",{"onUpdate:modelValue":e[12]||(e[12]=s=>A.value=s),type:"datetime-local",class:"w-full rounded-md border-gray-300 shadow-sm text-sm",step:"1"},null,512),[[X,A.value]])]),t("div",va,[t("button",{onClick:bt,class:"rounded-md bg-gray-200 px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-300"}," Cancel "),t("button",{onClick:Vt,disabled:ot.value,class:"rounded-md bg-indigo-600 px-4 py-2 text-sm font-medium text-white hover:bg-indigo-700 disabled:opacity-50"},r(ot.value?"Saving...":"Save"),9,ga)])])])])):f("",!0)]),_:1})],64))}});export{ha as default};
