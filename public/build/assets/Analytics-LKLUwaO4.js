import{d as Ft,r as u,c as ct,o as Ot,w as at,a as l,b as wt,u as Wt,h as Bt,e as St,f as t,g as _,n as C,i as r,t as n,j as ot,F as b,k,l as O,v as mt,m as vt}from"./app-DOJPH2Qp.js";import{_ as Pt}from"./AuthenticatedLayout.vue_vue_type_script_setup_true_lang-CnwXMFd2.js";import{a as W}from"./api-CR7kYWof.js";const Rt={class:"py-12"},Vt={class:"mx-auto max-w-7xl sm:px-6 lg:px-8"},jt={class:"border-b border-gray-200 mb-6"},qt={class:"-mb-px flex space-x-8"},zt={key:0,class:"space-y-8"},Zt={class:"space-y-6"},Gt={class:"flex flex-wrap items-center justify-between gap-3"},Qt={key:0,class:"text-sm text-gray-500"},Jt={class:"flex items-center gap-2"},Kt=["disabled"],Xt={key:0,class:"h-3 w-3 animate-spin rounded-full border-2 border-indigo-500 border-t-transparent"},Yt={key:0,class:"bg-white shadow rounded-lg p-10 text-center text-sm text-gray-500"},te={key:1,class:"bg-red-50 border border-red-200 text-red-700 rounded-lg p-6 flex flex-col gap-4"},ee={class:"text-sm"},se={key:2,class:"space-y-8"},ae={class:"grid gap-4 md:grid-cols-2 xl:grid-cols-3"},oe={class:"text-sm font-semibold uppercase tracking-wide text-gray-500"},le={class:"mt-2 text-3xl font-bold"},re={class:"mt-2 text-sm text-gray-600"},ne={class:"grid gap-6 lg:grid-cols-2"},ie={class:"rounded-xl bg-white shadow-sm"},de={class:"border-b border-gray-100 px-5 py-4"},ue={class:"text-sm text-gray-500"},ce={key:0,class:"divide-y divide-gray-100"},me={class:"font-medium text-gray-900"},ve={class:"text-sm text-gray-500"},xe={key:0,class:"ml-1 text-gray-400"},ge={class:"text-right"},pe={class:"text-sm font-semibold text-indigo-600"},ye={class:"text-xs text-gray-500"},he={key:1,class:"px-5 py-6 text-sm text-gray-500"},be={class:"rounded-xl bg-white shadow-sm"},fe={class:"space-y-4 px-5 py-6"},_e={class:"text-sm font-medium text-gray-600"},ke={class:"text-sm font-semibold text-gray-900 text-right"},we={key:1,class:"space-y-6"},Se={class:"bg-white shadow rounded-lg p-4"},Te={class:"grid gap-4 sm:grid-cols-3"},De=["value"],Ue={class:"flex items-end gap-2"},He=["disabled"],Ce=["disabled"],Me={class:"bg-white shadow rounded-lg p-5"},Ne={class:"grid gap-4 sm:grid-cols-3 lg:grid-cols-5 text-sm"},Le={class:"font-semibold"},Ae={class:"font-semibold"},Ee={class:"font-semibold"},$e={class:"font-semibold"},Ie={class:"bg-white shadow rounded-lg"},Fe={class:"overflow-x-auto"},Oe={class:"min-w-full divide-y divide-gray-200"},We={class:"divide-y divide-gray-200"},Be={class:"px-4 py-4 text-sm text-gray-900"},Pe={class:"px-4 py-4 text-sm text-gray-500"},Re={class:"px-4 py-4 text-sm text-gray-500"},Ve={class:"px-4 py-4 text-sm text-gray-900 font-semibold"},je={class:"px-4 py-4 text-sm text-gray-500"},qe={class:"px-4 py-4 text-sm text-gray-500"},ze={key:0},Ze={key:0,class:"text-center py-8"},Ge={key:2,class:"space-y-6"},Qe={class:"bg-white shadow rounded-lg p-4"},Je={class:"flex justify-between items-center mb-4"},Ke={class:"flex items-center gap-2"},Xe={class:"grid gap-4 sm:grid-cols-2"},Ye={class:"bg-white shadow rounded-lg"},ts={class:"overflow-x-auto"},es={class:"min-w-full divide-y divide-gray-200"},ss={class:"divide-y divide-gray-200 bg-white"},as={class:"px-4 py-4 whitespace-nowrap"},os={class:"flex items-center"},ls={class:"flex-shrink-0 h-10 w-10"},rs={class:"h-10 w-10 rounded-full bg-indigo-100 flex items-center justify-center"},ns={class:"text-indigo-600 font-medium"},is={class:"ml-4"},ds={class:"text-sm font-medium text-gray-900"},us={class:"text-sm text-gray-500"},cs={class:"px-4 py-4 whitespace-nowrap"},ms={class:"px-4 py-4"},vs={class:"text-sm text-gray-900"},xs={class:"px-4 py-4 whitespace-nowrap text-sm text-gray-500"},gs={class:"text-xs text-gray-400"},ps={key:0},ys={key:0,class:"text-center py-8"},hs={key:3,class:"space-y-6"},bs={class:"bg-white shadow rounded-lg p-4 flex flex-wrap items-end gap-4"},fs={class:"ml-auto flex flex-wrap items-end gap-3"},_s={key:0},ks=["value"],ws=["disabled"],Ss={key:0,class:"h-3 w-3 animate-spin rounded-full border-2 border-white border-t-transparent"},Ts={key:0,class:"bg-red-50 border border-red-200 text-red-700 rounded-lg p-4"},Ds={class:"text-sm"},Us={key:1,class:"bg-white shadow rounded-lg"},Hs={key:0,class:"p-8 text-center text-sm text-gray-500"},Cs={key:1,class:"p-8 text-center text-sm text-gray-500"},Ms={key:2,class:"overflow-x-auto"},Ns={class:"min-w-full divide-y divide-gray-200"},Ls={class:"bg-gray-50"},As={class:"divide-y divide-gray-200 bg-white"},Es={class:"px-4 py-3 text-sm text-gray-900 whitespace-nowrap"},$s=["title"],Is={key:0,class:"space-y-0.5"},Fs={class:"text-sm font-semibold text-gray-900"},Os={class:"text-xs text-gray-500"},Ws={key:1,class:"text-xs text-gray-300"},Bs={class:"bg-gray-50 border-t border-gray-200"},Ps={class:"font-semibold text-indigo-700"},Rs={class:"text-gray-700"},Vs="Asia/Manila",Gs=Ft({__name:"Analytics",setup(js){const y=u(null),lt=u(!0),J=u(null),B=u(!1),rt=async()=>{var a,e;try{J.value=null;const{data:s}=await W.get("/admin/analytics/summary");y.value=s}catch(s){console.error(s),J.value=((e=(a=s==null?void 0:s.response)==null?void 0:a.data)==null?void 0:e.error)||"Unable to load analytics summary.",y.value=null}finally{lt.value=!1,B.value=!1}},xt=async()=>{B.value=!0,await rt()},nt=a=>`${a.toFixed(2)} h`,P=a=>a.toLocaleString(),it=a=>new Date(a).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),gt=a=>new Date(a).toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"}),Tt=a=>{if(a===null)return"--";const e=Math.floor(a/60),s=a%60;return e===0?`${s}m`:`${e}h ${s}m`},Dt=a=>a?new Date(a).toLocaleString("en-US",{hour:"numeric",minute:"2-digit"}):"--",Ut=ct(()=>{if(!y.value)return[];const a=y.value.totals;return[{title:"Hours Logged Today",value:nt(a.hours_today),subtitle:"Completed work hours",accent:"border-blue-500 bg-blue-50 text-blue-700"},{title:"Hours Logged This Week",value:nt(a.hours_week),subtitle:"Monâ€“Sun total",accent:"border-indigo-500 bg-indigo-50 text-indigo-700"},{title:"Active Users Today",value:P(a.active_users_today),subtitle:"Unique employees with activity",accent:"border-emerald-500 bg-emerald-50 text-emerald-700"},{title:"Active Users This Week",value:P(a.active_users_week),subtitle:"Unique employees this week",accent:"border-teal-500 bg-teal-50 text-teal-700"},{title:"Avg Hours / User (Week)",value:nt(a.average_hours_per_user_week),subtitle:"Hours per active user",accent:"border-purple-500 bg-purple-50 text-purple-700"},{title:"Open Clock-ins",value:P(a.open_entries),subtitle:"Users still on the clock",accent:"border-amber-500 bg-amber-50 text-amber-700"}]}),Ht=ct(()=>{if(!y.value)return[];const a=y.value.totals;return[{label:"Late clock-ins today",value:P(a.late_clock_ins_today)},{label:"Completed entries today",value:P(a.total_entries_today)},{label:"Week window",value:`${it(y.value.dates.week_start)} â†’ ${it(y.value.dates.week_end)}`},{label:"Report generated",value:gt(y.value.generated_at)}]}),pt=ct(()=>{var a;return(((a=y.value)==null?void 0:a.open_entries.length)??0)>0}),g=u("overview"),m=u(null),w=u(""),M=u([]),yt=u([]),K=u(!1),f=u([]),S=u({workSeconds:0,breakSeconds:0,lunchSeconds:0,tasksCount:0,status:"No Entry",overtimeSeconds:0});u([]);const dt=u([]),X=u(!1),R=u(""),Ct=u(Date.now()),N=u(""),L=u(""),A=u([]),V=u([]),Y=u({}),j=u([]),tt=u(null),E=u(!1),et=u(null),ht=()=>{const a=new Date,e=new Date;e.setDate(a.getDate()-13),N.value=e.toISOString().split("T")[0],L.value=a.toISOString().split("T")[0]},Mt=async()=>{try{const{data:a}=await W.get("/admin/teams",{params:{per_page:1e3}});Array.isArray(a)?j.value=a.map(e=>({id:e.id,name:e.name})):j.value=[]}catch(a){console.error("Error loading teams for user hours matrix",a),j.value=[]}},Nt=a=>a?a.split("T")[0]||a:"",Lt=(a,e)=>{const s=a.cells[e];if(!s)return"";const i=[];return s.timeIn&&i.push(`Time in: ${z(s.timeIn)}`),s.timeOut&&i.push(`Time out: ${z(s.timeOut)}`),i.join(`
`)},bt=async()=>{var a,e;E.value=!0,et.value=null;try{const s={};N.value&&(s.start_date=N.value),L.value&&(s.end_date=L.value),tt.value&&(s.team_id=tt.value);const{data:i}=await W.get("/admin/analytics/utilization/gaps",{params:s}),v=(i==null?void 0:i.data)||[];if(!v.length){A.value=[],V.value=[],Y.value={};return}const x=new Set,h=new Set;v.forEach(o=>{o.user&&x.add(o.user),o.date&&h.add(o.date)});const Z=Array.from(x).sort((o,d)=>o.localeCompare(d)),I=Array.from(h).sort((o,d)=>o.localeCompare(d)),U={},T={};I.forEach(o=>{U[o]={date:o,cells:{}}}),v.forEach(o=>{const d=U[o.date];if(!d)return;const c=o.user||"Unknown";d.cells[c]||(d.cells[c]={taskHours:0,workHours:0,timeIn:null,timeOut:null});const p=d.cells[c],G=Number.isFinite(o.worked_hours)?o.worked_hours:0,Q=Number.isFinite(o.task_hours)?o.task_hours:0;p.workHours+=G,p.taskHours+=Q,o.first_clock_in&&(!p.timeIn||new Date(o.first_clock_in)<new Date(p.timeIn))&&(p.timeIn=o.first_clock_in),o.last_clock_out&&(!p.timeOut||new Date(o.last_clock_out)>new Date(p.timeOut))&&(p.timeOut=o.last_clock_out),T[c]||(T[c]={taskHours:0,workHours:0}),T[c].workHours+=G,T[c].taskHours+=Q}),A.value=Z,V.value=I.map(o=>U[o]),Y.value=T}catch(s){console.error("Error loading user hours matrix",s),et.value=((e=(a=s==null?void 0:s.response)==null?void 0:a.data)==null?void 0:e.error)||"Unable to load user hours.",A.value=[],V.value=[]}finally{E.value=!1}},q=a=>{const e=typeof a=="number"&&isFinite(a)?Math.max(0,Math.floor(a)):0,s=Math.floor(e/3600),i=Math.floor(e%3600/60),v=e%60,x=h=>h<10?`0${h}`:`${h}`;return`${x(s)}:${x(i)}:${x(v)}`},z=a=>{if(!a)return"--";try{const s=new Date(a);if(!isNaN(s.getTime()))return s.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!0,timeZone:Vs})}catch{}const e=a.match(/\b(\d{1,2}):(\d{2})(?::(\d{2}))?/);if(e){let s=parseInt(e[1],10);const i=e[2],v=s>=12?"PM":"AM";return s=s%12,s===0&&(s=12),`${s}:${i} ${v}`}return"--"},$=a=>{if(!a)return null;const e=a.match(/^(\d{4})-(\d{2})-(\d{2})[ T](\d{2}):(\d{2})(?::(\d{2}))?/);if(e){const v=Number(e[1]),x=Number(e[2])-1,h=Number(e[3]),Z=Number(e[4]),I=Number(e[5]),U=Number(e[6]||"0");return new Date(Date.UTC(v,x,h,Z-8,I,U))}const s=a.includes("T")?a:a.replace(" ","T"),i=new Date(s);return isNaN(i.getTime())?null:i},At=async()=>{try{const a=await W.get("/admin/analytics/users");M.value=a.data,!m.value&&M.value.length>0&&(m.value=M.value[0].id)}catch(a){console.error("Error loading users:",a)}},ut=async()=>{var a;if(m.value){K.value=!0;try{const e=await W.get(`/admin/analytics/user/${m.value}`,{params:{start_date:w.value,end_date:w.value}}),s=((a=e.data)==null?void 0:a.entries)||e.data||[];yt.value=s,f.value=[];let i=0,v=0,x=null;s.forEach(o=>{var G,Q,ft,_t;if(o.entry_type==="break"||o.is_break){const D=$(o.clock_in),H=$(o.clock_out);if(D&&H){const F=Math.max(0,Math.floor((H.getTime()-D.getTime())/1e3));v+=F,f.value.push({name:"Break",start:o.clock_in_formatted||o.clock_in,end:o.clock_out_formatted||o.clock_out,durationSeconds:F,breakDurationSeconds:F,notes:"-"})}return}const d=$(o.clock_in),c=$(o.clock_out);d&&(!x||d<x)&&(x=d);const p=!!o.task&&(o.task.title||o.task.name);if(d&&c&&!p){const D=Math.max(0,Math.floor((c.getTime()-d.getTime())/1e3));i+=D;const H=$(o.lunch_start),F=$(o.lunch_end);let kt=0;H&&F&&(kt=Math.max(0,Math.floor((F.getTime()-H.getTime())/1e3)));const It=Math.max(0,D-kt);f.value.push({name:"Work Hours",start:o.clock_in_formatted||o.clock_in,end:o.clock_out_formatted||o.clock_out,durationSeconds:It,breakDurationSeconds:0,notes:"-"})}if(p&&d&&c){const D=Math.max(0,Math.floor((c.getTime()-d.getTime())/1e3));f.value.push({name:((G=o.task)==null?void 0:G.title)||((Q=o.task)==null?void 0:Q.name)||"Task",start:o.clock_in_formatted||o.clock_in,end:o.clock_out_formatted||o.clock_out,durationSeconds:D,breakDurationSeconds:0,notes:"-"})}else if(p&&d&&!c){const H=Math.max(0,Math.floor((new Date().getTime()-d.getTime())/1e3));f.value.push({name:((ft=o.task)==null?void 0:ft.title)||((_t=o.task)==null?void 0:_t.name)||"Task",start:o.clock_in_formatted||o.clock_in,end:null,durationSeconds:H,breakDurationSeconds:0,notes:"In progress"})}}),f.value.sort((o,d)=>{const c=new Date(o.start??"").getTime(),p=new Date(d.start??"").getTime();return(isNaN(p)?0:p)-(isNaN(c)?0:c)});const h=f.value.filter(o=>o.name==="Work Hours").reduce((o,d)=>o+(d.durationSeconds||0),0),Z=f.value.filter(o=>o.name==="Break").reduce((o,d)=>o+(d.durationSeconds||0),0),I=8*3600,U=Math.max(0,h-I);let T="No Entry";if(x){const o=x,d=(o.getUTCHours()+8)%24,c=o.getUTCMinutes();T=d<8||d===8&&c<=30?"Perfect":"Late"}S.value={workSeconds:h,breakSeconds:Z,lunchSeconds:0,tasksCount:f.value.length,status:T,overtimeSeconds:U}}catch(e){console.error("Error loading user daily analytics",e),yt.value=[],S.value={workSeconds:0,breakSeconds:0,lunchSeconds:0,tasksCount:0,status:"No Entry",overtimeSeconds:0}}finally{K.value=!1}}},st=async(a=!1)=>{a||(X.value=!0);try{const e={limit:100};R.value&&(e.action=R.value);const s=await W.get("/admin/analytics/activity-logs",{params:e});dt.value=s.data.data,Ct.value=Date.now()}catch(e){console.error("Error loading activity logs:",e),a||alert("Failed to load activity logs")}finally{X.value=!1}},Et=()=>{if(!m.value){alert("Please select a user first");return}const a=new URLSearchParams({user_id:String(m.value),start_date:w.value,end_date:w.value});window.location.href=`/api/admin/analytics/user-summary/export/csv?${a.toString()}`},$t=()=>{if(!m.value){alert("Please select a user first");return}const a=new URLSearchParams({user_id:String(m.value),start_date:w.value,end_date:w.value});window.location.href=`/api/admin/analytics/user-summary/export/pdf?${a.toString()}`};return Ot(()=>{const a=new Date;w.value=a.toISOString().split("T")[0],At(),st(),rt(),ht(),Mt()}),at(g,a=>{a==="overview"?rt():a==="summary"?(!m.value&&M.value.length>0&&(m.value=M.value[0].id),m.value&&ut()):a==="activity"?st(!0):a==="user-hours"&&((!N.value||!L.value)&&ht(),bt())}),at(m,a=>{g.value==="summary"&&a&&ut()}),at(w,()=>{g.value==="summary"&&m.value&&ut()}),at(R,()=>{g.value==="activity"&&st(!0)}),(a,e)=>(r(),l(b,null,[wt(Wt(Bt),{title:"Analytics"}),wt(Pt,null,{header:St(()=>[...e[11]||(e[11]=[t("h2",{class:"text-xl font-semibold leading-tight text-gray-800"}," Analytics & Reports ",-1)])]),default:St(()=>[t("div",Rt,[t("div",Vt,[t("div",jt,[t("nav",qt,[t("button",{onClick:e[0]||(e[0]=s=>g.value="overview"),class:C(["whitespace-nowrap border-b-2 py-4 px-1 text-sm font-medium",g.value==="overview"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700"])}," Overview ",2),t("button",{onClick:e[1]||(e[1]=s=>g.value="summary"),class:C(["whitespace-nowrap border-b-2 py-4 px-1 text-sm font-medium",g.value==="summary"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700"])}," User Summary ",2),t("button",{onClick:e[2]||(e[2]=s=>g.value="user-hours"),class:C(["whitespace-nowrap border-b-2 py-4 px-1 text-sm font-medium",g.value==="user-hours"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700"])}," User Hours ",2),t("button",{onClick:e[3]||(e[3]=s=>g.value="activity"),class:C(["whitespace-nowrap border-b-2 py-4 px-1 text-sm font-medium",g.value==="activity"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700"])}," Activity Log ",2)])]),g.value==="overview"?(r(),l("div",zt,[t("section",Zt,[t("div",Gt,[t("div",null,[e[12]||(e[12]=t("h3",{class:"text-lg font-semibold text-gray-900"},"Company Health Overview",-1)),y.value?(r(),l("p",Qt," As of "+n(gt(y.value.generated_at)),1)):_("",!0)]),t("div",Jt,[t("button",{type:"button",onClick:xt,disabled:B.value||lt.value,class:"inline-flex items-center gap-2 rounded-md border border-indigo-200 bg-white px-4 py-2 text-sm font-medium text-indigo-600 shadow-sm transition hover:bg-indigo-50 disabled:cursor-not-allowed disabled:border-gray-200 disabled:text-gray-400"},[B.value?(r(),l("span",Xt)):_("",!0),t("span",null,n(B.value?"Refreshingâ€¦":"Refresh"),1)],8,Kt)])]),lt.value?(r(),l("div",Yt,[...e[13]||(e[13]=[t("div",{class:"mx-auto mb-3 h-8 w-8 animate-spin rounded-full border-b-2 border-indigo-600"},null,-1),ot(" Loading analytics summaryâ€¦ ",-1)])])):J.value?(r(),l("div",te,[t("div",null,[e[14]||(e[14]=t("h4",{class:"font-semibold text-red-800"},"We couldnâ€™t load the analytics overview.",-1)),t("p",ee,n(J.value),1)]),t("div",null,[t("button",{type:"button",onClick:xt,class:"inline-flex items-center rounded-md bg-red-600 px-4 py-2 text-sm font-medium text-white shadow-sm transition hover:bg-red-500"}," Try again ")])])):y.value?(r(),l("div",se,[t("div",ae,[(r(!0),l(b,null,k(Ut.value,s=>(r(),l("div",{key:s.title,class:C(["rounded-xl border bg-white p-6 shadow-sm transition hover:-translate-y-1 hover:shadow-md",s.accent])},[t("h4",oe,n(s.title),1),t("p",le,n(s.value),1),t("p",re,n(s.subtitle),1)],2))),128))]),t("div",ne,[t("div",ie,[t("div",de,[e[15]||(e[15]=t("h4",{class:"text-base font-semibold text-gray-800"},"Whoâ€™s still on the clock",-1)),t("p",ue,n(pt.value?"Top 10 current sessions":"No one is clocked in right now."),1)]),pt.value?(r(),l("div",ce,[(r(!0),l(b,null,k(y.value.open_entries,s=>(r(),l("div",{key:s.entry_id,class:"flex items-center justify-between gap-3 px-5 py-4"},[t("div",null,[t("p",me,n(s.user.name||"Unknown User"),1),t("p",ve,[ot(n(s.user.email||"No email listed")+" ",1),s.user.team?(r(),l("span",xe,"Â· "+n(s.user.team),1)):_("",!0)])]),t("div",ge,[t("p",pe,n(Tt(s.minutes_running)),1),t("p",ye,"since "+n(Dt(s.clock_in)),1)])]))),128))])):(r(),l("div",he," All clocks are cleared for today. Great job! "))]),t("div",be,[e[16]||(e[16]=t("div",{class:"border-b border-gray-100 px-5 py-4"},[t("h4",{class:"text-base font-semibold text-gray-800"},"At a glance"),t("p",{class:"text-sm text-gray-500"},"Quick context for today and the week.")],-1)),t("dl",fe,[(r(!0),l(b,null,k(Ht.value,s=>(r(),l("div",{key:s.label,class:"flex items-center justify-between gap-4"},[t("dt",_e,n(s.label),1),t("dd",ke,n(s.value),1)]))),128))])])])])):_("",!0)])])):g.value==="summary"?(r(),l("div",we,[t("div",Se,[t("div",Te,[t("div",null,[e[18]||(e[18]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"User",-1)),O(t("select",{"onUpdate:modelValue":e[4]||(e[4]=s=>m.value=s),class:"w-full rounded-md border-gray-300 shadow-sm"},[e[17]||(e[17]=t("option",{value:null},"Select User",-1)),(r(!0),l(b,null,k(M.value,s=>(r(),l("option",{key:s.id,value:s.id},n(s.name),9,De))),128))],512),[[mt,m.value]])]),t("div",null,[e[19]||(e[19]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Date",-1)),O(t("input",{"onUpdate:modelValue":e[5]||(e[5]=s=>w.value=s),type:"date",class:"w-full rounded-md border-gray-300 shadow-sm"},null,512),[[vt,w.value]])]),t("div",Ue,[t("button",{onClick:Et,disabled:!m.value,class:"flex-1 rounded-md bg-green-600 px-4 py-2 text-sm font-medium text-white shadow-sm hover:bg-green-500 disabled:bg-gray-400 disabled:cursor-not-allowed"}," Export CSV ",8,He),t("button",{onClick:$t,disabled:!m.value,class:"flex-1 rounded-md bg-red-600 px-4 py-2 text-sm font-medium text-white shadow-sm hover:bg-red-500 disabled:bg-gray-400 disabled:cursor-not-allowed"}," Export PDF ",8,Ce)])])]),t("div",Me,[e[25]||(e[25]=t("h3",{class:"text-lg font-medium leading-6 text-gray-900 mb-4"},"Daily Summary",-1)),t("div",Ne,[t("div",null,[e[20]||(e[20]=t("div",{class:"text-gray-500"},"ðŸ•’ Time In Hours",-1)),t("div",Le,n(q(S.value.workSeconds)),1)]),t("div",null,[e[21]||(e[21]=t("div",{class:"text-gray-500"},"â˜• Total Breaks",-1)),t("div",Ae,n(q(S.value.breakSeconds)),1)]),t("div",null,[e[22]||(e[22]=t("div",{class:"text-gray-500"},"ðŸ“‹ Entries",-1)),t("div",Ee,n(S.value.tasksCount),1)]),t("div",null,[e[23]||(e[23]=t("div",{class:"text-gray-500"},"â° Status",-1)),t("div",{class:C(["font-semibold",{"text-green-700":S.value.status==="Perfect","text-yellow-700":S.value.status==="Late","text-gray-700":S.value.status==="No Entry"}])},n(S.value.status),3)]),t("div",null,[e[24]||(e[24]=t("div",{class:"text-gray-500"},"âš¡ Overtime",-1)),t("div",$e,n(q(S.value.overtimeSeconds)),1)])])]),t("div",Ie,[t("div",Fe,[t("table",Oe,[e[27]||(e[27]=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Task"),t("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Start Time"),t("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"End Time"),t("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Duration"),t("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Break Duration"),t("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Notes")])],-1)),t("tbody",We,[(r(!0),l(b,null,k(f.value,(s,i)=>(r(),l("tr",{key:i},[t("td",Be,n(s.name),1),t("td",Pe,n(z(s.start)),1),t("td",Re,n(z(s.end)),1),t("td",Ve,n(q(s.durationSeconds)),1),t("td",je,n(q(s.breakDurationSeconds||0)),1),t("td",qe,n(s.notes||"-"),1)]))),128)),f.value.length===0&&!K.value?(r(),l("tr",ze,[...e[26]||(e[26]=[t("td",{colspan:"6",class:"px-4 py-4 text-center text-sm text-gray-500"},"No entries for selected day",-1)])])):_("",!0)])])]),K.value?(r(),l("div",Ze,[...e[28]||(e[28]=[t("div",{class:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600"},null,-1),t("p",{class:"mt-2 text-sm text-gray-500"},"Loading...",-1)])])):_("",!0)])])):g.value==="activity"?(r(),l("div",Ge,[t("div",Qe,[t("div",Je,[e[30]||(e[30]=t("h3",{class:"text-lg font-medium text-gray-900"},"Real-Time Activity Log",-1)),t("div",Ke,[e[29]||(e[29]=t("div",{class:"flex items-center gap-2 text-sm text-gray-600"},[t("span",{class:"inline-block w-2 h-2 bg-green-500 rounded-full animate-pulse"}),t("span",null,"Live Updates")],-1)),t("button",{onClick:e[6]||(e[6]=s=>st()),class:"rounded-md bg-indigo-600 px-3 py-1.5 text-xs font-medium text-white shadow-sm hover:bg-indigo-500"}," Refresh ")])]),t("div",Xe,[t("div",null,[e[32]||(e[32]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Filter by Action",-1)),O(t("select",{"onUpdate:modelValue":e[7]||(e[7]=s=>R.value=s),class:"w-full rounded-md border-gray-300 shadow-sm"},[...e[31]||(e[31]=[t("option",{value:""},"All Actions",-1),t("option",{value:"clock_in"},"Clock In",-1),t("option",{value:"clock_out"},"Clock Out",-1),t("option",{value:"break_start"},"Break Start",-1),t("option",{value:"break_end"},"Break End",-1),t("option",{value:"lunch_start"},"Lunch Start",-1),t("option",{value:"lunch_end"},"Lunch End",-1)])],512),[[mt,R.value]])])])]),t("div",Ye,[t("div",ts,[t("table",es,[e[34]||(e[34]=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"User"),t("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Action"),t("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Description"),t("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Time")])],-1)),t("tbody",ss,[(r(!0),l(b,null,k(dt.value,s=>{var i,v,x;return r(),l("tr",{key:s.id,class:"hover:bg-gray-50"},[t("td",as,[t("div",os,[t("div",ls,[t("div",rs,[t("span",ns,n((i=s.user)!=null&&i.name?s.user.name.charAt(0).toUpperCase():"?"),1)])]),t("div",is,[t("div",ds,n(((v=s.user)==null?void 0:v.name)||"Unknown User"),1),t("div",us,n((x=s.user)==null?void 0:x.email),1)])])]),t("td",cs,[t("span",{class:C(["px-2 inline-flex text-xs leading-5 font-semibold rounded-full",{"bg-green-100 text-green-800":s.action==="clock_in","bg-red-100 text-red-800":s.action==="clock_out","bg-yellow-100 text-yellow-800":s.action.includes("break"),"bg-blue-100 text-blue-800":s.action.includes("lunch")}])},n(s.action.replace("_"," ").replace(/\b\w/g,h=>h.toUpperCase())),3)]),t("td",ms,[t("div",vs,n(s.description),1)]),t("td",xs,[ot(n(it(s.created_at))+" ",1),t("div",gs,n(z(s.created_at)),1)])])}),128)),dt.value.length===0&&!X.value?(r(),l("tr",ps,[...e[33]||(e[33]=[t("td",{colspan:"4",class:"px-4 py-4 text-center text-sm text-gray-500"},"No activity logs found",-1)])])):_("",!0)])])]),X.value?(r(),l("div",ys,[...e[35]||(e[35]=[t("div",{class:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600"},null,-1),t("p",{class:"mt-2 text-sm text-gray-500"},"Loading...",-1)])])):_("",!0)])])):g.value==="user-hours"?(r(),l("div",hs,[t("div",bs,[e[40]||(e[40]=t("div",null,[t("h3",{class:"text-lg font-semibold text-gray-900"},"User Hours Matrix"),t("p",{class:"text-sm text-gray-500"}," Each cell shows Task Hours / Work Hours for that user and date. Totals per user are shown in the bottom row. ")],-1)),t("div",fs,[j.value.length?(r(),l("div",_s,[e[37]||(e[37]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Team",-1)),O(t("select",{"onUpdate:modelValue":e[8]||(e[8]=s=>tt.value=s),class:"rounded-md border-gray-300 shadow-sm text-sm min-w-[10rem]"},[e[36]||(e[36]=t("option",{value:null},"All Teams",-1)),(r(!0),l(b,null,k(j.value,s=>(r(),l("option",{key:s.id,value:s.id},n(s.name),9,ks))),128))],512),[[mt,tt.value,void 0,{number:!0}]])])):_("",!0),t("div",null,[e[38]||(e[38]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Start Date",-1)),O(t("input",{type:"date","onUpdate:modelValue":e[9]||(e[9]=s=>N.value=s),class:"rounded-md border-gray-300 shadow-sm text-sm"},null,512),[[vt,N.value]])]),t("div",null,[e[39]||(e[39]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"End Date",-1)),O(t("input",{type:"date","onUpdate:modelValue":e[10]||(e[10]=s=>L.value=s),class:"rounded-md border-gray-300 shadow-sm text-sm"},null,512),[[vt,L.value]])]),t("button",{type:"button",onClick:bt,disabled:E.value,class:"inline-flex items-center gap-2 rounded-md bg-indigo-600 px-4 py-2 text-sm font-medium text-white shadow-sm hover:bg-indigo-500 disabled:opacity-60 disabled:cursor-not-allowed"},[E.value?(r(),l("span",Ss)):_("",!0),t("span",null,n(E.value?"Loadingâ€¦":"Apply"),1)],8,ws)])]),et.value?(r(),l("div",Ts,[t("p",Ds,n(et.value),1)])):(r(),l("div",Us,[E.value?(r(),l("div",Hs,[...e[41]||(e[41]=[t("div",{class:"mx-auto mb-3 h-8 w-8 animate-spin rounded-full border-b-2 border-indigo-600"},null,-1),ot(" Loading user hoursâ€¦ ",-1)])])):V.value.length?(r(),l("div",Ms,[t("table",Ns,[t("thead",Ls,[t("tr",null,[e[42]||(e[42]=t("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"}," Date ",-1)),(r(!0),l(b,null,k(A.value,s=>(r(),l("th",{key:s,class:"px-4 py-3 text-center text-xs font-medium uppercase tracking-wider text-gray-500"},n(s),1))),128))])]),t("tbody",As,[(r(!0),l(b,null,k(V.value,s=>(r(),l("tr",{key:s.date},[t("td",Es,n(Nt(s.date)),1),(r(!0),l(b,null,k(A.value,i=>(r(),l("td",{key:i+s.date,class:"px-4 py-3 text-center align-top",title:Lt(s,i)},[s.cells[i]?(r(),l("div",Is,[t("div",Fs," Work: "+n(s.cells[i].workHours.toFixed(2))+" h ",1),t("div",Os," Task: "+n(s.cells[i].taskHours.toFixed(2))+" h ",1)])):(r(),l("div",Ws,"â€”"))],8,$s))),128))]))),128))]),t("tfoot",Bs,[t("tr",null,[e[43]||(e[43]=t("th",{class:"px-4 py-3 text-sm font-semibold text-gray-900 text-right"}," Totals ",-1)),(r(!0),l(b,null,k(A.value,s=>{var i,v;return r(),l("td",{key:s+"-total",class:"px-4 py-3 text-xs text-gray-900 text-center"},[t("div",Ps," Task: "+n((((i=Y.value[s])==null?void 0:i.taskHours)??0).toFixed(2))+" h ",1),t("div",Rs," Work: "+n((((v=Y.value[s])==null?void 0:v.workHours)??0).toFixed(2))+" h ",1)])}),128))])])])])):(r(),l("div",Cs," No data for selected range. "))]))])):_("",!0)])])]),_:1})],64))}});export{Gs as default};
