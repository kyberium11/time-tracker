import{d as _,r as c,c as k,a as n,b as g,u as C,h as I,e as f,f as e,g as U,i as l,t as i,l as B,m as S,F as x,k as L,n as V}from"./app-DGG22J6u.js";import{_ as j}from"./AuthenticatedLayout.vue_vue_type_script_setup_true_lang-o3aitYFc.js";import{a as h}from"./api-N73WtNp-.js";const z={class:"py-12"},F={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},M={key:0,class:"mb-6 bg-yellow-50 border-l-4 border-yellow-400 p-4 rounded"},N={class:"flex items-center justify-between"},$=["disabled"],A={class:"bg-white shadow rounded-lg p-6 mb-6"},D={class:"bg-white shadow rounded-lg overflow-hidden"},q={key:0,class:"p-6 text-center text-gray-500"},E={key:1,class:"divide-y divide-gray-200"},H=["onClick"],Q={class:"flex items-center justify-between"},R={class:"flex items-center space-x-4"},T={class:"flex-shrink-0"},Y={class:"h-10 w-10 rounded-full bg-indigo-100 flex items-center justify-center"},G={class:"text-indigo-600 font-semibold"},J={class:"text-sm font-medium text-gray-900"},K={class:"text-sm text-gray-500"},O={class:"flex items-center space-x-3"},Z=_({__name:"Impersonate",props:{users:{},isImpersonating:{type:Boolean},originalUserId:{}},setup(u){const p=u,a=c(!1),d=c(""),y=c(null),m=k(()=>{if(!d.value)return p.users;const o=d.value.toLowerCase();return p.users.filter(t=>t.name.toLowerCase().includes(o)||t.email.toLowerCase().includes(o)||t.role.toLowerCase().includes(o))}),v=async o=>{var t,s;if(!a.value&&confirm(`Are you sure you want to login as ${o.name}?`)){a.value=!0;try{const r=await h.post(`/impersonate/start/${o.id}`);r.data.success&&(y.value=r.data.user,window.location.href="/dashboard")}catch(r){alert(((s=(t=r==null?void 0:r.response)==null?void 0:t.data)==null?void 0:s.error)||"Failed to start impersonation")}finally{a.value=!1}}},b=async()=>{var o,t;if(!a.value){a.value=!0;try{(await h.post("/impersonate/stop")).data.success&&(window.location.href="/dashboard")}catch(s){alert(((t=(o=s==null?void 0:s.response)==null?void 0:o.data)==null?void 0:t.error)||"Failed to stop impersonation")}finally{a.value=!1}}},w=o=>{switch(o){case"admin":return"bg-red-100 text-red-800";case"developer":return"bg-purple-100 text-purple-800";case"manager":return"bg-blue-100 text-blue-800";case"employee":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}};return(o,t)=>(l(),n(x,null,[g(C(I),{title:"Impersonate User"}),g(j,null,{header:f(()=>[...t[1]||(t[1]=[e("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"},"Impersonate User",-1)])]),default:f(()=>[e("div",z,[e("div",F,[u.isImpersonating?(l(),n("div",M,[e("div",N,[t[2]||(t[2]=e("div",{class:"flex items-center"},[e("svg",{class:"h-5 w-5 text-yellow-400 mr-2",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z","clip-rule":"evenodd"})]),e("p",{class:"text-sm text-yellow-700"}," You are currently impersonating a user. All actions will be performed as that user. ")],-1)),e("button",{onClick:b,disabled:a.value,class:"px-4 py-2 bg-yellow-600 text-white rounded-md hover:bg-yellow-700 focus:outline-none focus:ring-2 focus:ring-yellow-500 disabled:opacity-50"},i(a.value?"Stopping...":"Stop Impersonating"),9,$)])])):U("",!0),e("div",A,[t[3]||(t[3]=e("label",{for:"search",class:"block text-sm font-medium text-gray-700 mb-2"}," Search Users ",-1)),B(e("input",{id:"search","onUpdate:modelValue":t[0]||(t[0]=s=>d.value=s),type:"text",placeholder:"Search by name, email, or role...",class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},null,512),[[S,d.value]])]),e("div",D,[t[5]||(t[5]=e("div",{class:"px-6 py-4 border-b border-gray-200"},[e("h3",{class:"text-lg font-medium text-gray-900"}," Select a user to impersonate "),e("p",{class:"text-sm text-gray-500 mt-1"}," Click on a user to login as them and see their view of the application. ")],-1)),m.value.length===0?(l(),n("div",q," No users found matching your search. ")):(l(),n("div",E,[(l(!0),n(x,null,L(m.value,s=>(l(),n("div",{key:s.id,class:"px-6 py-4 hover:bg-gray-50 transition-colors cursor-pointer",onClick:r=>v(s)},[e("div",Q,[e("div",R,[e("div",T,[e("div",Y,[e("span",G,i(s.name.charAt(0).toUpperCase()),1)])]),e("div",null,[e("p",J,i(s.name),1),e("p",K,i(s.email),1)])]),e("div",O,[e("span",{class:V(["px-2 py-1 text-xs font-semibold rounded-full",w(s.role)])},i(s.role),3),t[4]||(t[4]=e("svg",{class:"h-5 w-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1))])])],8,H))),128))]))])])])]),_:1})],64))}});export{Z as default};
