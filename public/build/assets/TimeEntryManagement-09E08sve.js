import{d as X,r as i,q as Z,o as tt,c as n,a as L,u as et,h as st,w as B,b as e,e as m,f as d,t as o,g as f,j as T,F as U,i as z,v as lt,k as D}from"./app-D35D10-J.js";import{_ as ot}from"./AuthenticatedLayout.vue_vue_type_script_setup_true_lang-DrfUz3yk.js";import{a as S}from"./api-Be1BQmd_.js";const at={class:"py-12"},nt={class:"mx-auto max-w-7xl sm:px-6 lg:px-8"},dt={key:0,class:"mb-4 rounded-md bg-green-50 p-4"},it={class:"flex"},rt={class:"ml-3"},ut={class:"text-sm font-medium text-green-800"},ct={key:1,class:"mb-4 rounded-md bg-red-50 p-4"},mt={class:"flex"},gt={class:"ml-3"},pt={class:"text-sm font-medium text-red-800"},xt={class:"overflow-hidden bg-white shadow sm:rounded-lg"},vt={class:"p-6"},yt={class:"mb-6 grid grid-cols-1 gap-4 md:grid-cols-4"},ft=["value"],bt={class:"overflow-x-auto"},wt={class:"min-w-full divide-y divide-gray-200"},kt={class:"divide-y divide-gray-200 bg-white"},_t={key:0},ht={key:1},Tt={class:"whitespace-nowrap px-6 py-4 text-sm text-gray-900"},Dt={class:"whitespace-nowrap px-6 py-4 text-sm text-gray-900"},St={class:"whitespace-nowrap px-6 py-4 text-sm text-gray-900"},Mt={class:"whitespace-nowrap px-6 py-4 text-sm text-gray-900"},Ct={class:"whitespace-nowrap px-6 py-4 text-sm text-gray-900"},Et={class:"whitespace-nowrap px-6 py-4 text-sm text-gray-900"},Yt={class:"whitespace-nowrap px-6 py-4 text-sm font-medium text-gray-900"},$t={class:"whitespace-nowrap px-6 py-4 text-sm font-medium"},Ft=["onClick"],Ut=["onClick"],Ht={key:0,class:"mt-4 flex items-center justify-between"},Nt={class:"text-sm text-gray-700"},At={class:"flex gap-2"},Vt=["disabled"],It=["disabled"],jt={key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50"},Pt={class:"w-full max-w-2xl rounded-lg bg-white p-6 shadow-xl"},Ot={key:0,class:"mb-4 rounded-md bg-red-50 p-4"},Lt={class:"text-sm font-medium text-red-800"},Bt={key:1,class:"space-y-4"},zt={key:1,class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50"},qt={class:"w-full max-w-md rounded-lg bg-white p-6 shadow-xl"},Gt={key:0,class:"mb-4 rounded-md bg-red-50 p-4"},Jt={class:"text-sm font-medium text-red-800"},Kt={key:1,class:"mb-4 rounded-md bg-gray-50 p-4"},Qt={class:"text-sm text-gray-700"},te=X({__name:"TimeEntryManagement",setup(Rt){const b=i([]),M=i(!1),u=i(null),C=i(!1),E=i(!1),c=i(null),r=i(null),g=i(null),Y=i(new Date().toISOString().split("T")[0]),$=i(new Date().toISOString().split("T")[0]),w=i(null),v=i([]),p=i(1),k=i(50),_=i(0),x=async()=>{var s,t;M.value=!0,r.value=null;try{const a={page:p.value,per_page:k.value,date_from:Y.value,date_to:$.value};w.value&&(a.user_id=w.value);const l=await S.get("/admin/time-entries",{params:a});b.value=l.data.data||[],_.value=l.data.total||0}catch(a){r.value=((t=(s=a.response)==null?void 0:s.data)==null?void 0:t.message)||"Failed to load time entries",b.value=[]}finally{M.value=!1}},q=async()=>{var s;try{const t=await S.get("/admin/users",{params:{per_page:1e3}});(s=t.data)!=null&&s.data?v.value=t.data.data:Array.isArray(t.data)?v.value=t.data:v.value=[]}catch(t){console.error("Failed to load users",t),v.value=[]}},H=s=>{if(!s)return"";const t=new Date(s),a=t.getFullYear(),l=String(t.getMonth()+1).padStart(2,"0"),y=String(t.getDate()).padStart(2,"0"),h=String(t.getHours()).padStart(2,"0"),F=String(t.getMinutes()).padStart(2,"0"),W=String(t.getSeconds()).padStart(2,"0");return`${a}-${l}-${y}T${h}:${F}:${W}`},G=async s=>{u.value={...s,clock_in:s.clock_in?H(s.clock_in):null,clock_out:s.clock_out?H(s.clock_out):null},C.value=!0},N=()=>{u.value=null,C.value=!1,r.value=null,g.value=null},A=s=>{if(!s)return null;let t=s;if(!t.includes(":"))return null;const a=t.split("T");return a.length===2&&a[1].split(":").length===2&&(t=`${a[0]}T${a[1]}:00`),new Date(t).toISOString()},J=async()=>{var s,t;if(u.value){r.value=null,g.value=null;try{await S.put(`/admin/time-entries/${u.value.id}`,{clock_in:A(u.value.clock_in),clock_out:A(u.value.clock_out)}),g.value="Time entry updated successfully and synced to ClickUp",N(),await x(),setTimeout(()=>{g.value=null},3e3)}catch(a){r.value=((t=(s=a.response)==null?void 0:s.data)==null?void 0:t.message)||"Failed to update time entry"}}},K=s=>{c.value=s,E.value=!0},V=()=>{c.value=null,E.value=!1,r.value=null},Q=async()=>{var s,t;if(c.value){r.value=null;try{await S.delete(`/admin/time-entries/${c.value.id}`),g.value="Time entry deleted successfully and synced to ClickUp",V(),await x(),setTimeout(()=>{g.value=null},3e3)}catch(a){r.value=((t=(s=a.response)==null?void 0:s.data)==null?void 0:t.message)||"Failed to delete time entry"}}},I=s=>new Date(s).toLocaleDateString("en-US",{year:"numeric",month:"2-digit",day:"2-digit"}),j=s=>s?new Date(s).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",second:"2-digit"}):"--",P=s=>{if(s==null)return"0.00h";const t=typeof s=="string"?parseFloat(s):s;return isNaN(t)?"0.00h":`${t.toFixed(2)}h`},O=Z(()=>Math.ceil(_.value/k.value)),R=()=>{p.value=1,x()};return tt(()=>{q(),x()}),(s,t)=>(d(),n(U,null,[L(et(st),{title:"Time Entry Management"}),L(ot,null,{header:B(()=>[...t[7]||(t[7]=[e("h2",{class:"text-xl font-semibold leading-tight text-gray-800"}," Time Entry Management ",-1)])]),default:B(()=>{var a;return[e("div",at,[e("div",nt,[g.value?(d(),n("div",dt,[e("div",it,[e("div",rt,[e("p",ut,o(g.value),1)])])])):m("",!0),r.value?(d(),n("div",ct,[e("div",mt,[e("div",gt,[e("p",pt,o(r.value),1)])])])):m("",!0),e("div",xt,[e("div",vt,[e("div",yt,[e("div",null,[t[8]||(t[8]=e("label",{class:"block text-sm font-medium text-gray-700"},"Date From",-1)),f(e("input",{"onUpdate:modelValue":t[0]||(t[0]=l=>Y.value=l),type:"date",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},null,512),[[T,Y.value]])]),e("div",null,[t[9]||(t[9]=e("label",{class:"block text-sm font-medium text-gray-700"},"Date To",-1)),f(e("input",{"onUpdate:modelValue":t[1]||(t[1]=l=>$.value=l),type:"date",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},null,512),[[T,$.value]])]),e("div",null,[t[11]||(t[11]=e("label",{class:"block text-sm font-medium text-gray-700"},"User",-1)),f(e("select",{"onUpdate:modelValue":t[2]||(t[2]=l=>w.value=l),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},[t[10]||(t[10]=e("option",{value:null},"All Users",-1)),(d(!0),n(U,null,z(v.value,l=>(d(),n("option",{key:l.id,value:l.id},o(l.name)+" ("+o(l.email)+") ",9,ft))),128))],512),[[lt,w.value]])]),e("div",{class:"flex items-end"},[e("button",{onClick:R,class:"w-full rounded-md bg-indigo-600 px-4 py-2 text-sm font-medium text-white hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2"}," Apply Filters ")])]),e("div",bt,[e("table",wt,[t[14]||(t[14]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"}," ID "),e("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"}," User "),e("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"}," Date "),e("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"}," Task "),e("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"}," Clock In "),e("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"}," Clock Out "),e("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"}," Total Hours "),e("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"}," Actions ")])],-1)),e("tbody",kt,[M.value?(d(),n("tr",_t,[...t[12]||(t[12]=[e("td",{colspan:"8",class:"px-6 py-4 text-center"},[e("div",{class:"inline-block h-8 w-8 animate-spin rounded-full border-4 border-solid border-indigo-600 border-r-transparent"})],-1)])])):b.value.length===0?(d(),n("tr",ht,[...t[13]||(t[13]=[e("td",{colspan:"8",class:"px-6 py-4 text-center text-sm text-gray-500"}," No time entries found ",-1)])])):(d(!0),n(U,{key:2},z(b.value,l=>{var y,h;return d(),n("tr",{key:l.id},[e("td",Tt,o(l.id),1),e("td",Dt,o(((y=l.user)==null?void 0:y.name)||"N/A"),1),e("td",St,o(I(l.date)),1),e("td",Mt,o(((h=l.task)==null?void 0:h.title)||"N/A"),1),e("td",Ct,o(j(l.clock_in)),1),e("td",Et,o(j(l.clock_out)),1),e("td",Yt,o(P(l.total_hours)),1),e("td",$t,[e("button",{onClick:F=>G(l),class:"mr-2 text-indigo-600 hover:text-indigo-900"}," Edit ",8,Ft),e("button",{onClick:F=>K(l),class:"text-red-600 hover:text-red-900"}," Delete ",8,Ut)])])}),128))])])]),O.value>1?(d(),n("div",Ht,[e("div",Nt," Showing "+o((p.value-1)*k.value+1)+" to "+o(Math.min(p.value*k.value,_.value))+" of "+o(_.value)+" results ",1),e("div",At,[e("button",{onClick:t[3]||(t[3]=l=>{p.value--,x()}),disabled:p.value===1,class:"rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50 disabled:opacity-50"}," Previous ",8,Vt),e("button",{onClick:t[4]||(t[4]=l=>{p.value++,x()}),disabled:p.value>=O.value,class:"rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50 disabled:opacity-50"}," Next ",8,It)])])):m("",!0)])])])]),C.value?(d(),n("div",jt,[e("div",Pt,[t[19]||(t[19]=e("h3",{class:"mb-4 text-lg font-medium text-gray-900"},"Edit Time Entry",-1)),r.value?(d(),n("div",Ot,[e("p",Lt,o(r.value),1)])):m("",!0),u.value?(d(),n("div",Bt,[e("div",null,[t[15]||(t[15]=e("label",{class:"block text-sm font-medium text-gray-700"},"Start Time",-1)),f(e("input",{"onUpdate:modelValue":t[5]||(t[5]=l=>u.value.clock_in=l),type:"text",pattern:"\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}",placeholder:"YYYY-MM-DDTHH:mm:ss",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},null,512),[[T,u.value.clock_in]]),t[16]||(t[16]=e("p",{class:"mt-1 text-xs text-gray-500"},"Format: YYYY-MM-DDTHH:mm:ss (e.g., 2025-11-10T11:26:30)",-1))]),e("div",null,[t[17]||(t[17]=e("label",{class:"block text-sm font-medium text-gray-700"},"End Time",-1)),f(e("input",{"onUpdate:modelValue":t[6]||(t[6]=l=>u.value.clock_out=l),type:"text",pattern:"\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}",placeholder:"YYYY-MM-DDTHH:mm:ss",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},null,512),[[T,u.value.clock_out]]),t[18]||(t[18]=e("p",{class:"mt-1 text-xs text-gray-500"},"Format: YYYY-MM-DDTHH:mm:ss (e.g., 2025-11-10T11:26:30)",-1))])])):m("",!0),e("div",{class:"mt-6 flex justify-end gap-3"},[e("button",{onClick:N,class:"rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50"}," Cancel "),e("button",{onClick:J,class:"rounded-md bg-indigo-600 px-4 py-2 text-sm font-medium text-white hover:bg-indigo-700"}," Save Changes ")])])])):m("",!0),E.value?(d(),n("div",zt,[e("div",qt,[t[27]||(t[27]=e("h3",{class:"mb-4 text-lg font-medium text-gray-900"},"Delete Time Entry",-1)),r.value?(d(),n("div",Gt,[e("p",Jt,o(r.value),1)])):m("",!0),t[28]||(t[28]=e("p",{class:"mb-4 text-sm text-gray-600"}," Are you sure you want to delete this time entry? This action cannot be undone and will sync to ClickUp. ",-1)),c.value?(d(),n("div",Kt,[e("p",Qt,[t[20]||(t[20]=e("strong",null,"ID:",-1)),D(" "+o(c.value.id),1),t[21]||(t[21]=e("br",null,null,-1)),t[22]||(t[22]=e("strong",null,"User:",-1)),D(" "+o(((a=c.value.user)==null?void 0:a.name)||"N/A"),1),t[23]||(t[23]=e("br",null,null,-1)),t[24]||(t[24]=e("strong",null,"Date:",-1)),D(" "+o(I(c.value.date)),1),t[25]||(t[25]=e("br",null,null,-1)),t[26]||(t[26]=e("strong",null,"Total Hours:",-1)),D(" "+o(P(c.value.total_hours)),1)])])):m("",!0),e("div",{class:"flex justify-end gap-3"},[e("button",{onClick:V,class:"rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50"}," Cancel "),e("button",{onClick:Q,class:"rounded-md bg-red-600 px-4 py-2 text-sm font-medium text-white hover:bg-red-700"}," Delete ")])])])):m("",!0)]}),_:1})],64))}});export{te as default};
