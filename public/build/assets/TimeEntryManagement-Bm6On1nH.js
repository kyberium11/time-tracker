import{d as tt,r as i,q as et,o as lt,c as n,a as Y,u as st,h as at,w as G,b as e,e as g,f as d,t as o,g as m,j as p,F as U,i as j,v as J,k as E}from"./app-li_MxOU3.js";import{_ as ot}from"./AuthenticatedLayout.vue_vue_type_script_setup_true_lang-CELLmJKB.js";import{a as w}from"./api-BbGv8Po1.js";const nt={class:"py-12"},dt={class:"mx-auto max-w-7xl sm:px-6 lg:px-8"},it={key:0,class:"mb-4 rounded-md bg-green-50 p-4"},rt={class:"flex"},ut={class:"ml-3"},mt={class:"text-sm font-medium text-green-800"},ct={key:1,class:"mb-4 rounded-md bg-red-50 p-4"},gt={class:"flex"},pt={class:"ml-3"},vt={class:"text-sm font-medium text-red-800"},xt={class:"overflow-hidden bg-white shadow sm:rounded-lg"},bt={class:"p-6"},ft={class:"mb-6 grid grid-cols-1 gap-4 md:grid-cols-4"},yt=["value"],kt={class:"overflow-x-auto"},wt={class:"min-w-full divide-y divide-gray-200"},_t={class:"divide-y divide-gray-200 bg-white"},ht={key:0},Tt={key:1},Dt={class:"whitespace-nowrap px-6 py-4 text-sm text-gray-900"},St={class:"whitespace-nowrap px-6 py-4 text-sm text-gray-900"},Ct={class:"whitespace-nowrap px-6 py-4 text-sm text-gray-900"},Ut={class:"whitespace-nowrap px-6 py-4 text-sm text-gray-900"},Et={class:"whitespace-nowrap px-6 py-4 text-sm text-gray-900"},Mt={class:"whitespace-nowrap px-6 py-4 text-sm text-gray-900"},Vt={class:"whitespace-nowrap px-6 py-4 text-sm font-medium text-gray-900"},Ft={class:"whitespace-nowrap px-6 py-4 text-sm font-medium"},$t=["onClick"],Nt=["onClick"],At={key:0,class:"mt-4 flex items-center justify-between"},It={class:"text-sm text-gray-700"},jt={class:"flex gap-2"},Lt=["disabled"],Ot=["disabled"],Bt={key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50"},Ht={class:"w-full max-w-2xl rounded-lg bg-white p-6 shadow-xl"},Pt={key:0,class:"mb-4 rounded-md bg-red-50 p-4"},zt={class:"text-sm font-medium text-red-800"},qt={key:1,class:"space-y-4"},Yt=["value"],Gt={key:1,class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50"},Jt={class:"w-full max-w-md rounded-lg bg-white p-6 shadow-xl"},Kt={key:0,class:"mb-4 rounded-md bg-red-50 p-4"},Qt={class:"text-sm font-medium text-red-800"},Rt={key:1,class:"mb-4 rounded-md bg-gray-50 p-4"},Wt={class:"text-sm text-gray-700"},le=tt({__name:"TimeEntryManagement",setup(Xt){const _=i([]),M=i(!1),a=i(null),V=i(!1),F=i(!1),c=i(null),u=i(null),v=i(null),$=i(new Date().toISOString().split("T")[0]),N=i(new Date().toISOString().split("T")[0]),h=i(null),k=i([]),A=i([]),x=i(1),T=i(50),D=i(0),b=async()=>{var s,t;M.value=!0,u.value=null;try{const r={page:x.value,per_page:T.value,date_from:$.value,date_to:N.value};h.value&&(r.user_id=h.value);const l=await w.get("/admin/time-entries",{params:r});_.value=l.data.data||[],D.value=l.data.total||0}catch(r){u.value=((t=(s=r.response)==null?void 0:s.data)==null?void 0:t.message)||"Failed to load time entries",_.value=[]}finally{M.value=!1}},K=async()=>{var s;try{const t=await w.get("/admin/users",{params:{per_page:1e3}});(s=t.data)!=null&&s.data?k.value=t.data.data:Array.isArray(t.data)?k.value=t.data:k.value=[]}catch(t){console.error("Failed to load users",t),k.value=[]}},L=async s=>{try{const t={};s&&(t.user_id=s);const r=await w.get("/admin/tasks",{params:t});A.value=r.data||[]}catch(t){console.error("Failed to load tasks",t),A.value=[]}},f=s=>{if(!s)return"";const t=new Date(s),r=t.getFullYear(),l=String(t.getMonth()+1).padStart(2,"0"),S=String(t.getDate()).padStart(2,"0"),C=String(t.getHours()).padStart(2,"0"),I=String(t.getMinutes()).padStart(2,"0");return`${r}-${l}-${S}T${C}:${I}`},Q=async s=>{a.value={...s,clock_in:s.clock_in?f(s.clock_in):null,clock_out:s.clock_out?f(s.clock_out):null,break_start:s.break_start?f(s.break_start):null,break_end:s.break_end?f(s.break_end):null,lunch_start:s.lunch_start?f(s.lunch_start):null,lunch_end:s.lunch_end?f(s.lunch_end):null},await L(s.user_id),V.value=!0},O=()=>{a.value=null,V.value=!1,u.value=null,v.value=null},y=s=>s?new Date(s).toISOString():null,R=async()=>{var s,t;if(a.value){u.value=null,v.value=null;try{await w.put(`/admin/time-entries/${a.value.id}`,{date:a.value.date,clock_in:y(a.value.clock_in),clock_out:y(a.value.clock_out),break_start:y(a.value.break_start),break_end:y(a.value.break_end),lunch_start:y(a.value.lunch_start),lunch_end:y(a.value.lunch_end),task_id:a.value.task_id}),v.value="Time entry updated successfully and synced to ClickUp",O(),await b(),setTimeout(()=>{v.value=null},3e3)}catch(r){u.value=((t=(s=r.response)==null?void 0:s.data)==null?void 0:t.message)||"Failed to update time entry"}}},W=s=>{c.value=s,F.value=!0},B=()=>{c.value=null,F.value=!1,u.value=null},X=async()=>{var s,t;if(c.value){u.value=null;try{await w.delete(`/admin/time-entries/${c.value.id}`),v.value="Time entry deleted successfully and synced to ClickUp",B(),await b(),setTimeout(()=>{v.value=null},3e3)}catch(r){u.value=((t=(s=r.response)==null?void 0:s.data)==null?void 0:t.message)||"Failed to delete time entry"}}},H=s=>new Date(s).toLocaleDateString("en-US",{year:"numeric",month:"2-digit",day:"2-digit"}),P=s=>s?new Date(s).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",second:"2-digit"}):"--",z=s=>{if(s==null)return"0.00h";const t=typeof s=="string"?parseFloat(s):s;return isNaN(t)?"0.00h":`${t.toFixed(2)}h`},q=et(()=>Math.ceil(D.value/T.value)),Z=()=>{x.value=1,b()};return lt(()=>{K(),b(),L()}),(s,t)=>(d(),n(U,null,[Y(st(at),{title:"Time Entry Management"}),Y(ot,null,{header:G(()=>[...t[13]||(t[13]=[e("h2",{class:"text-xl font-semibold leading-tight text-gray-800"}," Time Entry Management ",-1)])]),default:G(()=>{var r;return[e("div",nt,[e("div",dt,[v.value?(d(),n("div",it,[e("div",rt,[e("div",ut,[e("p",mt,o(v.value),1)])])])):g("",!0),u.value?(d(),n("div",ct,[e("div",gt,[e("div",pt,[e("p",vt,o(u.value),1)])])])):g("",!0),e("div",xt,[e("div",bt,[e("div",ft,[e("div",null,[t[14]||(t[14]=e("label",{class:"block text-sm font-medium text-gray-700"},"Date From",-1)),m(e("input",{"onUpdate:modelValue":t[0]||(t[0]=l=>$.value=l),type:"date",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},null,512),[[p,$.value]])]),e("div",null,[t[15]||(t[15]=e("label",{class:"block text-sm font-medium text-gray-700"},"Date To",-1)),m(e("input",{"onUpdate:modelValue":t[1]||(t[1]=l=>N.value=l),type:"date",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},null,512),[[p,N.value]])]),e("div",null,[t[17]||(t[17]=e("label",{class:"block text-sm font-medium text-gray-700"},"User",-1)),m(e("select",{"onUpdate:modelValue":t[2]||(t[2]=l=>h.value=l),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},[t[16]||(t[16]=e("option",{value:null},"All Users",-1)),(d(!0),n(U,null,j(k.value,l=>(d(),n("option",{key:l.id,value:l.id},o(l.name)+" ("+o(l.email)+") ",9,yt))),128))],512),[[J,h.value]])]),e("div",{class:"flex items-end"},[e("button",{onClick:Z,class:"w-full rounded-md bg-indigo-600 px-4 py-2 text-sm font-medium text-white hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2"}," Apply Filters ")])]),e("div",kt,[e("table",wt,[t[20]||(t[20]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"}," ID "),e("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"}," User "),e("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"}," Date "),e("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"}," Task "),e("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"}," Clock In "),e("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"}," Clock Out "),e("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"}," Total Hours "),e("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"}," Actions ")])],-1)),e("tbody",_t,[M.value?(d(),n("tr",ht,[...t[18]||(t[18]=[e("td",{colspan:"8",class:"px-6 py-4 text-center"},[e("div",{class:"inline-block h-8 w-8 animate-spin rounded-full border-4 border-solid border-indigo-600 border-r-transparent"})],-1)])])):_.value.length===0?(d(),n("tr",Tt,[...t[19]||(t[19]=[e("td",{colspan:"8",class:"px-6 py-4 text-center text-sm text-gray-500"}," No time entries found ",-1)])])):(d(!0),n(U,{key:2},j(_.value,l=>{var S,C;return d(),n("tr",{key:l.id},[e("td",Dt,o(l.id),1),e("td",St,o(((S=l.user)==null?void 0:S.name)||"N/A"),1),e("td",Ct,o(H(l.date)),1),e("td",Ut,o(((C=l.task)==null?void 0:C.name)||"N/A"),1),e("td",Et,o(P(l.clock_in)),1),e("td",Mt,o(P(l.clock_out)),1),e("td",Vt,o(z(l.total_hours)),1),e("td",Ft,[e("button",{onClick:I=>Q(l),class:"mr-2 text-indigo-600 hover:text-indigo-900"}," Edit ",8,$t),e("button",{onClick:I=>W(l),class:"text-red-600 hover:text-red-900"}," Delete ",8,Nt)])])}),128))])])]),q.value>1?(d(),n("div",At,[e("div",It," Showing "+o((x.value-1)*T.value+1)+" to "+o(Math.min(x.value*T.value,D.value))+" of "+o(D.value)+" results ",1),e("div",jt,[e("button",{onClick:t[3]||(t[3]=l=>{x.value--,b()}),disabled:x.value===1,class:"rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50 disabled:opacity-50"}," Previous ",8,Lt),e("button",{onClick:t[4]||(t[4]=l=>{x.value++,b()}),disabled:x.value>=q.value,class:"rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50 disabled:opacity-50"}," Next ",8,Ot)])])):g("",!0)])])])]),V.value?(d(),n("div",Bt,[e("div",Ht,[t[30]||(t[30]=e("h3",{class:"mb-4 text-lg font-medium text-gray-900"},"Edit Time Entry",-1)),u.value?(d(),n("div",Pt,[e("p",zt,o(u.value),1)])):g("",!0),a.value?(d(),n("div",qt,[e("div",null,[t[22]||(t[22]=e("label",{class:"block text-sm font-medium text-gray-700"},"Task",-1)),m(e("select",{"onUpdate:modelValue":t[5]||(t[5]=l=>a.value.task_id=l),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},[t[21]||(t[21]=e("option",{value:null},"No Task",-1)),(d(!0),n(U,null,j(A.value,l=>(d(),n("option",{key:l.id,value:l.id},o(l.title)+" "+o(l.user?`(${l.user.name})`:""),9,Yt))),128))],512),[[J,a.value.task_id]])]),e("div",null,[t[23]||(t[23]=e("label",{class:"block text-sm font-medium text-gray-700"},"Date",-1)),m(e("input",{"onUpdate:modelValue":t[6]||(t[6]=l=>a.value.date=l),type:"date",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},null,512),[[p,a.value.date]])]),e("div",null,[t[24]||(t[24]=e("label",{class:"block text-sm font-medium text-gray-700"},"Clock In",-1)),m(e("input",{"onUpdate:modelValue":t[7]||(t[7]=l=>a.value.clock_in=l),type:"datetime-local",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},null,512),[[p,a.value.clock_in]])]),e("div",null,[t[25]||(t[25]=e("label",{class:"block text-sm font-medium text-gray-700"},"Clock Out",-1)),m(e("input",{"onUpdate:modelValue":t[8]||(t[8]=l=>a.value.clock_out=l),type:"datetime-local",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},null,512),[[p,a.value.clock_out]])]),e("div",null,[t[26]||(t[26]=e("label",{class:"block text-sm font-medium text-gray-700"},"Break Start",-1)),m(e("input",{"onUpdate:modelValue":t[9]||(t[9]=l=>a.value.break_start=l),type:"datetime-local",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},null,512),[[p,a.value.break_start]])]),e("div",null,[t[27]||(t[27]=e("label",{class:"block text-sm font-medium text-gray-700"},"Break End",-1)),m(e("input",{"onUpdate:modelValue":t[10]||(t[10]=l=>a.value.break_end=l),type:"datetime-local",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},null,512),[[p,a.value.break_end]])]),e("div",null,[t[28]||(t[28]=e("label",{class:"block text-sm font-medium text-gray-700"},"Lunch Start",-1)),m(e("input",{"onUpdate:modelValue":t[11]||(t[11]=l=>a.value.lunch_start=l),type:"datetime-local",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},null,512),[[p,a.value.lunch_start]])]),e("div",null,[t[29]||(t[29]=e("label",{class:"block text-sm font-medium text-gray-700"},"Lunch End",-1)),m(e("input",{"onUpdate:modelValue":t[12]||(t[12]=l=>a.value.lunch_end=l),type:"datetime-local",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},null,512),[[p,a.value.lunch_end]])])])):g("",!0),e("div",{class:"mt-6 flex justify-end gap-3"},[e("button",{onClick:O,class:"rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50"}," Cancel "),e("button",{onClick:R,class:"rounded-md bg-indigo-600 px-4 py-2 text-sm font-medium text-white hover:bg-indigo-700"}," Save Changes ")])])])):g("",!0),F.value?(d(),n("div",Gt,[e("div",Jt,[t[38]||(t[38]=e("h3",{class:"mb-4 text-lg font-medium text-gray-900"},"Delete Time Entry",-1)),u.value?(d(),n("div",Kt,[e("p",Qt,o(u.value),1)])):g("",!0),t[39]||(t[39]=e("p",{class:"mb-4 text-sm text-gray-600"}," Are you sure you want to delete this time entry? This action cannot be undone and will sync to ClickUp. ",-1)),c.value?(d(),n("div",Rt,[e("p",Wt,[t[31]||(t[31]=e("strong",null,"ID:",-1)),E(" "+o(c.value.id),1),t[32]||(t[32]=e("br",null,null,-1)),t[33]||(t[33]=e("strong",null,"User:",-1)),E(" "+o(((r=c.value.user)==null?void 0:r.name)||"N/A"),1),t[34]||(t[34]=e("br",null,null,-1)),t[35]||(t[35]=e("strong",null,"Date:",-1)),E(" "+o(H(c.value.date)),1),t[36]||(t[36]=e("br",null,null,-1)),t[37]||(t[37]=e("strong",null,"Total Hours:",-1)),E(" "+o(z(c.value.total_hours)),1)])])):g("",!0),e("div",{class:"flex justify-end gap-3"},[e("button",{onClick:B,class:"rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50"}," Cancel "),e("button",{onClick:X,class:"rounded-md bg-red-600 px-4 py-2 text-sm font-medium text-white hover:bg-red-700"}," Delete ")])])])):g("",!0)]}),_:1})],64))}});export{le as default};
