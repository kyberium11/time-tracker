import{_ as $}from"./AuthenticatedLayout.vue_vue_type_script_setup_true_lang-1uYBQ1JQ.js";import{d as D,r as m,o as H,c as b,a as l,b as k,u as N,h as W,w as C,e,f as u,g as r,t as n,i as U,F as g,j as h,n as j}from"./app-CYQuHp7T.js";import{a as M}from"./api-DSwRIRUE.js";const V={key:0,class:"text-sm text-gray-500"},B={class:"py-12"},F={class:"mx-auto max-w-7xl sm:px-6 lg:px-8"},O={class:"mb-6 flex flex-wrap items-center justify-between gap-3"},R={key:0,class:"text-sm text-gray-500"},q={class:"flex items-center gap-2"},E=["disabled"],z={key:0,class:"h-3 w-3 animate-spin rounded-full border-2 border-indigo-500 border-t-transparent"},G={key:0,class:"bg-white shadow rounded-lg p-10 text-center text-sm text-gray-500"},I={key:1,class:"bg-red-50 border border-red-200 text-red-700 rounded-lg p-6 flex flex-col gap-4"},Q={class:"text-sm"},J={key:2,class:"space-y-8"},K={class:"grid gap-4 md:grid-cols-2 xl:grid-cols-3"},P={class:"text-sm font-semibold uppercase tracking-wide text-gray-500"},X={class:"mt-2 text-3xl font-bold"},Y={class:"mt-2 text-sm text-gray-600"},Z={class:"grid gap-6 lg:grid-cols-2"},ee={class:"rounded-xl bg-white shadow-sm"},te={class:"border-b border-gray-100 px-5 py-4"},se={class:"text-sm text-gray-500"},ae={key:0,class:"divide-y divide-gray-100"},oe={class:"font-medium text-gray-900"},le={class:"text-sm text-gray-500"},re={key:0,class:"ml-1 text-gray-400"},ne={class:"text-right"},ie={class:"text-sm font-semibold text-indigo-600"},de={class:"text-xs text-gray-500"},ue={key:1,class:"px-5 py-6 text-sm text-gray-500"},ce={class:"rounded-xl bg-white shadow-sm"},me={class:"space-y-4 px-5 py-6"},ge={class:"text-sm font-medium text-gray-600"},_e={class:"text-sm font-semibold text-gray-900 text-right"},pe=D({__name:"Analytics",setup(xe){const o=m(null),_=m(!0),c=m(null),i=m(!1),p=async()=>{var t,a;try{c.value=null;const{data:s}=await M.get("/admin/analytics/summary");o.value=s}catch(s){console.error(s),c.value=((a=(t=s==null?void 0:s.response)==null?void 0:t.data)==null?void 0:a.error)||"Unable to load analytics summary.",o.value=null}finally{_.value=!1,i.value=!1}};H(p);const y=async()=>{i.value=!0,await p()},x=t=>`${t.toFixed(2)} h`,d=t=>t.toLocaleString(),v=t=>new Date(t).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),f=t=>new Date(t).toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"}),S=t=>{if(t===null)return"--";const a=Math.floor(t/60),s=t%60;return a===0?`${s}m`:`${a}h ${s}m`},T=t=>t?new Date(t).toLocaleString("en-US",{hour:"numeric",minute:"2-digit"}):"--",L=b(()=>{if(!o.value)return[];const t=o.value.totals;return[{title:"Hours Logged Today",value:x(t.hours_today),subtitle:"Completed work hours",accent:"border-blue-500 bg-blue-50 text-blue-700"},{title:"Hours Logged This Week",value:x(t.hours_week),subtitle:"Mon–Sun total",accent:"border-indigo-500 bg-indigo-50 text-indigo-700"},{title:"Active Users Today",value:d(t.active_users_today),subtitle:"Unique employees with activity",accent:"border-emerald-500 bg-emerald-50 text-emerald-700"},{title:"Active Users This Week",value:d(t.active_users_week),subtitle:"Unique employees this week",accent:"border-teal-500 bg-teal-50 text-teal-700"},{title:"Avg Hours / User (Week)",value:x(t.average_hours_per_user_week),subtitle:"Hours per active user",accent:"border-purple-500 bg-purple-50 text-purple-700"},{title:"Open Clock-ins",value:d(t.open_entries),subtitle:"Users still on the clock",accent:"border-amber-500 bg-amber-50 text-amber-700"}]}),A=b(()=>{if(!o.value)return[];const t=o.value.totals;return[{label:"Late clock-ins today",value:d(t.late_clock_ins_today)},{label:"Completed entries today",value:d(t.total_entries_today)},{label:"Week window",value:`${v(o.value.dates.week_start)} → ${v(o.value.dates.week_end)}`},{label:"Report generated",value:f(o.value.generated_at)}]}),w=b(()=>{var t;return(((t=o.value)==null?void 0:t.open_entries.length)??0)>0});return(t,a)=>(r(),l(g,null,[k(N(W),{title:"Analytics"}),k($,null,{header:C(()=>[e("div",null,[a[0]||(a[0]=e("h2",{class:"text-xl font-semibold leading-tight text-gray-800"},"Company Health Overview",-1)),o.value?(r(),l("p",V,"As of "+n(f(o.value.generated_at)),1)):u("",!0)])]),default:C(()=>[e("div",B,[e("div",F,[e("div",O,[e("div",null,[a[1]||(a[1]=e("h3",{class:"text-lg font-semibold text-gray-900"},"Time Tracking Summary",-1)),o.value?(r(),l("p",R," Today: "+n(v(o.value.dates.today)),1)):u("",!0)]),e("div",q,[e("button",{type:"button",onClick:y,disabled:i.value||_.value,class:"inline-flex items-center gap-2 rounded-md border border-indigo-200 bg-white px-4 py-2 text-sm font-medium text-indigo-600 shadow-sm transition hover:bg-indigo-50 disabled:cursor-not-allowed disabled:border-gray-200 disabled:text-gray-400"},[i.value?(r(),l("span",z)):u("",!0),e("span",null,n(i.value?"Refreshing…":"Refresh"),1)],8,E)])]),_.value?(r(),l("div",G,[...a[2]||(a[2]=[e("div",{class:"mx-auto mb-3 h-8 w-8 animate-spin rounded-full border-b-2 border-indigo-600"},null,-1),U(" Loading analytics summary… ",-1)])])):c.value?(r(),l("div",I,[e("div",null,[a[3]||(a[3]=e("h4",{class:"font-semibold text-red-800"},"We couldn’t load the analytics overview.",-1)),e("p",Q,n(c.value),1)]),e("div",null,[e("button",{type:"button",onClick:y,class:"inline-flex items-center rounded-md bg-red-600 px-4 py-2 text-sm font-medium text-white shadow-sm transition hover:bg-red-500"}," Try again ")])])):o.value?(r(),l("div",J,[e("div",K,[(r(!0),l(g,null,h(L.value,s=>(r(),l("div",{key:s.title,class:j(["rounded-xl border bg-white p-6 shadow-sm transition hover:-translate-y-1 hover:shadow-md",s.accent])},[e("h4",P,n(s.title),1),e("p",X,n(s.value),1),e("p",Y,n(s.subtitle),1)],2))),128))]),e("div",Z,[e("div",ee,[e("div",te,[a[4]||(a[4]=e("h4",{class:"text-base font-semibold text-gray-800"},"Who’s still on the clock",-1)),e("p",se,n(w.value?"Top 10 current sessions":"No one is clocked in right now."),1)]),w.value?(r(),l("div",ae,[(r(!0),l(g,null,h(o.value.open_entries,s=>(r(),l("div",{key:s.entry_id,class:"flex items-center justify-between gap-3 px-5 py-4"},[e("div",null,[e("p",oe,n(s.user.name||"Unknown User"),1),e("p",le,[U(n(s.user.email||"No email listed")+" ",1),s.user.team?(r(),l("span",re,"· "+n(s.user.team),1)):u("",!0)])]),e("div",ne,[e("p",ie,n(S(s.minutes_running)),1),e("p",de,"since "+n(T(s.clock_in)),1)])]))),128))])):(r(),l("div",ue," All clocks are cleared for today. Great job! "))]),e("div",ce,[a[5]||(a[5]=e("div",{class:"border-b border-gray-100 px-5 py-4"},[e("h4",{class:"text-base font-semibold text-gray-800"},"At a glance"),e("p",{class:"text-sm text-gray-500"},"Quick context for today and the week.")],-1)),e("dl",me,[(r(!0),l(g,null,h(A.value,s=>(r(),l("div",{key:s.label,class:"flex items-center justify-between gap-4"},[e("dt",ge,n(s.label),1),e("dd",_e,n(s.value),1)]))),128))])])])])):u("",!0)])])]),_:1})],64))}});export{pe as default};
