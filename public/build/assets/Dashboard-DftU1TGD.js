import{d as Zt,r as m,c as C,o as Jt,B as Qt,u as Xt,a as i,b as ct,e as es,h as ts,f as mt,g as t,i as f,j as d,n as P,t as r,k as Ue,m as ee,F as O,l as F,v as Oe,p as je,C as ss}from"./app-D8I7bgux.js";import{_ as as}from"./AuthenticatedLayout.vue_vue_type_script_setup_true_lang-Cvq3D8XC.js";import{a as D}from"./api-C_Xlb8pR.js";const os={class:"py-12"},ns={class:"mx-auto max-w-[95%] sm:px-6 lg:px-8"},ls={key:0,class:"border-b border-gray-200 mb-6"},rs={class:"-mb-px flex space-x-8"},is={key:1},ds={class:"mb-6 grid gap-4 md:grid-cols-3"},us={class:"overflow-hidden bg-white shadow sm:rounded-lg"},cs={class:"px-4 py-5 sm:p-6"},ms={class:"mt-2 text-3xl font-bold text-gray-900"},ps={class:"text-xs text-gray-500"},vs={key:0,class:"mt-2"},gs={class:"text-sm text-gray-600"},xs={class:"font-semibold"},ys={class:"mt-4 flex flex-wrap gap-2"},fs=["disabled"],hs=["disabled"],ks={class:"overflow-hidden bg-white shadow sm:rounded-lg"},bs={class:"px-4 py-5 sm:p-6"},_s={key:0,class:"mt-2"},ws={class:"text-2xl font-bold text-gray-900 mt-1"},Ss={key:0,class:"text-sm font-normal text-gray-500"},Ts={class:"mt-3"},Ds=["disabled"],Ms={key:1,class:"mt-2"},Cs={class:"flex items-center gap-2 w-full"},Ns=["value"],$s=["disabled"],Is={key:0,class:"text-sm text-gray-500 mt-2"},Es={class:"overflow-hidden bg-white shadow sm:rounded-lg"},Ls={class:"px-4 py-5 sm:p-6"},Ps={class:"mt-2 text-3xl font-bold text-gray-900"},Bs={class:"mt-4 flex space-x-2"},Us=["disabled"],Os={class:"mb-6 overflow-hidden bg-white shadow sm:rounded-lg"},js={class:"px-4 py-5 sm:p-6"},Hs={class:"mb-4 space-y-4"},Ws={class:"flex flex-wrap items-center justify-between gap-3"},Fs=["disabled"],Rs={key:0,class:"h-3 w-3 rounded-full border-2 border-white border-t-transparent animate-spin"},Vs={class:"border-b border-gray-200"},zs={class:"-mb-px flex space-x-6","aria-label":"Task tabs"},As={class:"flex flex-wrap items-center gap-2"},qs=["value"],Ys={class:"overflow-x-auto"},Gs={class:"min-w-full divide-y divide-gray-200"},Ks={class:"divide-y divide-gray-200 bg-white"},Zs={class:"px-6 py-4 text-sm text-indigo-600 max-w-md"},Js=["onClick"],Qs={class:"whitespace-nowrap px-6 py-4 text-sm text-gray-900"},Xs={class:"whitespace-nowrap px-6 py-4 text-sm text-gray-900"},ea={class:"whitespace-nowrap px-6 py-4 text-sm"},ta={key:1,class:"text-sm text-gray-700"},sa={class:"whitespace-nowrap px-6 py-4 text-sm text-gray-900"},aa={class:"whitespace-nowrap px-6 py-4 text-sm text-gray-500"},oa={class:"whitespace-nowrap px-6 py-4 text-sm"},na={class:"whitespace-nowrap px-6 py-4 text-sm text-gray-900"},la={class:"flex items-center space-x-2"},ra=["onClick","disabled","aria-label"],ia={key:0,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",class:"h-4 w-4"},da={key:1,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",class:"h-4 w-4"},ua=["value","onChange"],ca=["value"],ma={key:0,value:"complete"},pa={key:1,value:"done"},va={class:"flex items-center justify-between px-6 py-3 text-sm text-gray-600"},ga={class:"space-x-2"},xa=["disabled"],ya=["disabled"],fa={class:"overflow-hidden bg-white shadow sm:rounded-lg"},ha={class:"px-4 py-5 sm:p-6"},ka={key:0,class:"text-center py-8 text-gray-500"},ba={key:1,class:"overflow-x-auto"},_a={class:"min-w-full divide-y divide-gray-200"},wa={class:"divide-y divide-gray-200"},Sa={class:"px-4 py-4 text-sm text-gray-900"},Ta={class:"px-4 py-4 text-sm text-gray-500"},Da={class:"px-4 py-4 text-sm text-gray-500"},Ma={class:"px-4 py-4 text-sm text-gray-900 font-semibold"},Ca={class:"px-4 py-4 text-sm text-gray-500"},Na={class:"px-4 py-4 text-sm text-gray-500"},$a={key:2,class:"space-y-6"},Ia={class:"bg-white shadow rounded-lg p-4"},Ea={class:"grid gap-4 sm:grid-cols-2"},La={class:"bg-white shadow rounded-lg p-5"},Pa={class:"grid gap-4 sm:grid-cols-3 lg:grid-cols-5 text-sm"},Ba={class:"font-semibold"},Ua={class:"font-semibold"},Oa={class:"font-semibold"},ja={class:"font-semibold"},Ha={class:"bg-white shadow rounded-lg"},Wa={class:"overflow-x-auto"},Fa={class:"min-w-full divide-y divide-gray-200"},Ra={class:"divide-y divide-gray-200"},Va={class:"px-4 py-4 text-sm text-gray-900"},za={class:"px-4 py-4 text-sm text-gray-500"},Aa={class:"px-4 py-4 text-sm text-gray-500"},qa={class:"px-4 py-4 text-sm text-gray-900 font-semibold"},Ya={class:"px-4 py-4 text-sm text-gray-500"},Ga={class:"px-4 py-4 text-sm text-gray-500"},Ka={key:0},Za={key:0,class:"text-center py-8"},Ja={key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50"},Qa={class:"w-full max-w-4xl rounded-lg bg-white shadow-lg flex flex-col max-h-[90vh]"},Xa={class:"flex items-center justify-between border-b px-4 py-3 flex-shrink-0"},eo={class:"p-4 flex flex-col flex-1 min-h-0"},to={key:0,class:"text-gray-500 text-sm"},so={key:1,class:"flex flex-col flex-1 min-h-0"},ao={class:"mb-4 flex gap-6 flex-shrink-0"},oo={class:"flex-1 bg-gray-50 rounded-lg p-4"},no={class:"text-2xl font-bold text-gray-900 mt-1"},lo={class:"flex-1 bg-gray-50 rounded-lg p-4"},ro={class:"text-2xl font-bold text-gray-900 mt-1"},io={class:"flex-1 overflow-y-auto border border-gray-200 rounded-lg"},uo={class:"min-w-full divide-y divide-gray-200"},co={class:"divide-y divide-gray-200 bg-white"},mo={class:"px-4 py-2 text-sm text-gray-900"},po={class:"px-4 py-2 text-sm text-gray-700"},vo={class:"px-4 py-2 text-sm text-gray-700"},go={class:"px-4 py-2 text-sm text-gray-700 font-semibold"},xo={class:"px-4 py-2 text-sm text-gray-700"},yo={class:"px-4 py-2 text-sm text-gray-700"},fo={key:1,class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50"},ho={class:"w-full max-w-lg rounded-lg bg-white shadow-xl"},ko={class:"flex items-center justify-between border-b px-5 py-3"},bo=["disabled"],_o={class:"p-5 space-y-4 text-sm text-gray-700"},wo={key:0},So={class:"mb-4"},To={class:"flex items-center justify-between mb-2"},Do={class:"text-xs font-medium text-gray-600"},Mo={class:"text-xs text-gray-500"},Co={class:"w-full bg-gray-200 rounded-full h-2"},No={class:"flex items-center gap-2"},$o={key:0,class:"h-4 w-4 rounded-full border-2 border-current border-t-transparent animate-spin"},Io={key:1,class:"text-green-600 text-lg"},Eo={key:2,class:"text-yellow-600 text-lg"},Lo={key:3,class:"text-red-600 text-lg"},Po={class:"font-semibold text-gray-900"},Bo={key:0,class:"space-y-3"},Uo={key:1,class:"text-sm text-gray-600"},Oo={key:2,class:"text-sm text-gray-600"},jo={key:3,class:"text-sm space-y-1"},Ho={class:"text-xs text-gray-600"},Wo={key:4,class:"text-sm text-yellow-700"},Fo={key:5,class:"text-sm text-red-700"},Ro={key:1,class:"mt-4"},Vo={class:"max-h-32 overflow-y-auto space-y-1 text-xs"},zo={class:"text-gray-700"},Ao={key:2,class:"flex items-center gap-2 text-sm text-gray-500"},qo={key:2,class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50"},Yo={class:"w-full max-w-3xl rounded-lg bg-white shadow-lg"},Go={class:"p-5 text-sm text-gray-700 space-y-5"},Ko={class:"space-y-1"},Zo={key:0,class:"text-xs text-gray-500"},Jo={class:"font-medium text-gray-600"},Qo={class:"grid gap-3 sm:grid-cols-2 lg:grid-cols-5"},Xo={class:"rounded-md bg-indigo-50 px-4 py-3"},en={class:"text-xl font-semibold text-indigo-900"},tn={class:"rounded-md bg-green-50 px-4 py-3"},sn={class:"text-xl font-semibold text-green-900"},an={class:"rounded-md bg-blue-50 px-4 py-3"},on={class:"text-xl font-semibold text-blue-900"},nn={class:"rounded-md bg-gray-100 px-4 py-3"},ln={class:"text-xl font-semibold text-gray-900"},rn={class:"rounded-md bg-amber-50 px-4 py-3"},dn={class:"text-xl font-semibold text-amber-900"},un={key:0,class:"space-y-2"},cn={class:"max-h-48 overflow-y-auto space-y-2 pr-1"},mn={class:"flex items-start justify-between gap-3"},pn={class:"font-medium text-green-900 leading-tight"},vn={class:"text-xs text-green-700 whitespace-nowrap"},gn={class:"mt-1 flex flex-wrap gap-3 text-xs text-green-800"},xn={key:0},yn={key:1},fn={key:1,class:"space-y-2"},hn={class:"max-h-48 overflow-y-auto space-y-2 pr-1"},kn={class:"flex items-start justify-between gap-3"},bn={class:"font-medium text-blue-900 leading-tight"},_n={class:"text-xs text-blue-700 whitespace-nowrap"},wn={class:"mt-1 flex flex-wrap gap-3 text-xs text-blue-800"},Sn={key:0},Tn={key:1},Dn={key:2,class:"space-y-2"},Mn={class:"max-h-40 overflow-y-auto space-y-1 pr-1"},Cn={class:"flex items-start justify-between gap-3"},Nn={class:"font-medium leading-tight"},$n={class:"text-amber-700"},In={key:3,class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50"},En={class:"w-full max-w-3xl max-h-[90vh] rounded-lg bg-white shadow-lg flex flex-col"},Ln={class:"flex items-center justify-between border-b px-4 py-3 flex-shrink-0"},Pn={key:0,class:"p-6 text-sm text-gray-700 overflow-y-auto flex-1"},Bn={class:"mb-4 pb-4 border-b"},Un={class:"font-semibold text-lg text-gray-900 mb-2"},On={class:"flex items-center gap-3 flex-wrap"},jn={key:0,class:"text-sm"},Hn={key:1,class:"ml-1 text-gray-700"},Wn={key:1},Fn=["href"],Rn={key:0,class:"task-content"},Vn=["innerHTML"],zn={key:1,class:"text-gray-500 italic"},Kn=Zt({__name:"Dashboard",setup(An){const c=m(null),I=m(!1),ie=m(""),te=m(new Date),de=m("employee"),K=m([]),ge=m(null),S=m(null),He=m(!1),Ke=m([]),we=m(0),We=m(0),xe=m(!1),Z=m([]),B=m(null),Se=m(!1),Fe=m(!1),Te=m(!1),N=m(null),ye=m(!1);m(!1),m(null);const Ze=m([]),pt=m([]),vt=C(()=>Ze.value.length>0);C(()=>vt.value&&pt.value.length===Ze.value.length);const z=m(!1),j=m(0),ue=m([]),E=m(null),p=m(null),_=m([]),ce=m("dashboard"),se=m(""),Je=m([]),De=m(!1),H=m({workSeconds:0,breakSeconds:0,lunchSeconds:0,tasksCount:0,status:"No Entry",overtimeSeconds:0}),L=m([]),Re=m(""),ae=m(1),fe=m(10),Me=m("all"),he=m("ongoing"),Ce=C(()=>{const s=new Set;return(K.value||[]).forEach(e=>{const o=(e.status||"").toString().trim();o&&s.add(o)}),Array.from(s).sort((e,o)=>e.localeCompare(o))}),Ne=m("all"),$e=m(""),Ie=m(""),Qe=s=>{const e=(s||"").toString().trim().toLowerCase();return e==="complete"||e==="completed"},Ve=C(()=>{const s=Re.value.trim().toLowerCase();let o=K.value.filter(n=>he.value==="complete"?Qe(n.status):!Qe(n.status));if(Me.value!=="all"){const n=Me.value.toLowerCase();o=o.filter(l=>(l.status||"").toLowerCase()===n)}if(Ne.value!=="all"){const n=Ne.value;o=o.filter(l=>(l.priority||"none").toLowerCase()===n)}if($e.value){const n=new Date($e.value).getTime();o=o.filter(l=>l.due_date?new Date(l.due_date).getTime()>=n:!1)}if(Ie.value){const n=new Date(Ie.value).getTime();o=o.filter(l=>l.due_date?new Date(l.due_date).getTime()<=n:!1)}return s?o.filter(n=>{const l=(n.title||"").toLowerCase(),u=(n.clickup_list_name||"").toLowerCase();return l.includes(s)||u.includes(s)}):o}),Ee=C(()=>Math.max(1,Math.ceil(Ve.value.length/fe.value))),gt=C(()=>{const e=(Math.min(ae.value,Ee.value)-1)*fe.value;return Ve.value.slice(e,e+fe.value)}),A=s=>{const e=Math.max(1,Math.min(s,Ee.value));ae.value=e},Xe=s=>{he.value!==s&&(he.value=s,A(1))};let ze=null,ke=null;const Le=m(!1),Pe=m(!1),be=m(!1),Ae=m(!1),R=C(()=>{var s,e;return!!((s=c.value)!=null&&s.clock_in)&&!((e=c.value)!=null&&e.clock_out)}),W=C(()=>{var s,e;return!!((s=c.value)!=null&&s.break_start)&&!((e=c.value)!=null&&e.break_end)}),xt=C(()=>{var s,e;return((s=c.value)==null?void 0:s.lunch_start)&&!((e=c.value)!=null&&e.lunch_end)}),Be=C(()=>{const s=[];if(!c.value)return s;const e=c.value;if(e.clock_in&&e.clock_out){const o=Math.max(0,Math.floor((new Date(e.clock_out).getTime()-new Date(e.clock_in).getTime())/1e3)),n=e.break_start?new Date(e.break_start):null,l=e.break_end?new Date(e.break_end):null;let u=0;n&&l&&(u=Math.max(0,Math.floor((l.getTime()-n.getTime())/1e3)));const v=Math.max(0,o-u);s.push({name:"Work Hours",start:e.clock_in,end:e.clock_out,durationSeconds:v,breakDurationSeconds:u,notes:"-"})}if(e.break_start&&e.break_end){const o=Math.max(0,Math.floor((new Date(e.break_end).getTime()-new Date(e.break_start).getTime())/1e3));s.push({name:"Break",start:e.break_start,end:e.break_end,durationSeconds:o,breakDurationSeconds:o,notes:"-"})}return Z.value.forEach(o=>{var n;if(o.clock_in&&o.clock_out){const l=Math.max(0,Math.floor((new Date(o.clock_out).getTime()-new Date(o.clock_in).getTime())/1e3));s.push({name:((n=o.task)==null?void 0:n.title)||`Task #${o.task_id}`,start:o.clock_in,end:o.clock_out,durationSeconds:l,breakDurationSeconds:0,notes:"-"})}}),s.sort((o,n)=>{const l=new Date(o.start).getTime(),u=new Date(n.start).getTime();return(isNaN(u)?0:u)-(isNaN(l)?0:l)}),s}),yt=async()=>{"Notification"in window&&Notification.permission==="default"&&await Notification.requestPermission()},qe=(s,e,o)=>{"Notification"in window&&Notification.permission==="granted"&&new Notification(s,{body:e,icon:"/favicon.ico",badge:"/favicon.ico",tag:"time-tracker-notification",requireInteraction:!1,...o})},ft=()=>{var s;if(W.value&&((s=c.value)!=null&&s.break_start)){const e=new Date(c.value.break_start),o=te.value,n=Math.floor((o.getTime()-e.getTime())/1e3),l=Math.floor(n/60);l>=13&&!Le.value&&(qe("Break Reminder","You're approaching the 15-minute break limit. Please end your break soon.",{tag:"break-13-min"}),Le.value=!0),l>=15&&!Pe.value&&(qe("Break Over Limit","You've exceeded the 15-minute break limit. Please end your break now.",{tag:"break-15-min",requireInteraction:!0}),Pe.value=!0)}else W.value||(Le.value=!1,Pe.value=!1)},et=async()=>{var s,e;if(!(Ae.value||be.value)&&!R.value&&(s=c.value)!=null&&s.clock_out&&(e=c.value)!=null&&e.clock_in){const o=new Date(c.value.clock_in),n=new Date(c.value.clock_out);Math.floor((n.getTime()-o.getTime())/1e3)/3600>=1&&!c.value.lunch_start&&!be.value&&(qe("Lunch Reminder","You've been working for 1 hour without taking lunch. Please remember to take your lunch break.",{tag:"lunch-reminder",requireInteraction:!0}),be.value=!0,Ae.value=!0)}},ht=()=>{ke&&clearInterval(ke),ke=window.setInterval(()=>{ft(),be.value||et()},6e4)},tt=s=>{if(R.value)return s.preventDefault(),s.returnValue="",""};Jt(async()=>{const s=new Date;se.value=s.toISOString().split("T")[0],await yt(),q(),bt(),J(),_e(),ne(),ze=window.setInterval(()=>{te.value=new Date},1e3),ht(),window.addEventListener("beforeunload",tt)}),Qt(()=>{ze&&window.clearInterval(ze),ke&&clearInterval(ke),window.removeEventListener("beforeunload",tt)});const q=async()=>{try{const s=await D.get("/time-entries/current");c.value=s.data,Ft(),W.value||(Le.value=!1,Pe.value=!1);const e=new Date().toISOString().split("T")[0];se.value!==e&&(be.value=!1,Ae.value=!1)}catch(s){c.value=null,ie.value="No entry today",console.error("Error fetching current entry:",s)}},kt=Xt(),bt=async()=>{var e,o;const s=(e=kt.props.auth)==null?void 0:e.user;if(s!=null&&s.role){const n=s.role;["admin","manager","employee","developer"].includes(n)&&(de.value=n)}else try{const l=(((o=(await D.get("/admin/users")).data)==null?void 0:o.data)||[]).find(u=>(u==null?void 0:u.id)&&(u==null?void 0:u.email));if(l!=null&&l.role){const u=l.role;["admin","manager","employee","developer"].includes(u)&&(de.value=u)}}catch{}},J=async()=>{try{const s=await D.get("/my/tasks");K.value=s.data}catch{}},_t=()=>{Fe.value=!1,N.value=null},wt=async()=>{Te.value||z.value||await St()},St=async()=>{var s,e,o;if(!z.value){z.value=!0,_.value=[],j.value=0,p.value=null;try{const n=await D.get("/my/clickup/configured-spaces");if(ue.value=((s=n.data)==null?void 0:s.space_ids)||[],ue.value.length===0){alert("No ClickUp spaces configured. Please set CLICKUP_SPACE_IDS in your environment variables."),z.value=!1;return}ye.value=!0,await oe()}catch(n){alert(((o=(e=n==null?void 0:n.response)==null?void 0:e.data)==null?void 0:o.error)||"Failed to start space sync"),z.value=!1,ye.value=!1}}},oe=async()=>{var e,o;if(j.value>=ue.value.length){z.value=!1,ye.value=!1,await J(),ue.value.length,_.value.filter(n=>{var l;return(l=n.result)==null?void 0:l.ok}).length,_.value.filter(n=>{var l,u;return!((l=n.result)!=null&&l.ok)&&((u=n.result)==null?void 0:u.skipped)}).length,N.value={summary:{total:_.value.reduce((n,l)=>{var u,v;return n+(((v=(u=l.result)==null?void 0:u.summary)==null?void 0:v.total)||0)},0),created:_.value.reduce((n,l)=>{var u,v;return n+(((v=(u=l.result)==null?void 0:u.summary)==null?void 0:v.created)||0)},0),updated:_.value.reduce((n,l)=>{var u,v;return n+(((v=(u=l.result)==null?void 0:u.summary)==null?void 0:v.updated)||0)},0),unchanged:_.value.reduce((n,l)=>{var u,v;return n+(((v=(u=l.result)==null?void 0:u.summary)==null?void 0:v.unchanged)||0)},0),skipped:_.value.reduce((n,l)=>{var u,v;return n+(((v=(u=l.result)==null?void 0:u.summary)==null?void 0:v.skipped)||0)},0)},created:_.value.flatMap(n=>{var l;return((l=n.result)==null?void 0:l.created)||[]}),updated:_.value.flatMap(n=>{var l;return((l=n.result)==null?void 0:l.updated)||[]}),skipped:_.value.flatMap(n=>{var l;return((l=n.result)==null?void 0:l.skipped)||[]}),sources:_.value.map(n=>`Space: ${n.name} (${n.space_id})`)},Fe.value=!0;return}const s=ue.value[j.value];p.value={current:j.value+1,total:ue.value.length,spaceName:"Loading...",status:"checking"};try{const n=await D.get(`/my/clickup/space/${s}/info`);if(E.value=n.data,!E.value){p.value.status="error",_.value.push({space_id:s,name:"Unknown",result:{ok:!1,error:"Failed to get space info"}}),j.value++,setTimeout(()=>{oe()},1e3);return}if(p.value={...p.value,spaceName:E.value.name},!E.value.is_member){p.value.status="skipped",_.value.push({space_id:s,name:E.value.name,result:{ok:!1,skipped:!0,reason:"User is not a member of this space"}}),j.value++,setTimeout(()=>{oe()},1e3);return}p.value.status="checking"}catch(n){p.value.status="error",_.value.push({space_id:s,name:"Unknown",result:{ok:!1,error:((o=(e=n==null?void 0:n.response)==null?void 0:e.data)==null?void 0:o.error)||"Failed to get space info"}}),j.value++,setTimeout(()=>{oe()},1e3)}},Tt=async()=>{var e,o;if(!E.value||!p.value)return;const s=E.value.space_id;if(s){p.value.status="syncing";try{const n=await D.post(`/my/clickup/space/${s}/sync`);p.value.status="completed",p.value.result=n.data,_.value.push({space_id:s,name:E.value.name,result:n.data}),j.value++,setTimeout(()=>{oe()},1500)}catch(n){p.value.status="error",_.value.push({space_id:s,name:E.value.name,result:{ok:!1,error:((o=(e=n==null?void 0:n.response)==null?void 0:e.data)==null?void 0:o.error)||"Failed to sync space"}}),j.value++,setTimeout(()=>{oe()},1500)}}},Dt=()=>{if(!E.value)return;const s=E.value.space_id;s&&(_.value.push({space_id:s,name:E.value.name,result:{ok:!1,skipped:!0,reason:"User skipped this space"}}),j.value++,oe())},Mt=()=>{z.value=!1,ye.value=!1,j.value=0,p.value=null,E.value=null,_.value=[]},st=async()=>{try{await Rt()}catch{}},Ct=async()=>{try{await Vt()}catch{}},Nt=async()=>{try{await zt()}catch{}},Ye=async()=>{try{await At()}catch{}},_e=async()=>{try{const s=await D.get("/tasks/today-entries");Z.value=s.data||[];const e=(Z.value||[]).find(o=>o.clock_in&&!o.clock_out);S.value=e?e.task_id:null}catch{Z.value=[]}},at=async s=>{try{const e=await D.get(`/tasks/${s}/sync`);B.value=e.data,Se.value=!0}catch{Se.value=!1}},$t=async()=>{if(W.value){await Ye();return}R.value?await Ct():await st()},It=async()=>{if(S.value){alert("Pause or stop the running task first.");return}W.value?await Ye():(R.value||await st(),await Nt())},Y=s=>s<10?`0${s}`:`${s}`,Et=C(()=>{var s;return R.value&&((s=c.value)!=null&&s.clock_in)?new Date(c.value.clock_in):null}),Lt=C(()=>{var s;return W.value&&((s=c.value)!=null&&s.break_start)?new Date(c.value.break_start):null}),Pt=C(()=>{const s=Z.value.find(e=>e.clock_in&&!e.clock_out);return s?new Date(s.clock_in):null}),Bt=C(()=>{const s=Et.value;if(!s)return"00:00:00";const e=te.value.getTime()-s.getTime(),o=Math.max(0,Math.floor(e/1e3)),n=Math.floor(o/3600),l=Math.floor(o%3600/60),u=o%60;return`${Y(n)}:${Y(l)}:${Y(u)}`}),Ut=C(()=>{const s=Lt.value;if(!s)return"00:00:00";const e=te.value.getTime()-s.getTime(),o=Math.max(0,Math.floor(e/1e3)),n=Math.floor(o/3600),l=Math.floor(o%3600/60),u=o%60;return`${Y(n)}:${Y(l)}:${Y(u)}`}),Ot=C(()=>{const s=Pt.value;if(!s)return"00:00:00";const e=te.value.getTime()-s.getTime(),o=Math.max(0,Math.floor(e/1e3)),n=Math.floor(o/3600),l=Math.floor(o%3600/60),u=o%60;return`${Y(n)}:${Y(l)}:${Y(u)}`}),jt=C(()=>{var o,n;let s=we.value||0;if(R.value&&((o=c.value)!=null&&o.clock_in)&&!((n=c.value)!=null&&n.clock_out)){const l=new Date(c.value.clock_in),u=te.value,v=Math.max(0,Math.floor((u.getTime()-l.getTime())/1e3));let k=0;if(c.value.break_start)if(c.value.break_end){const T=new Date(c.value.break_start),g=new Date(c.value.break_end);k=Math.max(0,Math.floor((g.getTime()-T.getTime())/1e3))}else{const T=new Date(c.value.break_start);k=Math.max(0,Math.floor((u.getTime()-T.getTime())/1e3))}let M=0;if(c.value.lunch_start)if(c.value.lunch_end){const T=new Date(c.value.lunch_start),g=new Date(c.value.lunch_end);M=Math.max(0,Math.floor((g.getTime()-T.getTime())/1e3))}else{const T=new Date(c.value.lunch_start);M=Math.max(0,Math.floor((u.getTime()-T.getTime())/1e3))}const x=Math.max(0,v-k-M);s+=x}return Z.value&&Z.value.length>0&&Z.value.forEach(l=>{if(l.clock_in&&!l.clock_out){const u=new Date(l.clock_in),v=te.value,k=Math.max(0,Math.floor((v.getTime()-u.getTime())/1e3));s+=k}}),(s/3600).toFixed(2)}),Ht=async()=>{await ne(),He.value=!0},Wt=async()=>{var s,e;if(!xe.value){xe.value=!0;try{await ne(),await D.post("/my/daily-report/send"),alert("Daily report sent successfully to your email!")}catch(o){alert(((e=(s=o==null?void 0:o.response)==null?void 0:s.data)==null?void 0:e.message)||"Failed to send daily report")}finally{xe.value=!1}}},ne=async()=>{var s;try{const e=new Date().toISOString().split("T")[0],n=((s=(await D.get("/my/time-entries",{params:{start_date:e,end_date:e}})).data)==null?void 0:s.entries)||[],l=[];let u=0,v=0,k=0;const M=new Date;n.forEach(x=>{const T=x.clock_in_formatted||x.clock_in,g=x.clock_out_formatted||x.clock_out,h=Q(x.clock_in),w=Q(x.clock_out);if(x.is_break||x.entry_type==="break"){if(!h)return;const y=!!w;let $=0;y&&w?($=Math.max(0,Math.floor((w.getTime()-h.getTime())/1e3)),k+=$):$=Math.max(0,Math.floor((M.getTime()-h.getTime())/1e3)),l.push({name:"Break",start:T,end:y?g:null,durationSeconds:$,breakDurationSeconds:$,notes:y?"-":"In progress"});return}if(!h)return;const b=x.task&&(x.task.title||x.task.name),a=!!w;if(!b)if(a&&w){const y=Math.max(0,Math.floor((w.getTime()-h.getTime())/1e3)),$=Q(x.lunch_start),X=Q(x.lunch_end);let G=0;$&&X&&(G=Math.max(0,Math.floor((X.getTime()-$.getTime())/1e3)));const V=Math.max(0,y-G);u+=V,l.push({name:"Work Hours",start:T,end:g,durationSeconds:V,breakDurationSeconds:0,notes:"-"})}else{const y=Math.max(0,Math.floor((M.getTime()-h.getTime())/1e3));l.push({name:"Work Hours",start:T,end:null,durationSeconds:y,breakDurationSeconds:0,notes:"In progress"})}if(b){let y=0;a&&w?y=Math.max(0,Math.floor((w.getTime()-h.getTime())/1e3)):y=Math.max(0,Math.floor((M.getTime()-h.getTime())/1e3)),v+=y,l.push({name:x.task.title||x.task.name,start:T,end:a?g:null,durationSeconds:y,breakDurationSeconds:0,notes:a?"-":"In progress"})}}),l.sort((x,T)=>{const g=new Date(x.start).getTime(),h=new Date(T.start).getTime();return(isNaN(h)?0:h)-(isNaN(g)?0:g)}),Ke.value=l,we.value=u,We.value=v}catch{Ke.value=[],we.value=0,We.value=0}},Ft=()=>{!c.value||!c.value.clock_in?ie.value="Not clocked in":c.value.clock_out?ie.value="Clocked out":xt.value?ie.value="On lunch":W.value?ie.value="On break":ie.value="Clocked in"},Rt=async s=>{var o,n;const e=new Date().toISOString();c.value?(c.value.clock_in=e,c.value.clock_out=void 0):c.value={id:0,clock_in:e,clock_out:void 0,break_start:void 0,break_end:void 0,lunch_start:void 0,lunch_end:void 0},I.value=!0;try{const l={};await D.post("/time-entries/clock-in",l),await q(),await J(),await ne()}catch(l){await q(),alert(((n=(o=l.response)==null?void 0:o.data)==null?void 0:n.message)||"Error clocking in")}finally{I.value=!1}},Vt=async()=>{var s,e;if(S.value){alert("Pause or stop the running task first.");return}c.value&&(c.value.clock_out=new Date().toISOString()),I.value=!0;try{await D.post("/time-entries/clock-out"),await q(),await J(),await ne(),setTimeout(()=>{et()},1e3)}catch(o){await q(),alert(((e=(s=o.response)==null?void 0:s.data)==null?void 0:e.message)||"Error clocking out")}finally{I.value=!1}},zt=async()=>{var e,o;const s=new Date().toISOString();c.value&&(c.value.break_start=s,c.value.break_end=void 0),I.value=!0;try{await D.post("/time-entries/break-start"),await q(),await J(),await ne()}catch(n){await q(),alert(((o=(e=n.response)==null?void 0:e.data)==null?void 0:o.message)||"Error starting break")}finally{I.value=!1}},At=async()=>{var s,e;c.value&&(c.value.break_end=new Date().toISOString()),I.value=!0;try{await D.post("/time-entries/break-end"),await q(),await J(),await ne()}catch(o){await q(),alert(((e=(s=o.response)==null?void 0:s.data)==null?void 0:e.message)||"Error ending break")}finally{I.value=!1}},ot=async s=>{var o,n;if(!R.value){alert("Please Time In first before starting a task.");return}W.value&&await Ye();const e=S.value;if(S.value=s,e&&e!==s)try{await D.post("/tasks/stop")}catch{}try{await D.post("/tasks/start",{task_id:s}),await _e()}catch(l){S.value=e,await _e(),alert(((n=(o=l==null?void 0:l.response)==null?void 0:o.data)==null?void 0:n.message)||"Failed to start task")}},nt=async()=>{const s=S.value;S.value=null;try{await D.post("/tasks/stop"),await _e()}catch{S.value=s,await _e()}},qt=async(s,e)=>{var n,l;if(!e)return;if(!confirm(`Are you sure you want to set this task to "${e}"?`)){await J();return}I.value=!0;try{await D.post(`/tasks/${s}/status`,{status:e}),await J()}catch(u){alert(((l=(n=u==null?void 0:u.response)==null?void 0:n.data)==null?void 0:l.message)||"Failed to update task status")}finally{I.value=!1}},lt=async()=>{var s,e;if(se.value){De.value=!0;try{const o=await D.get("/my/time-entries",{params:{start_date:se.value,end_date:se.value}}),n=((s=o.data)==null?void 0:s.entries)||[];Je.value=n,L.value=[];let l=0,u=0,v=null,k=null;const M=new Date;n.forEach(g=>{const h=g.clock_in_formatted||g.clock_in,w=g.clock_out_formatted||g.clock_out,b=Q(g.clock_in),a=Q(g.clock_out);if(b&&(!v||b<v)&&(v=b,k=h),g.is_break||g.entry_type==="break"){if(!b)return;const ve=!!a;let re=0;ve&&a?(re=Math.max(0,Math.floor((a.getTime()-b.getTime())/1e3)),u+=re):re=Math.max(0,Math.floor((M.getTime()-b.getTime())/1e3)),L.value.push({name:"Break",start:h,end:ve?w:null,durationSeconds:re,breakDurationSeconds:re,notes:ve?"-":"In progress"});return}if(!b)return;const y=g.task&&(g.task.title||g.task.name),$=!!a;let X=0,G=0;$&&a?X=Math.max(0,Math.floor((a.getTime()-b.getTime())/1e3)):G=Math.max(0,Math.floor((M.getTime()-b.getTime())/1e3));const V=Q(g.lunch_start),pe=Q(g.lunch_end);let le=0;V&&pe?le=Math.max(0,Math.floor((pe.getTime()-V.getTime())/1e3)):V&&!pe&&(le=Math.max(0,Math.floor((M.getTime()-V.getTime())/1e3)));const ut=$?Math.max(0,X-le):Math.max(0,G-le);if(y||($&&a?L.value.push({name:"Work Hours",start:h,end:w,durationSeconds:ut,breakDurationSeconds:0,notes:"-"}):L.value.push({name:"Work Hours",start:h,end:null,durationSeconds:ut,breakDurationSeconds:0,notes:"In progress"})),y){const ve=g.task.title||g.task.name;if($&&a){const re=Math.max(0,Math.floor((a.getTime()-b.getTime())/1e3));L.value.push({name:ve,start:h,end:w,durationSeconds:re,breakDurationSeconds:0,notes:"-"})}else L.value.push({name:ve,start:h,end:null,durationSeconds:G,breakDurationSeconds:0,notes:"In progress"})}}),L.value.sort((g,h)=>{const w=new Date(g.start).getTime(),b=new Date(h.start).getTime();return(isNaN(b)?0:b)-(isNaN(w)?0:w)});const x=L.value.filter(g=>g.name==="Work Hours").reduce((g,h)=>g+(h.durationSeconds||0),0),T=L.value.filter(g=>g.name==="Break").reduce((g,h)=>g+(h.durationSeconds||0),0);if((e=o.data)!=null&&e.daily_totals)H.value={workSeconds:o.data.daily_totals.work_seconds||0,breakSeconds:o.data.daily_totals.break_seconds||0,lunchSeconds:o.data.daily_totals.lunch_seconds||0,tasksCount:o.data.daily_totals.tasks_count||0,status:o.data.daily_totals.status||"No Entry",overtimeSeconds:o.data.daily_totals.overtime_seconds||0};else{const h=Math.max(0,x-28800);let w="No Entry";if(v){const b=(v.getUTCHours()+8)%24,a=v.getUTCMinutes();w=b<8||b===8&&a<=30?"Perfect":"Late"}H.value={workSeconds:x,breakSeconds:T,lunchSeconds:0,tasksCount:L.value.length,status:w,overtimeSeconds:h}}}catch(o){console.error("Error loading time entries",o),Je.value=[],L.value=[],H.value={workSeconds:0,breakSeconds:0,lunchSeconds:0,tasksCount:0,status:"No Entry",overtimeSeconds:0}}finally{De.value=!1}}},Q=s=>{if(!s)return null;const e=s.match(/^(\d{4})-(\d{2})-(\d{2})[ T](\d{2}):(\d{2})(?::(\d{2}))?/);if(e){const l=Number(e[1]),u=Number(e[2])-1,v=Number(e[3]),k=Number(e[4]),M=Number(e[5]),x=Number(e[6]||"0");return new Date(Date.UTC(l,u,v,k-8,M,x))}const o=s.includes("T")?s:s.replace(" ","T"),n=new Date(o);return isNaN(n.getTime())?null:n},me=s=>{if(!s)return"--";try{const o=new Date(s);if(!isNaN(o.getTime()))return o.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!0,timeZone:"Asia/Manila"})}catch{}const e=s.match(/\b(\d{1,2}):(\d{2})(?::(\d{2}))?/);if(e){let o=parseInt(e[1],10);const n=e[2],l=o>=12?"PM":"AM";return o=o%12,o===0&&(o=12),`${o}:${n} ${l}`}return"--"},U=s=>{const e=typeof s=="number"&&isFinite(s)?Math.max(0,Math.floor(s)):0,o=Math.floor(e/3600),n=Math.floor(e%3600/60),l=e%60,u=v=>v<10?`0${v}`:`${v}`;return`${u(o)}:${u(n)}:${u(l)}`},rt=s=>{if(!s)return"--";const e=new Date(s);return isNaN(e.getTime())?s:e.toLocaleDateString("en-US",{month:"short",day:"2-digit",year:"numeric"})},Ge=s=>{if(!s||s===0)return"--";const e=Math.floor(s/1e3);return U(e)},Yt=(s,e)=>{const o=s&&s>0?Ge(s):"0:00:00",n=e&&e>0?Ge(e):"--";return`${o} / ${n}`},it=s=>{if(!s)return"";const e=s.toLowerCase().trim();return e==="to do"||e==="todo"?"text-gray-700":e.includes("complete")||e.includes("done")||e.includes("finished")?"bg-green-100 text-green-800":e.includes("progress")||e.includes("doing")||e.includes("in progress")||e.includes("working")?"bg-blue-100 text-blue-800":e.includes("pending")||e.includes("waiting")?"bg-yellow-100 text-yellow-800":e.includes("blocked")||e.includes("stuck")?"bg-red-100 text-red-800":e.includes("review")||e.includes("testing")?"bg-purple-100 text-purple-800":e.includes("cancel")||e.includes("closed")?"bg-gray-100 text-gray-800":"bg-indigo-100 text-indigo-800"},Gt=s=>{if(!s)return"bg-gray-100 text-gray-800";const e=s.toLowerCase().trim();return e==="urgent"||e==="critical"?"bg-red-100 text-red-800":e==="high"?"bg-orange-100 text-orange-800":e==="normal"||e==="medium"?"bg-yellow-100 text-yellow-800":e==="low"?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"},dt=s=>{if(!s)return!1;const e=s.toLowerCase().trim();return e!=="to do"&&e!=="todo"},Kt=s=>{if(!s)return"";const e=s.split(`
`),o=[];let n=!1,l=[];for(let v=0;v<e.length;v++){const k=e[v].trim();if(!k){n&&l.length>0&&(o.push(`<ul class="list-disc ml-6 mb-3 space-y-1">${l.join("")}</ul>`),l=[],n=!1),o.length>0&&!o[o.length-1].startsWith("<")&&o.push('</p><p class="mb-2">');continue}if(k.match(/^#{1,3}\s+/)){n&&l.length>0&&(o.push(`<ul class="list-disc ml-6 mb-3 space-y-1">${l.join("")}</ul>`),l=[],n=!1),k.startsWith("###")?o.push(`<h3 class="font-semibold text-gray-900 mt-4 mb-2 text-base">${k.replace(/^###\s+/,"")}</h3>`):k.startsWith("##")?o.push(`<h2 class="font-bold text-gray-900 mt-5 mb-3 text-lg">${k.replace(/^##\s+/,"")}</h2>`):k.startsWith("#")&&o.push(`<h1 class="font-bold text-gray-900 mt-6 mb-4 text-xl">${k.replace(/^#\s+/,"")}</h1>`);continue}if(k.match(/^[\-\*â€¢]\s+/)){n||(n=!0);const x=k.replace(/^[\-\*â€¢]\s+/,"").trim();l.push(`<li class="mb-1">${x}</li>`);continue}if(k.match(/^\d+\.\s+/)){n||(n=!0);const x=k.replace(/^\d+\.\s+/,"").trim();l.push(`<li class="mb-1 list-decimal">${x}</li>`);continue}n&&l.length>0&&(o.push(`<ul class="list-disc ml-6 mb-3 space-y-1">${l.join("")}</ul>`),l=[],n=!1);let M=k.replace(/\*\*(.+?)\*\*/g,'<strong class="font-semibold">$1</strong>').replace(/\*(.+?)\*/g,'<em class="italic">$1</em>');o.push(M)}n&&l.length>0&&o.push(`<ul class="list-disc ml-6 mb-3 space-y-1">${l.join("")}</ul>`);let u=o.join("<br>");return u.startsWith("<")||(u='<p class="mb-2">'+u),u.endsWith(">")||(u=u+"</p>"),u};return(s,e)=>(d(),i(O,null,[ct(es(ts),{title:"Dashboard"}),ct(as,null,{header:mt(()=>[...e[25]||(e[25]=[t("h2",{class:"text-xl font-semibold leading-tight text-gray-800"}," Time Tracker Dashboard ",-1)])]),default:mt(()=>{var o,n,l,u,v,k,M,x,T,g,h,w,b;return[t("div",os,[t("div",ns,[de.value!=="admin"?(d(),i("div",ls,[t("nav",rs,[t("button",{onClick:e[0]||(e[0]=a=>ce.value="dashboard"),class:P(["whitespace-nowrap border-b-2 py-4 px-1 text-sm font-medium",ce.value==="dashboard"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700"])}," Dashboard ",2),t("button",{onClick:e[1]||(e[1]=a=>{ce.value="time-entries",lt()}),class:P(["whitespace-nowrap border-b-2 py-4 px-1 text-sm font-medium",ce.value==="time-entries"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700"])}," Time Entries ",2)])])):f("",!0),ce.value==="dashboard"||de.value==="admin"||de.value==="developer"?(d(),i("div",is,[t("div",ds,[t("div",us,[t("div",cs,[e[27]||(e[27]=t("h3",{class:"text-xs font-semibold uppercase tracking-wide text-gray-500"},"Work Day Timer",-1)),t("p",ms,r(Bt.value),1),t("p",ps,r(R.value?"Working":"Idle"),1),W.value?(d(),i("div",vs,[t("p",gs,[e[26]||(e[26]=Ue("Break Timer: ",-1)),t("span",xs,r(Ut.value),1)])])):f("",!0),t("div",ys,[t("button",{onClick:$t,disabled:I.value,class:P(["rounded-md px-3 py-1.5 text-xs font-semibold text-white",R.value?"bg-red-600 hover:bg-red-700":"bg-green-600 hover:bg-green-700"])},r(R.value?"Time Out":"Time In"),11,fs),t("button",{onClick:It,disabled:I.value,class:P(["rounded-md px-3 py-1.5 text-xs font-semibold text-white",W.value?"bg-orange-600 hover:bg-orange-700":"bg-yellow-600 hover:bg-yellow-700"])},r(W.value?"Break Out":"Break In"),11,hs)])])]),t("div",ks,[t("div",bs,[e[29]||(e[29]=t("h3",{class:"text-xs font-semibold uppercase tracking-wide text-gray-500"},"Running Task",-1)),S.value?(d(),i("div",_s,[t("button",{onClick:e[2]||(e[2]=a=>at(S.value)),class:"text-indigo-600 hover:underline text-sm"},r(((o=K.value.find(a=>a.id===S.value))==null?void 0:o.title)||"#"+S.value),1),t("p",ws,[Ue(r(Ot.value),1),(n=K.value.find(a=>a.id===S.value))!=null&&n.estimated_time?(d(),i("span",Ss," / "+r(Ge((l=K.value.find(a=>a.id===S.value))==null?void 0:l.estimated_time)),1)):f("",!0)]),t("div",Ts,[t("button",{onClick:e[3]||(e[3]=a=>nt()),disabled:I.value,class:"rounded-md bg-yellow-600 px-3 py-1.5 text-xs font-semibold text-white hover:bg-yellow-700"},"Pause",8,Ds)])])):(d(),i("div",Ms,[t("div",Cs,[ee(t("select",{"onUpdate:modelValue":e[4]||(e[4]=a=>ge.value=a),class:"w-full rounded-md border-gray-300 text-sm shadow-sm"},[e[28]||(e[28]=t("option",{value:null},"Select a task",-1)),(d(!0),i(O,null,F(K.value,a=>(d(),i("option",{key:a.id,value:a.id},r(a.title),9,Ns))),128))],512),[[Oe,ge.value]]),t("button",{onClick:e[5]||(e[5]=a=>ge.value?ot(ge.value):void 0),disabled:I.value||!ge.value,class:"rounded-md bg-green-600 px-3 py-1.5 text-xs font-semibold text-white hover:bg-green-700 disabled:opacity-50"},"Start",8,$s)]),K.value.length?f("",!0):(d(),i("p",Is,"No tasks available."))]))])]),t("div",Es,[t("div",Ls,[e[31]||(e[31]=t("h3",{class:"text-xs font-semibold uppercase tracking-wide text-gray-500"},"Daily Logs",-1)),t("p",Ps,[Ue(r(jt.value),1),e[30]||(e[30]=t("span",{class:"text-sm font-normal text-gray-500"}," / 8 Hours",-1))]),t("div",Bs,[t("button",{onClick:Ht,class:"rounded-md bg-indigo-600 px-3 py-1.5 text-xs font-semibold text-white hover:bg-indigo-700"},"Daily Logs"),t("button",{onClick:Wt,disabled:xe.value,class:"rounded-md bg-green-600 px-3 py-1.5 text-xs font-semibold text-white hover:bg-green-700 disabled:opacity-50"},r(xe.value?"Sending...":"Send Report"),9,Us)])])])]),t("div",Os,[t("div",js,[t("div",Hs,[t("div",Ws,[e[32]||(e[32]=t("h3",{class:"text-lg font-medium leading-6 text-gray-900"},"My Tasks",-1)),t("button",{onClick:wt,disabled:Te.value,class:"rounded-md bg-green-600 px-3 py-1.5 text-xs font-semibold text-white hover:bg-green-700 disabled:opacity-60 disabled:cursor-not-allowed flex items-center gap-2"},[Te.value?(d(),i("span",Rs)):f("",!0),t("span",null,r(Te.value?"Syncingâ€¦":"Refresh from ClickUp"),1)],8,Fs)]),t("div",Vs,[t("nav",zs,[t("button",{type:"button",onClick:e[6]||(e[6]=a=>Xe("ongoing")),class:P(["whitespace-nowrap border-b-2 px-1 pb-2 text-sm font-medium",he.value==="ongoing"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"])}," On Going ",2),t("button",{type:"button",onClick:e[7]||(e[7]=a=>Xe("complete")),class:P(["whitespace-nowrap border-b-2 px-1 pb-2 text-sm font-medium",he.value==="complete"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"])}," Complete ",2)])]),t("div",As,[ee(t("input",{"onUpdate:modelValue":e[8]||(e[8]=a=>Re.value=a),onInput:e[9]||(e[9]=a=>A(1)),type:"text",placeholder:"Search tasks",class:"rounded-md border-gray-300 text-sm shadow-sm"},null,544),[[je,Re.value]]),ee(t("select",{"onUpdate:modelValue":e[10]||(e[10]=a=>Me.value=a),onChange:e[11]||(e[11]=a=>A(1)),class:"rounded-md border-gray-300 text-sm shadow-sm"},[e[33]||(e[33]=t("option",{value:"all"},"All",-1)),(d(!0),i(O,null,F(Ce.value,a=>(d(),i("option",{key:a,value:a},r(a),9,qs))),128))],544),[[Oe,Me.value]]),ee(t("select",{"onUpdate:modelValue":e[12]||(e[12]=a=>Ne.value=a),onChange:e[13]||(e[13]=a=>A(1)),class:"rounded-md border-gray-300 text-sm shadow-sm"},[...e[34]||(e[34]=[t("option",{value:"all"},"All priorities",-1),t("option",{value:"urgent"},"Urgent",-1),t("option",{value:"high"},"High",-1),t("option",{value:"normal"},"Normal",-1),t("option",{value:"low"},"Low",-1),t("option",{value:"none"},"None",-1)])],544),[[Oe,Ne.value]]),ee(t("input",{"onUpdate:modelValue":e[14]||(e[14]=a=>$e.value=a),onChange:e[15]||(e[15]=a=>A(1)),type:"date",class:"rounded-md border-gray-300 text-sm shadow-sm"},null,544),[[je,$e.value]]),ee(t("input",{"onUpdate:modelValue":e[16]||(e[16]=a=>Ie.value=a),onChange:e[17]||(e[17]=a=>A(1)),type:"date",class:"rounded-md border-gray-300 text-sm shadow-sm"},null,544),[[je,Ie.value]]),ee(t("select",{"onUpdate:modelValue":e[18]||(e[18]=a=>fe.value=a),onChange:e[19]||(e[19]=a=>A(1)),class:"rounded-md border-gray-300 text-sm shadow-sm"},[...e[35]||(e[35]=[t("option",{value:5},"5",-1),t("option",{value:10},"10",-1),t("option",{value:20},"20",-1),t("option",{value:50},"50",-1)])],544),[[Oe,fe.value,void 0,{number:!0}]])])]),t("div",Ys,[t("table",Gs,[e[39]||(e[39]=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Task"),t("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Campaign"),t("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Parent Task"),t("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Status"),t("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Due Date"),t("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Estimated Time"),t("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Priority"),t("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Actions")])],-1)),t("tbody",Ks,[(d(!0),i(O,null,F(gt.value,a=>(d(),i("tr",{key:a.id},[t("td",Zs,[t("button",{onClick:y=>at(a.id),class:"hover:underline truncate block w-full text-left"},r(a.title),9,Js)]),t("td",Qs,r(a.clickup_list_name||"--"),1),t("td",Xs,r(a.parent_task_name||"N/A"),1),t("td",ea,[dt(a.status)?(d(),i("span",{key:0,class:P(["inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-semibold",it(a.status)])},r(a.status||"â€”"),3)):(d(),i("span",ta,r(a.status||"â€”"),1))]),t("td",sa,r(a.due_date?new Date(a.due_date).toLocaleDateString():"--"),1),t("td",aa,r(Yt(a.played_time,a.estimated_time)),1),t("td",oa,[t("span",{class:P(["inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-semibold",Gt(a.priority||null)])},r(a.priority||"None"),3)]),t("td",na,[t("div",la,[t("button",{onClick:y=>S.value===a.id?nt():ot(a.id),disabled:I.value,class:P(["rounded-full p-2 text-white",S.value===a.id?"bg-yellow-600 hover:bg-yellow-700":"bg-green-600 hover:bg-green-700"]),"aria-label":S.value===a.id?"Pause":"Play"},[S.value!==a.id?(d(),i("svg",ia,[...e[36]||(e[36]=[t("path",{d:"M8 5v14l11-7z"},null,-1)])])):(d(),i("svg",da,[...e[37]||(e[37]=[t("path",{d:"M6 5h4v14H6zM14 5h4v14h-4z"},null,-1)])]))],10,ra),t("select",{value:a.status||"",onChange:y=>qt(a.id,y.target.value),class:"rounded-md border-gray-300 text-xs shadow-sm"},[e[38]||(e[38]=t("option",{disabled:"",value:""},"Set statusâ€¦",-1)),(d(!0),i(O,null,F(Ce.value,y=>(d(),i("option",{key:y+a.id,value:y},r(y),9,ca))),128)),Ce.value.includes("complete")?f("",!0):(d(),i("option",ma,"complete")),Ce.value.includes("done")?f("",!0):(d(),i("option",pa,"done"))],40,ua)])])]))),128))])]),t("div",va,[t("div",null," Page "+r(ae.value)+" of "+r(Ee.value)+" â€¢ "+r(Ve.value.length)+" total ",1),t("div",ga,[t("button",{onClick:e[20]||(e[20]=a=>A(ae.value-1)),disabled:ae.value<=1,class:"rounded-md border px-3 py-1 disabled:opacity-50"},"Prev",8,xa),t("button",{onClick:e[21]||(e[21]=a=>A(ae.value+1)),disabled:ae.value>=Ee.value,class:"rounded-md border px-3 py-1 disabled:opacity-50"},"Next",8,ya)])])])])]),t("div",fa,[t("div",ha,[e[41]||(e[41]=t("h3",{class:"text-lg font-medium leading-6 text-gray-900 mb-4"},"Today's Time Events",-1)),Be.value.length===0?(d(),i("div",ka," No time entries recorded today. Clock in to start tracking time. ")):(d(),i("div",ba,[t("table",_a,[e[40]||(e[40]=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Task"),t("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Start Time"),t("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"End Time"),t("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Duration"),t("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Break Duration"),t("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Notes")])],-1)),t("tbody",wa,[(d(!0),i(O,null,F(Be.value,(a,y)=>(d(),i("tr",{key:y},[t("td",Sa,r(a.name),1),t("td",Ta,r(me(a.start)),1),t("td",Da,r(me(a.end)),1),t("td",Ma,r(U(a.durationSeconds)),1),t("td",Ca,r(U(a.breakDurationSeconds||0)),1),t("td",Na,r(a.notes||"-"),1)]))),128))])])]))])])])):f("",!0),ce.value==="time-entries"&&de.value!=="admin"?(d(),i("div",$a,[t("div",Ia,[t("div",Ea,[t("div",null,[e[42]||(e[42]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Date",-1)),ee(t("input",{"onUpdate:modelValue":e[22]||(e[22]=a=>se.value=a),onChange:lt,type:"date",class:"w-full rounded-md border-gray-300 shadow-sm"},null,544),[[je,se.value]])])])]),t("div",La,[e[48]||(e[48]=t("h3",{class:"text-lg font-medium leading-6 text-gray-900 mb-4"},"Daily Summary",-1)),t("div",Pa,[t("div",null,[e[43]||(e[43]=t("div",{class:"text-gray-500"},"ðŸ•’ Time In Hours",-1)),t("div",Ba,r(U(H.value.workSeconds)),1)]),t("div",null,[e[44]||(e[44]=t("div",{class:"text-gray-500"},"â˜• Total Breaks",-1)),t("div",Ua,r(U(H.value.breakSeconds)),1)]),t("div",null,[e[45]||(e[45]=t("div",{class:"text-gray-500"},"ðŸ“‹ Entries",-1)),t("div",Oa,r(H.value.tasksCount),1)]),t("div",null,[e[46]||(e[46]=t("div",{class:"text-gray-500"},"â° Status",-1)),t("div",{class:P(["font-semibold",{"text-green-700":H.value.status==="Perfect","text-yellow-700":H.value.status==="Late","text-gray-700":H.value.status==="No Entry"}])},r(H.value.status),3)]),t("div",null,[e[47]||(e[47]=t("div",{class:"text-gray-500"},"âš¡ Overtime",-1)),t("div",ja,r(U(H.value.overtimeSeconds)),1)])])]),t("div",Ha,[t("div",Wa,[t("table",Fa,[e[50]||(e[50]=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Task"),t("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Start Time"),t("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"End Time"),t("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Duration"),t("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Break Duration"),t("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Notes")])],-1)),t("tbody",Ra,[(d(!0),i(O,null,F(L.value,(a,y)=>(d(),i("tr",{key:y},[t("td",Va,r(a.name),1),t("td",za,r(me(a.start)),1),t("td",Aa,r(me(a.end)),1),t("td",qa,r(U(a.durationSeconds)),1),t("td",Ya,r(U(a.breakDurationSeconds||0)),1),t("td",Ga,r(a.notes||"-"),1)]))),128)),L.value.length===0&&!De.value?(d(),i("tr",Ka,[...e[49]||(e[49]=[t("td",{colspan:"6",class:"px-4 py-4 text-center text-sm text-gray-500"},"No entries for selected day",-1)])])):f("",!0)])])]),De.value?(d(),i("div",Za,[...e[51]||(e[51]=[t("div",{class:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600"},null,-1),t("p",{class:"mt-2 text-sm text-gray-500"},"Loading...",-1)])])):f("",!0)])])):f("",!0)]),He.value?(d(),i("div",Ja,[t("div",Qa,[t("div",Xa,[e[52]||(e[52]=t("h4",{class:"text-md font-semibold"},"Daily Logs",-1)),t("button",{onClick:e[23]||(e[23]=a=>He.value=!1),class:"rounded-md bg-gray-100 px-2 py-1 text-xs hover:bg-gray-200"},"Close")]),t("div",eo,[Be.value.length===0?(d(),i("div",to,"No entry today.")):(d(),i("div",so,[t("div",ao,[t("div",oo,[e[53]||(e[53]=t("div",{class:"text-xs font-medium text-gray-500 uppercase tracking-wide"},"Total Work Hours",-1)),t("div",no,r(U(we.value)),1)]),t("div",lo,[e[54]||(e[54]=t("div",{class:"text-xs font-medium text-gray-500 uppercase tracking-wide"},"Total Task Hours",-1)),t("div",ro,r(U(We.value)),1)])]),t("div",io,[t("table",uo,[e[55]||(e[55]=t("thead",{class:"bg-gray-50 sticky top-0"},[t("tr",null,[t("th",{class:"px-4 py-2 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Task"),t("th",{class:"px-4 py-2 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Start Time"),t("th",{class:"px-4 py-2 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"End Time"),t("th",{class:"px-4 py-2 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Duration"),t("th",{class:"px-4 py-2 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Break Duration"),t("th",{class:"px-4 py-2 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Notes")])],-1)),t("tbody",co,[(d(!0),i(O,null,F(Be.value,(a,y)=>(d(),i("tr",{key:y},[t("td",mo,r(a.name),1),t("td",po,r(me(a.start)),1),t("td",vo,r(me(a.end)),1),t("td",go,r(U(a.durationSeconds)),1),t("td",xo,r(U(a.breakDurationSeconds||0)),1),t("td",yo,r(a.notes||"-"),1)]))),128))])])])]))])])])):f("",!0),ye.value?(d(),i("div",fo,[t("div",ho,[t("div",ko,[e[56]||(e[56]=t("h4",{class:"text-md font-semibold text-gray-900"},"Sync ClickUp Spaces",-1)),t("button",{onClick:Mt,disabled:z.value&&((u=p.value)==null?void 0:u.status)==="syncing",class:"rounded-md bg-gray-100 px-2 py-1 text-xs hover:bg-gray-200 disabled:opacity-50"},"Cancel",8,bo)]),t("div",_o,[p.value?(d(),i("div",wo,[t("div",So,[t("div",To,[t("span",Do," Space "+r(p.value.current)+" of "+r(p.value.total),1),t("span",Mo,r(Math.round(p.value.current/p.value.total*100))+"% ",1)]),t("div",Co,[t("div",{class:"bg-indigo-600 h-2 rounded-full transition-all duration-300",style:ss({width:`${p.value.current/p.value.total*100}%`})},null,4)])]),t("div",{class:P(["rounded-md border p-4 space-y-3",{"border-blue-200 bg-blue-50":p.value.status==="checking","border-green-200 bg-green-50":p.value.status==="completed","border-yellow-200 bg-yellow-50":p.value.status==="skipped","border-red-200 bg-red-50":p.value.status==="error","border-indigo-200 bg-indigo-50":p.value.status==="syncing"}])},[t("div",No,[p.value.status==="checking"||p.value.status==="syncing"?(d(),i("span",$o)):p.value.status==="completed"?(d(),i("span",Io,"âœ“")):p.value.status==="skipped"?(d(),i("span",Eo,"âŠ˜")):p.value.status==="error"?(d(),i("span",Lo,"âœ—")):f("",!0),t("h5",Po,r(p.value.spaceName),1)]),p.value.status==="checking"&&((v=E.value)==null?void 0:v.is_member)===!0?(d(),i("div",Bo,[e[57]||(e[57]=t("p",{class:"text-sm text-gray-700"},"You are a member of this space. Would you like to sync tasks from it?",-1)),t("div",{class:"flex gap-2"},[t("button",{onClick:Tt,class:"flex-1 rounded-md bg-indigo-600 px-3 py-2 text-xs font-semibold text-white hover:bg-indigo-700"}," Yes, Sync This Space "),t("button",{onClick:Dt,class:"flex-1 rounded-md bg-gray-200 px-3 py-2 text-xs font-medium text-gray-700 hover:bg-gray-300"}," Skip ")])])):p.value.status==="checking"&&((k=E.value)==null?void 0:k.is_member)===!1?(d(),i("div",Uo," You are not a member of this space. Skipping... ")):p.value.status==="syncing"?(d(),i("div",Oo," Syncing tasks from this space... ")):p.value.status==="completed"&&p.value.result?(d(),i("div",jo,[e[58]||(e[58]=t("div",{class:"font-medium text-green-700"},"Sync completed!",-1)),t("div",Ho," Created: "+r(((M=p.value.result.summary)==null?void 0:M.created)||0)+", Updated: "+r(((x=p.value.result.summary)==null?void 0:x.updated)||0)+", Unchanged: "+r(((T=p.value.result.summary)==null?void 0:T.unchanged)||0),1)])):p.value.status==="skipped"?(d(),i("div",Wo," This space was skipped. ")):p.value.status==="error"?(d(),i("div",Fo," An error occurred while processing this space. ")):f("",!0)],2)])):f("",!0),_.value.length>0?(d(),i("div",Ro,[e[59]||(e[59]=t("h6",{class:"text-xs font-medium text-gray-600 mb-2"},"Completed Spaces:",-1)),t("div",Vo,[(d(!0),i(O,null,F(_.value,(a,y)=>{var $,X,G,V,pe,le;return d(),i("div",{key:y,class:"flex items-center justify-between p-2 rounded bg-gray-50"},[t("span",zo,r(a.name),1),t("span",{class:P(["px-2 py-0.5 rounded text-xs font-medium",{"bg-green-100 text-green-700":($=a.result)==null?void 0:$.ok,"bg-yellow-100 text-yellow-700":(X=a.result)==null?void 0:X.skipped,"bg-red-100 text-red-700":!((G=a.result)!=null&&G.ok)&&!((V=a.result)!=null&&V.skipped)}])},r((pe=a.result)!=null&&pe.ok?"Synced":(le=a.result)!=null&&le.skipped?"Skipped":"Error"),3)])}),128))])])):f("",!0),!p.value&&z.value?(d(),i("div",Ao,[...e[60]||(e[60]=[t("span",{class:"h-3 w-3 rounded-full border-2 border-gray-300 border-t-indigo-600 animate-spin"},null,-1),t("span",null,"Initializing space sync...",-1)])])):f("",!0)])])])):f("",!0),Fe.value&&N.value?(d(),i("div",qo,[t("div",Yo,[t("div",{class:"flex items-center justify-between border-b px-4 py-3"},[e[61]||(e[61]=t("h4",{class:"text-md font-semibold"},"ClickUp Sync Summary",-1)),t("button",{onClick:_t,class:"rounded-md bg-gray-100 px-2 py-1 text-xs hover:bg-gray-200"},"Close")]),t("div",Go,[t("div",Ko,[e[63]||(e[63]=t("p",null,"Latest sync completed successfully.",-1)),N.value.sources.length?(d(),i("p",Zo,[e[62]||(e[62]=Ue(" Sources: ",-1)),t("span",Jo,r(N.value.sources.join(", ")),1)])):f("",!0)]),t("div",Qo,[t("div",Xo,[e[64]||(e[64]=t("div",{class:"text-xs uppercase tracking-wide text-indigo-600"},"Total Processed",-1)),t("div",en,r(N.value.summary.total),1)]),t("div",tn,[e[65]||(e[65]=t("div",{class:"text-xs uppercase tracking-wide text-green-600"},"Created",-1)),t("div",sn,r(N.value.summary.created),1)]),t("div",an,[e[66]||(e[66]=t("div",{class:"text-xs uppercase tracking-wide text-blue-600"},"Updated",-1)),t("div",on,r(N.value.summary.updated),1)]),t("div",nn,[e[67]||(e[67]=t("div",{class:"text-xs uppercase tracking-wide text-gray-600"},"No Changes",-1)),t("div",ln,r(N.value.summary.unchanged),1)]),t("div",rn,[e[68]||(e[68]=t("div",{class:"text-xs uppercase tracking-wide text-amber-600"},"Skipped",-1)),t("div",dn,r(N.value.summary.skipped),1)])]),N.value.created.length?(d(),i("div",un,[e[69]||(e[69]=t("h5",{class:"text-sm font-semibold text-gray-900"},"New tasks",-1)),t("ul",cn,[(d(!0),i(O,null,F(N.value.created,a=>(d(),i("li",{key:"created-"+a.id,class:"rounded-md border border-green-200 bg-green-50 px-3 py-2"},[t("div",mn,[t("span",pn,r(a.title),1),t("span",vn,r(rt(a.due_date)),1)]),t("div",gn,[a.status?(d(),i("span",xn,"Status: "+r(a.status),1)):f("",!0),a.priority?(d(),i("span",yn,"Priority: "+r(a.priority),1)):f("",!0)])]))),128))])])):f("",!0),N.value.updated.length?(d(),i("div",fn,[e[70]||(e[70]=t("h5",{class:"text-sm font-semibold text-gray-900"},"Updated tasks",-1)),t("ul",hn,[(d(!0),i(O,null,F(N.value.updated,a=>(d(),i("li",{key:"updated-"+a.id,class:"rounded-md border border-blue-200 bg-blue-50 px-3 py-2"},[t("div",kn,[t("span",bn,r(a.title),1),t("span",_n,r(rt(a.due_date)),1)]),t("div",wn,[a.status?(d(),i("span",Sn,"Status: "+r(a.status),1)):f("",!0),a.priority?(d(),i("span",Tn,"Priority: "+r(a.priority),1)):f("",!0)])]))),128))])])):f("",!0),N.value.skipped.length?(d(),i("div",Dn,[e[71]||(e[71]=t("h5",{class:"text-sm font-semibold text-gray-900"},"Skipped items",-1)),t("ul",Mn,[(d(!0),i(O,null,F(N.value.skipped,a=>(d(),i("li",{key:"skipped-"+a.id,class:"rounded-md border border-amber-200 bg-amber-50 px-3 py-2 text-xs text-amber-900"},[t("div",Cn,[t("span",Nn,r(a.id),1),t("span",$n,r(a.reason),1)])]))),128))])])):f("",!0)])])])):f("",!0),Se.value?(d(),i("div",In,[t("div",En,[t("div",Ln,[e[72]||(e[72]=t("h4",{class:"text-md font-semibold"},"Task Details",-1)),t("button",{onClick:e[24]||(e[24]=a=>Se.value=!1),class:"rounded-md bg-gray-100 px-2 py-1 text-xs hover:bg-gray-200"},"Close")]),B.value?(d(),i("div",Pn,[t("div",Bn,[t("h2",Un,r((g=B.value.task)==null?void 0:g.title),1),t("div",On,[(h=B.value.task)!=null&&h.status?(d(),i("span",jn,[e[73]||(e[73]=t("span",{class:"text-gray-600"},"Status:",-1)),dt(B.value.task.status)?(d(),i("span",{key:0,class:P(["inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-semibold ml-1",it(B.value.task.status)])},r(B.value.task.status),3)):(d(),i("span",Hn,r(B.value.task.status),1))])):f("",!0),(w=B.value.clickup)!=null&&w.url?(d(),i("span",Wn,[t("a",{href:B.value.clickup.url,target:"_blank",class:"text-indigo-600 hover:underline text-sm font-medium"},"Open in ClickUp â†’",8,Fn)])):f("",!0)])]),(b=B.value.clickup)!=null&&b.text_content?(d(),i("div",Rn,[t("div",{innerHTML:Kt(B.value.clickup.text_content),class:"prose prose-sm max-w-none"},null,8,Vn)])):(d(),i("div",zn," No additional details available. "))])):f("",!0)])])):f("",!0)])]}),_:1})],64))}});export{Kn as default};
