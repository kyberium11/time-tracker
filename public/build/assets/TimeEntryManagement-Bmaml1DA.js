import{d as W,r as i,q as X,o as Z,c as n,a as P,u as tt,h as et,w as z,b as e,e as g,f as d,t as o,g as m,j as p,F as A,i as q,v as lt,k as T}from"./app-BGG5F7c0.js";import{_ as st}from"./AuthenticatedLayout.vue_vue_type_script_setup_true_lang-C2Tn9Vac.js";import{a as U}from"./api-CBfwtZYY.js";const at={class:"py-12"},ot={class:"mx-auto max-w-7xl sm:px-6 lg:px-8"},nt={key:0,class:"mb-4 rounded-md bg-green-50 p-4"},dt={class:"flex"},it={class:"ml-3"},rt={class:"text-sm font-medium text-green-800"},ut={key:1,class:"mb-4 rounded-md bg-red-50 p-4"},mt={class:"flex"},ct={class:"ml-3"},gt={class:"text-sm font-medium text-red-800"},pt={class:"overflow-hidden bg-white shadow sm:rounded-lg"},vt={class:"p-6"},xt={class:"mb-6 grid grid-cols-1 gap-4 md:grid-cols-4"},bt=["value"],ft={class:"overflow-x-auto"},yt={class:"min-w-full divide-y divide-gray-200"},kt={class:"divide-y divide-gray-200 bg-white"},wt={key:0},_t={key:1},ht={class:"whitespace-nowrap px-6 py-4 text-sm text-gray-900"},Dt={class:"whitespace-nowrap px-6 py-4 text-sm text-gray-900"},St={class:"whitespace-nowrap px-6 py-4 text-sm text-gray-900"},Ct={class:"whitespace-nowrap px-6 py-4 text-sm text-gray-900"},Tt={class:"whitespace-nowrap px-6 py-4 text-sm text-gray-900"},Ut={class:"whitespace-nowrap px-6 py-4 text-sm text-gray-900"},Et={class:"whitespace-nowrap px-6 py-4 text-sm font-medium text-gray-900"},Mt={class:"whitespace-nowrap px-6 py-4 text-sm font-medium"},Vt=["onClick"],Ft=["onClick"],$t={key:0,class:"mt-4 flex items-center justify-between"},Nt={class:"text-sm text-gray-700"},At={class:"flex gap-2"},It=["disabled"],jt=["disabled"],Lt={key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50"},Ot={class:"w-full max-w-2xl rounded-lg bg-white p-6 shadow-xl"},Bt={key:0,class:"mb-4 rounded-md bg-red-50 p-4"},Ht={class:"text-sm font-medium text-red-800"},Pt={key:1,class:"space-y-4"},zt={key:1,class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50"},qt={class:"w-full max-w-md rounded-lg bg-white p-6 shadow-xl"},Yt={key:0,class:"mb-4 rounded-md bg-red-50 p-4"},Gt={class:"text-sm font-medium text-red-800"},Jt={key:1,class:"mb-4 rounded-md bg-gray-50 p-4"},Kt={class:"text-sm text-gray-700"},Zt=W({__name:"TimeEntryManagement",setup(Qt){const w=i([]),E=i(!1),a=i(null),M=i(!1),V=i(!1),c=i(null),r=i(null),v=i(null),F=i(new Date().toISOString().split("T")[0]),$=i(new Date().toISOString().split("T")[0]),_=i(null),k=i([]),x=i(1),h=i(50),D=i(0),b=async()=>{var l,t;E.value=!0,r.value=null;try{const u={page:x.value,per_page:h.value,date_from:F.value,date_to:$.value};_.value&&(u.user_id=_.value);const s=await U.get("/admin/time-entries",{params:u});w.value=s.data.data||[],D.value=s.data.total||0}catch(u){r.value=((t=(l=u.response)==null?void 0:l.data)==null?void 0:t.message)||"Failed to load time entries",w.value=[]}finally{E.value=!1}},Y=async()=>{var l;try{const t=await U.get("/admin/users",{params:{per_page:1e3}});(l=t.data)!=null&&l.data?k.value=t.data.data:Array.isArray(t.data)?k.value=t.data:k.value=[]}catch(t){console.error("Failed to load users",t),k.value=[]}},f=l=>{if(!l)return"";const t=new Date(l),u=t.getFullYear(),s=String(t.getMonth()+1).padStart(2,"0"),S=String(t.getDate()).padStart(2,"0"),C=String(t.getHours()).padStart(2,"0"),N=String(t.getMinutes()).padStart(2,"0");return`${u}-${s}-${S}T${C}:${N}`},G=l=>{a.value={...l,clock_in:l.clock_in?f(l.clock_in):null,clock_out:l.clock_out?f(l.clock_out):null,break_start:l.break_start?f(l.break_start):null,break_end:l.break_end?f(l.break_end):null,lunch_start:l.lunch_start?f(l.lunch_start):null,lunch_end:l.lunch_end?f(l.lunch_end):null},M.value=!0},I=()=>{a.value=null,M.value=!1,r.value=null,v.value=null},y=l=>l?new Date(l).toISOString():null,J=async()=>{var l,t;if(a.value){r.value=null,v.value=null;try{await U.put(`/admin/time-entries/${a.value.id}`,{date:a.value.date,clock_in:y(a.value.clock_in),clock_out:y(a.value.clock_out),break_start:y(a.value.break_start),break_end:y(a.value.break_end),lunch_start:y(a.value.lunch_start),lunch_end:y(a.value.lunch_end),task_id:a.value.task_id}),v.value="Time entry updated successfully and synced to ClickUp",I(),await b(),setTimeout(()=>{v.value=null},3e3)}catch(u){r.value=((t=(l=u.response)==null?void 0:l.data)==null?void 0:t.message)||"Failed to update time entry"}}},K=l=>{c.value=l,V.value=!0},j=()=>{c.value=null,V.value=!1,r.value=null},Q=async()=>{var l,t;if(c.value){r.value=null;try{await U.delete(`/admin/time-entries/${c.value.id}`),v.value="Time entry deleted successfully and synced to ClickUp",j(),await b(),setTimeout(()=>{v.value=null},3e3)}catch(u){r.value=((t=(l=u.response)==null?void 0:l.data)==null?void 0:t.message)||"Failed to delete time entry"}}},L=l=>new Date(l).toLocaleDateString("en-US",{year:"numeric",month:"2-digit",day:"2-digit"}),O=l=>l?new Date(l).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",second:"2-digit"}):"--",B=l=>{if(l==null)return"0.00h";const t=typeof l=="string"?parseFloat(l):l;return isNaN(t)?"0.00h":`${t.toFixed(2)}h`},H=X(()=>Math.ceil(D.value/h.value)),R=()=>{x.value=1,b()};return Z(()=>{Y(),b()}),(l,t)=>(d(),n(A,null,[P(tt(et),{title:"Time Entry Management"}),P(st,null,{header:z(()=>[...t[12]||(t[12]=[e("h2",{class:"text-xl font-semibold leading-tight text-gray-800"}," Time Entry Management ",-1)])]),default:z(()=>{var u;return[e("div",at,[e("div",ot,[v.value?(d(),n("div",nt,[e("div",dt,[e("div",it,[e("p",rt,o(v.value),1)])])])):g("",!0),r.value?(d(),n("div",ut,[e("div",mt,[e("div",ct,[e("p",gt,o(r.value),1)])])])):g("",!0),e("div",pt,[e("div",vt,[e("div",xt,[e("div",null,[t[13]||(t[13]=e("label",{class:"block text-sm font-medium text-gray-700"},"Date From",-1)),m(e("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>F.value=s),type:"date",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},null,512),[[p,F.value]])]),e("div",null,[t[14]||(t[14]=e("label",{class:"block text-sm font-medium text-gray-700"},"Date To",-1)),m(e("input",{"onUpdate:modelValue":t[1]||(t[1]=s=>$.value=s),type:"date",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},null,512),[[p,$.value]])]),e("div",null,[t[16]||(t[16]=e("label",{class:"block text-sm font-medium text-gray-700"},"User",-1)),m(e("select",{"onUpdate:modelValue":t[2]||(t[2]=s=>_.value=s),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},[t[15]||(t[15]=e("option",{value:null},"All Users",-1)),(d(!0),n(A,null,q(k.value,s=>(d(),n("option",{key:s.id,value:s.id},o(s.name)+" ("+o(s.email)+") ",9,bt))),128))],512),[[lt,_.value]])]),e("div",{class:"flex items-end"},[e("button",{onClick:R,class:"w-full rounded-md bg-indigo-600 px-4 py-2 text-sm font-medium text-white hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2"}," Apply Filters ")])]),e("div",ft,[e("table",yt,[t[19]||(t[19]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"}," ID "),e("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"}," User "),e("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"}," Date "),e("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"}," Task "),e("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"}," Clock In "),e("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"}," Clock Out "),e("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"}," Total Hours "),e("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"}," Actions ")])],-1)),e("tbody",kt,[E.value?(d(),n("tr",wt,[...t[17]||(t[17]=[e("td",{colspan:"8",class:"px-6 py-4 text-center"},[e("div",{class:"inline-block h-8 w-8 animate-spin rounded-full border-4 border-solid border-indigo-600 border-r-transparent"})],-1)])])):w.value.length===0?(d(),n("tr",_t,[...t[18]||(t[18]=[e("td",{colspan:"8",class:"px-6 py-4 text-center text-sm text-gray-500"}," No time entries found ",-1)])])):(d(!0),n(A,{key:2},q(w.value,s=>{var S,C;return d(),n("tr",{key:s.id},[e("td",ht,o(s.id),1),e("td",Dt,o(((S=s.user)==null?void 0:S.name)||"N/A"),1),e("td",St,o(L(s.date)),1),e("td",Ct,o(((C=s.task)==null?void 0:C.name)||"N/A"),1),e("td",Tt,o(O(s.clock_in)),1),e("td",Ut,o(O(s.clock_out)),1),e("td",Et,o(B(s.total_hours)),1),e("td",Mt,[e("button",{onClick:N=>G(s),class:"mr-2 text-indigo-600 hover:text-indigo-900"}," Edit ",8,Vt),e("button",{onClick:N=>K(s),class:"text-red-600 hover:text-red-900"}," Delete ",8,Ft)])])}),128))])])]),H.value>1?(d(),n("div",$t,[e("div",Nt," Showing "+o((x.value-1)*h.value+1)+" to "+o(Math.min(x.value*h.value,D.value))+" of "+o(D.value)+" results ",1),e("div",At,[e("button",{onClick:t[3]||(t[3]=s=>{x.value--,b()}),disabled:x.value===1,class:"rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50 disabled:opacity-50"}," Previous ",8,It),e("button",{onClick:t[4]||(t[4]=s=>{x.value++,b()}),disabled:x.value>=H.value,class:"rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50 disabled:opacity-50"}," Next ",8,jt)])])):g("",!0)])])])]),M.value?(d(),n("div",Lt,[e("div",Ot,[t[27]||(t[27]=e("h3",{class:"mb-4 text-lg font-medium text-gray-900"},"Edit Time Entry",-1)),r.value?(d(),n("div",Bt,[e("p",Ht,o(r.value),1)])):g("",!0),a.value?(d(),n("div",Pt,[e("div",null,[t[20]||(t[20]=e("label",{class:"block text-sm font-medium text-gray-700"},"Date",-1)),m(e("input",{"onUpdate:modelValue":t[5]||(t[5]=s=>a.value.date=s),type:"date",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},null,512),[[p,a.value.date]])]),e("div",null,[t[21]||(t[21]=e("label",{class:"block text-sm font-medium text-gray-700"},"Clock In",-1)),m(e("input",{"onUpdate:modelValue":t[6]||(t[6]=s=>a.value.clock_in=s),type:"datetime-local",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},null,512),[[p,a.value.clock_in]])]),e("div",null,[t[22]||(t[22]=e("label",{class:"block text-sm font-medium text-gray-700"},"Clock Out",-1)),m(e("input",{"onUpdate:modelValue":t[7]||(t[7]=s=>a.value.clock_out=s),type:"datetime-local",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},null,512),[[p,a.value.clock_out]])]),e("div",null,[t[23]||(t[23]=e("label",{class:"block text-sm font-medium text-gray-700"},"Break Start",-1)),m(e("input",{"onUpdate:modelValue":t[8]||(t[8]=s=>a.value.break_start=s),type:"datetime-local",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},null,512),[[p,a.value.break_start]])]),e("div",null,[t[24]||(t[24]=e("label",{class:"block text-sm font-medium text-gray-700"},"Break End",-1)),m(e("input",{"onUpdate:modelValue":t[9]||(t[9]=s=>a.value.break_end=s),type:"datetime-local",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},null,512),[[p,a.value.break_end]])]),e("div",null,[t[25]||(t[25]=e("label",{class:"block text-sm font-medium text-gray-700"},"Lunch Start",-1)),m(e("input",{"onUpdate:modelValue":t[10]||(t[10]=s=>a.value.lunch_start=s),type:"datetime-local",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},null,512),[[p,a.value.lunch_start]])]),e("div",null,[t[26]||(t[26]=e("label",{class:"block text-sm font-medium text-gray-700"},"Lunch End",-1)),m(e("input",{"onUpdate:modelValue":t[11]||(t[11]=s=>a.value.lunch_end=s),type:"datetime-local",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},null,512),[[p,a.value.lunch_end]])])])):g("",!0),e("div",{class:"mt-6 flex justify-end gap-3"},[e("button",{onClick:I,class:"rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50"}," Cancel "),e("button",{onClick:J,class:"rounded-md bg-indigo-600 px-4 py-2 text-sm font-medium text-white hover:bg-indigo-700"}," Save Changes ")])])])):g("",!0),V.value?(d(),n("div",zt,[e("div",qt,[t[35]||(t[35]=e("h3",{class:"mb-4 text-lg font-medium text-gray-900"},"Delete Time Entry",-1)),r.value?(d(),n("div",Yt,[e("p",Gt,o(r.value),1)])):g("",!0),t[36]||(t[36]=e("p",{class:"mb-4 text-sm text-gray-600"}," Are you sure you want to delete this time entry? This action cannot be undone and will sync to ClickUp. ",-1)),c.value?(d(),n("div",Jt,[e("p",Kt,[t[28]||(t[28]=e("strong",null,"ID:",-1)),T(" "+o(c.value.id),1),t[29]||(t[29]=e("br",null,null,-1)),t[30]||(t[30]=e("strong",null,"User:",-1)),T(" "+o(((u=c.value.user)==null?void 0:u.name)||"N/A"),1),t[31]||(t[31]=e("br",null,null,-1)),t[32]||(t[32]=e("strong",null,"Date:",-1)),T(" "+o(L(c.value.date)),1),t[33]||(t[33]=e("br",null,null,-1)),t[34]||(t[34]=e("strong",null,"Total Hours:",-1)),T(" "+o(B(c.value.total_hours)),1)])])):g("",!0),e("div",{class:"flex justify-end gap-3"},[e("button",{onClick:j,class:"rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50"}," Cancel "),e("button",{onClick:Q,class:"rounded-md bg-red-600 px-4 py-2 text-sm font-medium text-white hover:bg-red-700"}," Delete ")])])])):g("",!0)]}),_:1})],64))}});export{Zt as default};
