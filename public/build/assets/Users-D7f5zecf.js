import{d as A,r as f,o as T,a as m,b as k,u as D,h as F,e as U,f as e,i as j,g as u,F as b,k as C,t as r,n as B,s as P,l as n,m as p,v as E}from"./app-rL9m2D0P.js";import{_ as R}from"./AuthenticatedLayout.vue_vue_type_script_setup_true_lang-BAgQ4HDK.js";import{a as c}from"./api-D1uBjruB.js";const z={class:"flex items-center justify-between"},I={class:"py-12"},L={class:"mx-auto max-w-7xl sm:px-6 lg:px-8"},G={class:"overflow-hidden bg-white shadow sm:rounded-lg"},H={class:"min-w-full divide-y divide-gray-200"},J={class:"divide-y divide-gray-200 bg-white"},K={class:"whitespace-nowrap px-6 py-4 text-sm font-medium text-gray-900"},O={class:"whitespace-nowrap px-6 py-4 text-sm text-gray-500"},Q={class:"whitespace-nowrap px-6 py-4 text-sm text-gray-500"},W=["value","onChange"],X=["selected"],Y=["selected"],Z=["selected"],ee={class:"whitespace-nowrap px-6 py-4 text-sm text-gray-500"},te={class:"whitespace-nowrap px-6 py-4 text-sm text-gray-500"},se={class:"whitespace-nowrap px-6 py-4 text-sm text-gray-500"},ae={key:0},oe={key:1,class:"text-gray-400 italic"},le={class:"whitespace-nowrap px-6 py-4 text-sm font-medium"},ie=["onClick"],de=["onClick"],re=["onClick"],ne={key:0,class:"fixed inset-0 z-50 overflow-y-auto","aria-labelledby":"modal-title",role:"dialog","aria-modal":"true"},me={class:"flex min-h-screen items-end justify-center px-4 pt-4 pb-20 text-center sm:block sm:p-0"},ue={class:"relative inline-block transform overflow-hidden rounded-lg bg-white text-left align-bottom shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-lg"},pe={class:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4"},ce={class:"text-lg font-medium leading-6 text-gray-900 mb-4"},xe={class:"mb-4"},fe={class:"mb-4"},ge={class:"mb-4"},ye={class:"block text-sm font-medium text-gray-700"},ve=["required"],be={class:"mb-4"},he=["required"],we={class:"mb-4"},_e={class:"mb-4"},ke=["value"],Ue={class:"mb-4 grid grid-cols-2 gap-4"},Ce={class:"mb-4"},Ne=A({__name:"Users",setup(Ee){const h=f([]),x=f(!1),y=f(!1),d=f(null),o=f({name:"",email:"",password:"",password_confirmation:"",role:"employee",team_id:null,shift_start:"",shift_end:"",clickup_user_id:""}),w=f([]),V=async()=>{try{const a=await c.get("/admin/teams");w.value=a.data}catch(a){console.error("Error fetching teams:",a)}},g=async()=>{x.value=!0;try{const a=await c.get("/admin/users");h.value=a.data.data}catch(a){console.error("Error fetching users:",a),alert("Failed to fetch users")}finally{x.value=!1}},_=a=>{var t;a?(d.value=a,o.value={name:a.name,email:a.email,password:"",password_confirmation:"",role:a.role,team_id:((t=a.team)==null?void 0:t.id)||null,shift_start:a.shift_start||"",shift_end:a.shift_end||"",clickup_user_id:a.clickup_user_id||""}):(d.value=null,o.value={name:"",email:"",password:"",password_confirmation:"",role:"employee",team_id:null,shift_start:"",shift_end:"",clickup_user_id:""}),y.value=!0},v=()=>{y.value=!1,d.value=null},M=async()=>{var a,t;x.value=!0;try{d.value?await c.put(`/admin/users/${d.value.id}`,o.value):await c.post("/admin/users",o.value),await g(),v(),o.value={name:"",email:"",password:"",password_confirmation:"",role:"employee",team_id:null,shift_start:"",shift_end:"",clickup_user_id:""}}catch(s){alert(((t=(a=s.response)==null?void 0:a.data)==null?void 0:t.message)||"Error saving user")}finally{x.value=!1}},$=async a=>{var t,s;if(confirm("Are you sure you want to delete this user?"))try{await c.delete(`/admin/users/${a}`),await g()}catch(i){alert(((s=(t=i.response)==null?void 0:t.data)==null?void 0:s.message)||"Error deleting user")}},N=async(a,t)=>{var s,i;if(confirm(`Are you sure you want to change this user's role to ${t}?`)){x.value=!0;try{await c.put(`/admin/users/${a}`,{role:t}),await g()}catch(l){alert(((i=(s=l.response)==null?void 0:s.data)==null?void 0:i.message)||"Error updating role")}finally{x.value=!1}}},S=async a=>{var t,s,i;try{const q=((t=(await c.post(`/admin/users/${a}/clickup/sync-tasks`)).data)==null?void 0:t.count)??0;alert(`Synced ${q} task(s) from ClickUp.`)}catch(l){alert(((i=(s=l==null?void 0:l.response)==null?void 0:s.data)==null?void 0:i.error)||"Failed to sync tasks")}};return T(()=>{g(),V()}),(a,t)=>(u(),m(b,null,[k(D(F),{title:"User Management"}),k(R,null,{header:U(()=>[e("div",z,[t[10]||(t[10]=e("h2",{class:"text-xl font-semibold leading-tight text-gray-800"}," User Management ",-1)),e("button",{onClick:t[0]||(t[0]=s=>_()),class:"rounded-md bg-indigo-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-indigo-500"}," Add User ")])]),default:U(()=>[e("div",I,[e("div",L,[e("div",G,[e("table",H,[t[11]||(t[11]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"}," Name "),e("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"}," Email "),e("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"}," Role "),e("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"}," ClickUp User ID "),e("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"}," Team "),e("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"}," Shift Time "),e("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"}," Actions ")])],-1)),e("tbody",J,[(u(!0),m(b,null,C(h.value,s=>{var i;return u(),m("tr",{key:s.id},[e("td",K,r(s.name),1),e("td",O,r(s.email),1),e("td",Q,[e("select",{value:s.role,onChange:l=>N(s.id,l.target.value),class:B(["inline-flex rounded-full px-3 py-1 text-xs font-semibold leading-5 border-0 cursor-pointer",s.role==="admin"?"bg-purple-600 text-white hover:bg-purple-700":s.role==="manager"?"bg-blue-600 text-white hover:bg-blue-700":"bg-green-600 text-white hover:bg-green-700"])},[e("option",{value:"admin",selected:s.role==="admin"},"Admin",8,X),e("option",{value:"manager",selected:s.role==="manager"},"Manager",8,Y),e("option",{value:"employee",selected:s.role==="employee"},"Employee",8,Z)],42,W)]),e("td",ee,r(s.clickup_user_id||"â€”"),1),e("td",te,r(((i=s.team)==null?void 0:i.name)||"No team"),1),e("td",se,[s.shift_start&&s.shift_end?(u(),m("span",ae,r(s.shift_start)+" - "+r(s.shift_end),1)):(u(),m("span",oe,"Not set"))]),e("td",le,[e("button",{onClick:l=>_(s),class:"rounded-md bg-indigo-600 px-3 py-1.5 text-xs font-semibold text-white shadow-sm hover:bg-indigo-500"}," Edit ",8,ie),e("button",{onClick:l=>S(s.id),class:"ml-2 rounded-md bg-green-600 px-3 py-1.5 text-xs font-semibold text-white shadow-sm hover:bg-green-500"}," Refresh Tasks ",8,de),e("button",{onClick:l=>$(s.id),class:"ml-2 rounded-md bg-red-600 px-3 py-1.5 text-xs font-semibold text-white shadow-sm hover:bg-red-500"}," Delete ",8,re)])])}),128))])])])])]),y.value?(u(),m("div",ne,[e("div",me,[e("div",{class:"fixed inset-0 transition-opacity bg-gray-500 bg-opacity-75","aria-hidden":"true",onClick:v}),e("div",ue,[e("div",pe,[e("h3",ce,r(d.value?"Edit User":"Add User"),1),e("form",{onSubmit:P(M,["prevent"])},[e("div",xe,[t[12]||(t[12]=e("label",{class:"block text-sm font-medium text-gray-700"},"Name",-1)),n(e("input",{"onUpdate:modelValue":t[1]||(t[1]=s=>o.value.name=s),type:"text",required:"",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm"},null,512),[[p,o.value.name]])]),e("div",fe,[t[13]||(t[13]=e("label",{class:"block text-sm font-medium text-gray-700"},"Email",-1)),n(e("input",{"onUpdate:modelValue":t[2]||(t[2]=s=>o.value.email=s),type:"email",required:"",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm"},null,512),[[p,o.value.email]])]),e("div",ge,[e("label",ye,r(d.value?"New Password (leave blank to keep current)":"Password"),1),n(e("input",{"onUpdate:modelValue":t[3]||(t[3]=s=>o.value.password=s),type:"password",required:!d.value,class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm"},null,8,ve),[[p,o.value.password]])]),e("div",be,[t[14]||(t[14]=e("label",{class:"block text-sm font-medium text-gray-700"},"Confirm Password",-1)),n(e("input",{"onUpdate:modelValue":t[4]||(t[4]=s=>o.value.password_confirmation=s),type:"password",required:!d.value,class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm"},null,8,he),[[p,o.value.password_confirmation]])]),e("div",we,[t[16]||(t[16]=e("label",{class:"block text-sm font-medium text-gray-700"},"Role",-1)),n(e("select",{"onUpdate:modelValue":t[5]||(t[5]=s=>o.value.role=s),required:"",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm"},[...t[15]||(t[15]=[e("option",{value:"admin"},"Admin",-1),e("option",{value:"manager"},"Manager",-1),e("option",{value:"employee"},"Employee",-1)])],512),[[E,o.value.role]])]),e("div",_e,[t[18]||(t[18]=e("label",{class:"block text-sm font-medium text-gray-700"},"Team",-1)),n(e("select",{"onUpdate:modelValue":t[6]||(t[6]=s=>o.value.team_id=s),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm"},[t[17]||(t[17]=e("option",{value:null},"No team",-1)),(u(!0),m(b,null,C(w.value,s=>(u(),m("option",{key:s.id,value:s.id},r(s.name),9,ke))),128))],512),[[E,o.value.team_id]])]),e("div",Ue,[e("div",null,[t[19]||(t[19]=e("label",{class:"block text-sm font-medium text-gray-700"},"Shift Start",-1)),n(e("input",{"onUpdate:modelValue":t[7]||(t[7]=s=>o.value.shift_start=s),type:"time",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm"},null,512),[[p,o.value.shift_start]])]),e("div",null,[t[20]||(t[20]=e("label",{class:"block text-sm font-medium text-gray-700"},"Shift End",-1)),n(e("input",{"onUpdate:modelValue":t[8]||(t[8]=s=>o.value.shift_end=s),type:"time",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm"},null,512),[[p,o.value.shift_end]])])]),e("div",Ce,[t[21]||(t[21]=e("label",{class:"block text-sm font-medium text-gray-700"},"ClickUp User ID",-1)),n(e("input",{"onUpdate:modelValue":t[9]||(t[9]=s=>o.value.clickup_user_id=s),type:"text",placeholder:"e.g. 12345678",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm"},null,512),[[p,o.value.clickup_user_id]]),t[22]||(t[22]=e("p",{class:"mt-1 text-xs text-gray-500"},"Use the member's numeric id from ClickUp.",-1))]),e("div",{class:"flex justify-end space-x-3"},[e("button",{type:"button",onClick:v,class:"rounded-md border border-gray-300 px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50"}," Cancel "),t[23]||(t[23]=e("button",{type:"submit",class:"rounded-md bg-indigo-600 px-4 py-2 text-sm font-medium text-white hover:bg-indigo-700"}," Save ",-1))])],32)])])])])):j("",!0)]),_:1})],64))}});export{Ne as default};
