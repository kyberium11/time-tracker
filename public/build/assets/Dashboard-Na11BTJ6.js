import{d as Yt,r as c,c as C,o as Kt,A as Zt,B as Gt,a as r,b as ut,u as Jt,h as Qt,e as ct,f as t,g as y,i as d,n as A,t as i,j as Pe,l as ee,F as B,k as j,v as Ue,m as je,C as Xt}from"./app-DGG22J6u.js";import{_ as es}from"./AuthenticatedLayout.vue_vue_type_script_setup_true_lang-o3aitYFc.js";import{a as T}from"./api-N73WtNp-.js";const ts={class:"py-12"},ss={class:"mx-auto max-w-[95%] sm:px-6 lg:px-8"},as={key:0,class:"border-b border-gray-200 mb-6"},os={class:"-mb-px flex space-x-8"},ns={key:1},ls={class:"mb-6 grid gap-4 md:grid-cols-3"},is={class:"overflow-hidden bg-white shadow sm:rounded-lg"},rs={class:"px-4 py-5 sm:p-6"},ds={class:"mt-2 text-3xl font-bold text-gray-900"},us={class:"text-xs text-gray-500"},cs={key:0,class:"mt-2"},ms={class:"text-sm text-gray-600"},ps={class:"font-semibold"},vs={class:"mt-4 flex flex-wrap gap-2"},gs=["disabled"],xs=["disabled"],ys={class:"overflow-hidden bg-white shadow sm:rounded-lg"},fs={class:"px-4 py-5 sm:p-6"},hs={key:0,class:"mt-2"},ks={class:"text-2xl font-bold text-gray-900 mt-1"},bs={key:0,class:"text-sm font-normal text-gray-500"},_s={class:"mt-3"},ws=["disabled"],Ss={key:1,class:"mt-2"},Ts={class:"flex items-center gap-2 w-full"},Ds=["value"],Ms=["disabled"],Cs={key:0,class:"text-sm text-gray-500 mt-2"},Ns={class:"overflow-hidden bg-white shadow sm:rounded-lg"},$s={class:"px-4 py-5 sm:p-6"},Es={class:"mt-2 text-3xl font-bold text-gray-900"},Is={class:"mb-6 overflow-hidden bg-white shadow sm:rounded-lg"},Ls={class:"px-4 py-5 sm:p-6"},Bs={class:"flex items-center justify-between mb-3"},Ps={class:"flex items-center gap-2"},Us=["disabled"],js={key:0,class:"h-3 w-3 rounded-full border-2 border-white border-t-transparent animate-spin"},Hs=["value"],Ws={class:"overflow-x-auto"},Os={class:"min-w-full divide-y divide-gray-200"},As={class:"divide-y divide-gray-200 bg-white"},Fs={class:"whitespace-nowrap px-6 py-4 text-sm text-indigo-600"},Rs=["onClick"],Vs={class:"whitespace-nowrap px-6 py-4 text-sm text-gray-900"},qs={class:"whitespace-nowrap px-6 py-4 text-sm text-gray-900"},zs={class:"whitespace-nowrap px-6 py-4 text-sm"},Ys={key:1,class:"text-sm text-gray-700"},Ks={class:"whitespace-nowrap px-6 py-4 text-sm text-gray-900"},Zs={class:"whitespace-nowrap px-6 py-4 text-sm text-gray-500"},Gs={class:"whitespace-nowrap px-6 py-4 text-sm"},Js={class:"whitespace-nowrap px-6 py-4 text-sm text-gray-900"},Qs={class:"flex items-center space-x-2"},Xs=["onClick","disabled","aria-label"],ea={key:0,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",class:"h-4 w-4"},ta={key:1,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",class:"h-4 w-4"},sa=["value","onChange"],aa=["value"],oa={key:0,value:"complete"},na={key:1,value:"done"},la={class:"flex items-center justify-between px-6 py-3 text-sm text-gray-600"},ia={class:"space-x-2"},ra=["disabled"],da=["disabled"],ua={class:"overflow-hidden bg-white shadow sm:rounded-lg"},ca={class:"px-4 py-5 sm:p-6"},ma={key:0,class:"text-center py-8 text-gray-500"},pa={key:1,class:"overflow-x-auto"},va={class:"min-w-full divide-y divide-gray-200"},ga={class:"divide-y divide-gray-200"},xa={class:"px-4 py-4 text-sm text-gray-900"},ya={class:"px-4 py-4 text-sm text-gray-500"},fa={class:"px-4 py-4 text-sm text-gray-500"},ha={class:"px-4 py-4 text-sm text-gray-900 font-semibold"},ka={class:"px-4 py-4 text-sm text-gray-500"},ba={class:"px-4 py-4 text-sm text-gray-500"},_a={key:0,class:"mb-6 overflow-hidden bg-white shadow sm:rounded-lg"},wa={class:"px-4 py-5 sm:p-6"},Sa={class:"flex items-center justify-between mb-4"},Ta=["disabled"],Da={class:"overflow-x-auto"},Ma={class:"min-w-full divide-y divide-gray-200"},Ca={class:"divide-y divide-gray-200 bg-white"},Na={class:"px-4 py-4 text-sm text-gray-900"},$a={class:"px-4 py-4 text-sm text-gray-500"},Ea={class:"px-4 py-4 text-sm text-gray-500"},Ia={class:"px-4 py-4 text-sm text-gray-500"},La={key:0},Ba={key:2,class:"space-y-6"},Pa={class:"bg-white shadow rounded-lg p-4"},Ua={class:"grid gap-4 sm:grid-cols-2"},ja={class:"bg-white shadow rounded-lg p-5"},Ha={class:"grid gap-4 sm:grid-cols-3 lg:grid-cols-5 text-sm"},Wa={class:"font-semibold"},Oa={class:"font-semibold"},Aa={class:"font-semibold"},Fa={class:"font-semibold"},Ra={class:"bg-white shadow rounded-lg"},Va={class:"overflow-x-auto"},qa={class:"min-w-full divide-y divide-gray-200"},za={class:"divide-y divide-gray-200"},Ya={class:"px-4 py-4 text-sm text-gray-900"},Ka={class:"px-4 py-4 text-sm text-gray-500"},Za={class:"px-4 py-4 text-sm text-gray-500"},Ga={class:"px-4 py-4 text-sm text-gray-900 font-semibold"},Ja={class:"px-4 py-4 text-sm text-gray-500"},Qa={class:"px-4 py-4 text-sm text-gray-500"},Xa={key:0},eo={key:0,class:"text-center py-8"},to={key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50"},so={class:"w-full max-w-4xl rounded-lg bg-white shadow-lg flex flex-col max-h-[90vh]"},ao={class:"flex items-center justify-between border-b px-4 py-3 flex-shrink-0"},oo={class:"p-4 flex flex-col flex-1 min-h-0"},no={key:0,class:"text-gray-500 text-sm"},lo={key:1,class:"flex flex-col flex-1 min-h-0"},io={class:"mb-4 flex gap-6 flex-shrink-0"},ro={class:"flex-1 bg-gray-50 rounded-lg p-4"},uo={class:"text-2xl font-bold text-gray-900 mt-1"},co={class:"flex-1 bg-gray-50 rounded-lg p-4"},mo={class:"text-2xl font-bold text-gray-900 mt-1"},po={class:"flex-1 overflow-y-auto border border-gray-200 rounded-lg"},vo={class:"min-w-full divide-y divide-gray-200"},go={class:"divide-y divide-gray-200 bg-white"},xo={class:"px-4 py-2 text-sm text-gray-900"},yo={class:"px-4 py-2 text-sm text-gray-700"},fo={class:"px-4 py-2 text-sm text-gray-700"},ho={class:"px-4 py-2 text-sm text-gray-700 font-semibold"},ko={class:"px-4 py-2 text-sm text-gray-700"},bo={class:"px-4 py-2 text-sm text-gray-700"},_o={key:1,class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50"},wo={class:"w-full max-w-lg rounded-lg bg-white shadow-xl"},So={class:"flex items-center justify-between border-b px-5 py-3"},To=["disabled"],Do={class:"p-5 space-y-4 text-sm text-gray-700"},Mo={key:0},Co={class:"mb-4"},No={class:"flex items-center justify-between mb-2"},$o={class:"text-xs font-medium text-gray-600"},Eo={class:"text-xs text-gray-500"},Io={class:"w-full bg-gray-200 rounded-full h-2"},Lo={class:"flex items-center gap-2"},Bo={key:0,class:"h-4 w-4 rounded-full border-2 border-current border-t-transparent animate-spin"},Po={key:1,class:"text-green-600 text-lg"},Uo={key:2,class:"text-yellow-600 text-lg"},jo={key:3,class:"text-red-600 text-lg"},Ho={class:"font-semibold text-gray-900"},Wo={key:0,class:"space-y-3"},Oo={key:1,class:"text-sm text-gray-600"},Ao={key:2,class:"text-sm text-gray-600"},Fo={key:3,class:"text-sm space-y-1"},Ro={class:"text-xs text-gray-600"},Vo={key:4,class:"text-sm text-yellow-700"},qo={key:5,class:"text-sm text-red-700"},zo={key:1,class:"mt-4"},Yo={class:"max-h-32 overflow-y-auto space-y-1 text-xs"},Ko={class:"text-gray-700"},Zo={key:2,class:"flex items-center gap-2 text-sm text-gray-500"},Go={key:2,class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50"},Jo={class:"w-full max-w-3xl rounded-lg bg-white shadow-lg"},Qo={class:"p-5 text-sm text-gray-700 space-y-5"},Xo={class:"space-y-1"},en={key:0,class:"text-xs text-gray-500"},tn={class:"font-medium text-gray-600"},sn={class:"grid gap-3 sm:grid-cols-2 lg:grid-cols-5"},an={class:"rounded-md bg-indigo-50 px-4 py-3"},on={class:"text-xl font-semibold text-indigo-900"},nn={class:"rounded-md bg-green-50 px-4 py-3"},ln={class:"text-xl font-semibold text-green-900"},rn={class:"rounded-md bg-blue-50 px-4 py-3"},dn={class:"text-xl font-semibold text-blue-900"},un={class:"rounded-md bg-gray-100 px-4 py-3"},cn={class:"text-xl font-semibold text-gray-900"},mn={class:"rounded-md bg-amber-50 px-4 py-3"},pn={class:"text-xl font-semibold text-amber-900"},vn={key:0,class:"space-y-2"},gn={class:"max-h-48 overflow-y-auto space-y-2 pr-1"},xn={class:"flex items-start justify-between gap-3"},yn={class:"font-medium text-green-900 leading-tight"},fn={class:"text-xs text-green-700 whitespace-nowrap"},hn={class:"mt-1 flex flex-wrap gap-3 text-xs text-green-800"},kn={key:0},bn={key:1},_n={key:1,class:"space-y-2"},wn={class:"max-h-48 overflow-y-auto space-y-2 pr-1"},Sn={class:"flex items-start justify-between gap-3"},Tn={class:"font-medium text-blue-900 leading-tight"},Dn={class:"text-xs text-blue-700 whitespace-nowrap"},Mn={class:"mt-1 flex flex-wrap gap-3 text-xs text-blue-800"},Cn={key:0},Nn={key:1},$n={key:2,class:"space-y-2"},En={class:"max-h-40 overflow-y-auto space-y-1 pr-1"},In={class:"flex items-start justify-between gap-3"},Ln={class:"font-medium leading-tight"},Bn={class:"text-amber-700"},Pn={key:3,class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50"},Un={class:"w-full max-w-3xl max-h-[90vh] rounded-lg bg-white shadow-lg flex flex-col"},jn={class:"flex items-center justify-between border-b px-4 py-3 flex-shrink-0"},Hn={key:0,class:"p-6 text-sm text-gray-700 overflow-y-auto flex-1"},Wn={class:"mb-4 pb-4 border-b"},On={class:"font-semibold text-lg text-gray-900 mb-2"},An={class:"flex items-center gap-3 flex-wrap"},Fn={key:0,class:"text-sm"},Rn={key:1,class:"ml-1 text-gray-700"},Vn={key:1},qn=["href"],zn={key:0,class:"task-content"},Yn=["innerHTML"],Kn={key:1,class:"text-gray-500 italic"},Xn=Yt({__name:"Dashboard",setup(Zn){const g=c(null),N=c(!1),ie=c(""),te=c(new Date),Y=c("employee"),K=c([]),ve=c(null),M=c(null),He=c(!1),Ze=c([]),ke=c(0),We=c(0),Z=c([]),P=c(null),be=c(!1),Oe=c(!1),_e=c(!1),$=c(null),ge=c(!1);c(!1),c(null);const Ge=c([]),mt=c([]),pt=C(()=>Ge.value.length>0);C(()=>pt.value&&mt.value.length===Ge.value.length);const V=c(!1),H=c(0),re=c([]),I=c(null),m=c(null),_=c([]),de=c("dashboard"),se=c(""),Je=c([]),we=c(!1),W=c({workSeconds:0,breakSeconds:0,lunchSeconds:0,tasksCount:0,status:"No Entry",overtimeSeconds:0}),L=c([]),Ae=c(""),ae=c(1),xe=c(10),Se=c("all"),Te=C(()=>{const s=new Set;return(K.value||[]).forEach(e=>{const o=(e.status||"").toString().trim();o&&s.add(o)}),Array.from(s).sort((e,o)=>e.localeCompare(o))}),De=c("all"),Me=c(""),Ce=c(""),Fe=C(()=>{const s=Ae.value.trim().toLowerCase();let e=K.value;if(Se.value!=="all"){const o=Se.value.toLowerCase();e=e.filter(n=>(n.status||"").toLowerCase()===o)}if(De.value!=="all"){const o=De.value;e=e.filter(n=>(n.priority||"none").toLowerCase()===o)}if(Me.value){const o=new Date(Me.value).getTime();e=e.filter(n=>n.due_date?new Date(n.due_date).getTime()>=o:!1)}if(Ce.value){const o=new Date(Ce.value).getTime();e=e.filter(n=>n.due_date?new Date(n.due_date).getTime()<=o:!1)}return s?e.filter(o=>(o.title||"").toLowerCase().includes(s)):e}),Ne=C(()=>Math.max(1,Math.ceil(Fe.value.length/xe.value))),vt=C(()=>{const e=(Math.min(ae.value,Ne.value)-1)*xe.value;return Fe.value.slice(e,e+xe.value)}),G=s=>{const e=Math.max(1,Math.min(s,Ne.value));ae.value=e},$e=c([]),Ee=c(!1),Re=async()=>{var s;Ee.value=!0;try{const e=await T.get("/admin/analytics/activity-logs",{params:{limit:100}});$e.value=((s=e.data)==null?void 0:s.data)||[]}catch{$e.value=[]}finally{Ee.value=!1}};let Ve=null,ye=null;const Ie=c(!1),Le=c(!1),fe=c(!1),qe=c(!1),F=C(()=>{var s,e;return!!((s=g.value)!=null&&s.clock_in)&&!((e=g.value)!=null&&e.clock_out)}),O=C(()=>{var s,e;return!!((s=g.value)!=null&&s.break_start)&&!((e=g.value)!=null&&e.break_end)}),gt=C(()=>{var s,e;return((s=g.value)==null?void 0:s.lunch_start)&&!((e=g.value)!=null&&e.lunch_end)}),Be=C(()=>{const s=[];if(!g.value)return s;const e=g.value;if(e.clock_in&&e.clock_out){const o=Math.max(0,Math.floor((new Date(e.clock_out).getTime()-new Date(e.clock_in).getTime())/1e3)),n=e.break_start?new Date(e.break_start):null,l=e.break_end?new Date(e.break_end):null;let u=0;n&&l&&(u=Math.max(0,Math.floor((l.getTime()-n.getTime())/1e3)));const p=Math.max(0,o-u);s.push({name:"Work Hours",start:e.clock_in,end:e.clock_out,durationSeconds:p,breakDurationSeconds:u,notes:"-"})}if(e.break_start&&e.break_end){const o=Math.max(0,Math.floor((new Date(e.break_end).getTime()-new Date(e.break_start).getTime())/1e3));s.push({name:"Break",start:e.break_start,end:e.break_end,durationSeconds:o,breakDurationSeconds:o,notes:"-"})}return Z.value.forEach(o=>{var n;if(o.clock_in&&o.clock_out){const l=Math.max(0,Math.floor((new Date(o.clock_out).getTime()-new Date(o.clock_in).getTime())/1e3));s.push({name:((n=o.task)==null?void 0:n.title)||`Task #${o.task_id}`,start:o.clock_in,end:o.clock_out,durationSeconds:l,breakDurationSeconds:0,notes:"-"})}}),s.sort((o,n)=>{const l=new Date(o.start).getTime(),u=new Date(n.start).getTime();return(isNaN(u)?0:u)-(isNaN(l)?0:l)}),s}),xt=async()=>{"Notification"in window&&Notification.permission==="default"&&await Notification.requestPermission()},ze=(s,e,o)=>{"Notification"in window&&Notification.permission==="granted"&&new Notification(s,{body:e,icon:"/favicon.ico",badge:"/favicon.ico",tag:"time-tracker-notification",requireInteraction:!1,...o})},yt=()=>{var s;if(O.value&&((s=g.value)!=null&&s.break_start)){const e=new Date(g.value.break_start),o=te.value,n=Math.floor((o.getTime()-e.getTime())/1e3),l=Math.floor(n/60);l>=13&&!Ie.value&&(ze("Break Reminder","You're approaching the 15-minute break limit. Please end your break soon.",{tag:"break-13-min"}),Ie.value=!0),l>=15&&!Le.value&&(ze("Break Over Limit","You've exceeded the 15-minute break limit. Please end your break now.",{tag:"break-15-min",requireInteraction:!0}),Le.value=!0)}else O.value||(Ie.value=!1,Le.value=!1)},Qe=async()=>{var s,e;if(!(qe.value||fe.value)&&!F.value&&(s=g.value)!=null&&s.clock_out&&(e=g.value)!=null&&e.clock_in){const o=new Date(g.value.clock_in),n=new Date(g.value.clock_out);Math.floor((n.getTime()-o.getTime())/1e3)/3600>=1&&!g.value.lunch_start&&!fe.value&&(ze("Lunch Reminder","You've been working for 1 hour without taking lunch. Please remember to take your lunch break.",{tag:"lunch-reminder",requireInteraction:!0}),fe.value=!0,qe.value=!0)}},ft=()=>{ye&&clearInterval(ye),ye=window.setInterval(()=>{yt(),fe.value||Qe()},6e4)},Xe=s=>{if(F.value)return s.preventDefault(),s.returnValue="",""};Kt(async()=>{const s=new Date;se.value=s.toISOString().split("T")[0],await xt(),he(),kt(),J(),Ke(),ue(),Ve=window.setInterval(()=>{te.value=new Date},1e3),ft(),window.addEventListener("beforeunload",Xe)}),Zt(()=>{Ve&&window.clearInterval(Ve),ye&&clearInterval(ye),window.removeEventListener("beforeunload",Xe)});const he=async()=>{try{const s=await T.get("/time-entries/current");g.value=s.data,Wt(),O.value||(Ie.value=!1,Le.value=!1);const e=new Date().toISOString().split("T")[0];se.value!==e&&(fe.value=!1,qe.value=!1)}catch(s){g.value=null,ie.value="No entry today",console.error("Error fetching current entry:",s)}},ht=Gt(),kt=async()=>{var e,o;const s=(e=ht.props.auth)==null?void 0:e.user;if(s!=null&&s.role){const n=s.role;["admin","manager","employee","developer"].includes(n)&&(Y.value=n)}else try{const l=(((o=(await T.get("/admin/users")).data)==null?void 0:o.data)||[]).find(u=>(u==null?void 0:u.id)&&(u==null?void 0:u.email));if(l!=null&&l.role){const u=l.role;["admin","manager","employee","developer"].includes(u)&&(Y.value=u)}}catch{}Y.value==="admin"&&(await Re(),setInterval(()=>{Re()},5e3))},J=async()=>{try{const s=await T.get("/my/tasks");K.value=s.data}catch{}},bt=()=>{Oe.value=!1,$.value=null},_t=async()=>{_e.value||V.value||await wt()},wt=async()=>{var s,e,o;if(!V.value){V.value=!0,_.value=[],H.value=0,m.value=null;try{const n=await T.get("/my/clickup/configured-spaces");if(re.value=((s=n.data)==null?void 0:s.space_ids)||[],re.value.length===0){alert("No ClickUp spaces configured. Please set CLICKUP_SPACE_IDS in your environment variables."),V.value=!1;return}ge.value=!0,await oe()}catch(n){alert(((o=(e=n==null?void 0:n.response)==null?void 0:e.data)==null?void 0:o.error)||"Failed to start space sync"),V.value=!1,ge.value=!1}}},oe=async()=>{var e,o;if(H.value>=re.value.length){V.value=!1,ge.value=!1,await J(),re.value.length,_.value.filter(n=>{var l;return(l=n.result)==null?void 0:l.ok}).length,_.value.filter(n=>{var l,u;return!((l=n.result)!=null&&l.ok)&&((u=n.result)==null?void 0:u.skipped)}).length,$.value={summary:{total:_.value.reduce((n,l)=>{var u,p;return n+(((p=(u=l.result)==null?void 0:u.summary)==null?void 0:p.total)||0)},0),created:_.value.reduce((n,l)=>{var u,p;return n+(((p=(u=l.result)==null?void 0:u.summary)==null?void 0:p.created)||0)},0),updated:_.value.reduce((n,l)=>{var u,p;return n+(((p=(u=l.result)==null?void 0:u.summary)==null?void 0:p.updated)||0)},0),unchanged:_.value.reduce((n,l)=>{var u,p;return n+(((p=(u=l.result)==null?void 0:u.summary)==null?void 0:p.unchanged)||0)},0),skipped:_.value.reduce((n,l)=>{var u,p;return n+(((p=(u=l.result)==null?void 0:u.summary)==null?void 0:p.skipped)||0)},0)},created:_.value.flatMap(n=>{var l;return((l=n.result)==null?void 0:l.created)||[]}),updated:_.value.flatMap(n=>{var l;return((l=n.result)==null?void 0:l.updated)||[]}),skipped:_.value.flatMap(n=>{var l;return((l=n.result)==null?void 0:l.skipped)||[]}),sources:_.value.map(n=>`Space: ${n.name} (${n.space_id})`)},Oe.value=!0;return}const s=re.value[H.value];m.value={current:H.value+1,total:re.value.length,spaceName:"Loading...",status:"checking"};try{const n=await T.get(`/my/clickup/space/${s}/info`);if(I.value=n.data,!I.value){m.value.status="error",_.value.push({space_id:s,name:"Unknown",result:{ok:!1,error:"Failed to get space info"}}),H.value++,setTimeout(()=>{oe()},1e3);return}if(m.value={...m.value,spaceName:I.value.name},!I.value.is_member){m.value.status="skipped",_.value.push({space_id:s,name:I.value.name,result:{ok:!1,skipped:!0,reason:"User is not a member of this space"}}),H.value++,setTimeout(()=>{oe()},1e3);return}m.value.status="checking"}catch(n){m.value.status="error",_.value.push({space_id:s,name:"Unknown",result:{ok:!1,error:((o=(e=n==null?void 0:n.response)==null?void 0:e.data)==null?void 0:o.error)||"Failed to get space info"}}),H.value++,setTimeout(()=>{oe()},1e3)}},St=async()=>{var e,o;if(!I.value||!m.value)return;const s=I.value.space_id;if(s){m.value.status="syncing";try{const n=await T.post(`/my/clickup/space/${s}/sync`);m.value.status="completed",m.value.result=n.data,_.value.push({space_id:s,name:I.value.name,result:n.data}),H.value++,setTimeout(()=>{oe()},1500)}catch(n){m.value.status="error",_.value.push({space_id:s,name:I.value.name,result:{ok:!1,error:((o=(e=n==null?void 0:n.response)==null?void 0:e.data)==null?void 0:o.error)||"Failed to sync space"}}),H.value++,setTimeout(()=>{oe()},1500)}}},Tt=()=>{if(!I.value)return;const s=I.value.space_id;s&&(_.value.push({space_id:s,name:I.value.name,result:{ok:!1,skipped:!0,reason:"User skipped this space"}}),H.value++,oe())},Dt=()=>{V.value=!1,ge.value=!1,H.value=0,m.value=null,I.value=null,_.value=[]},et=async()=>{try{await Ot()}catch{}},Mt=async()=>{try{await At()}catch{}},Ct=async()=>{try{await Ft()}catch{}},Ye=async()=>{try{await Rt()}catch{}},Ke=async()=>{try{const s=await T.get("/tasks/today-entries");Z.value=s.data||[];const e=(Z.value||[]).find(o=>o.clock_in&&!o.clock_out);M.value=e?e.task_id:null}catch{Z.value=[]}},tt=async s=>{try{const e=await T.get(`/tasks/${s}/sync`);P.value=e.data,be.value=!0}catch{be.value=!1}},Nt=async()=>{if(O.value){await Ye();return}F.value?await Mt():await et()},$t=async()=>{if(M.value){alert("Pause or stop the running task first.");return}O.value?await Ye():(F.value||await et(),await Ct())},q=s=>s<10?`0${s}`:`${s}`,Et=C(()=>{var s;return F.value&&((s=g.value)!=null&&s.clock_in)?new Date(g.value.clock_in):null}),It=C(()=>{var s;return O.value&&((s=g.value)!=null&&s.break_start)?new Date(g.value.break_start):null}),Lt=C(()=>{const s=Z.value.find(e=>e.clock_in&&!e.clock_out);return s?new Date(s.clock_in):null}),Bt=C(()=>{const s=Et.value;if(!s)return"00:00:00";const e=te.value.getTime()-s.getTime(),o=Math.max(0,Math.floor(e/1e3)),n=Math.floor(o/3600),l=Math.floor(o%3600/60),u=o%60;return`${q(n)}:${q(l)}:${q(u)}`}),Pt=C(()=>{const s=It.value;if(!s)return"00:00:00";const e=te.value.getTime()-s.getTime(),o=Math.max(0,Math.floor(e/1e3)),n=Math.floor(o/3600),l=Math.floor(o%3600/60),u=o%60;return`${q(n)}:${q(l)}:${q(u)}`}),Ut=C(()=>{const s=Lt.value;if(!s)return"00:00:00";const e=te.value.getTime()-s.getTime(),o=Math.max(0,Math.floor(e/1e3)),n=Math.floor(o/3600),l=Math.floor(o%3600/60),u=o%60;return`${q(n)}:${q(l)}:${q(u)}`}),jt=C(()=>{var o,n;let s=ke.value||0;if(F.value&&((o=g.value)!=null&&o.clock_in)&&!((n=g.value)!=null&&n.clock_out)){const l=new Date(g.value.clock_in),u=te.value,p=Math.max(0,Math.floor((u.getTime()-l.getTime())/1e3));let k=0;if(g.value.break_start)if(g.value.break_end){const S=new Date(g.value.break_start),v=new Date(g.value.break_end);k=Math.max(0,Math.floor((v.getTime()-S.getTime())/1e3))}else{const S=new Date(g.value.break_start);k=Math.max(0,Math.floor((u.getTime()-S.getTime())/1e3))}let D=0;if(g.value.lunch_start)if(g.value.lunch_end){const S=new Date(g.value.lunch_start),v=new Date(g.value.lunch_end);D=Math.max(0,Math.floor((v.getTime()-S.getTime())/1e3))}else{const S=new Date(g.value.lunch_start);D=Math.max(0,Math.floor((u.getTime()-S.getTime())/1e3))}const f=Math.max(0,p-k-D);s+=f}return Z.value&&Z.value.length>0&&Z.value.forEach(l=>{if(l.clock_in&&!l.clock_out){const u=new Date(l.clock_in),p=te.value,k=Math.max(0,Math.floor((p.getTime()-u.getTime())/1e3));s+=k}}),(s/3600).toFixed(2)}),Ht=async()=>{await ue(),He.value=!0},ue=async()=>{var s;try{const e=new Date().toISOString().split("T")[0],n=((s=(await T.get("/my/time-entries",{params:{start_date:e,end_date:e}})).data)==null?void 0:s.entries)||[],l=[];let u=0,p=0,k=0;const D=new Date;n.forEach(f=>{const S=f.clock_in_formatted||f.clock_in,v=f.clock_out_formatted||f.clock_out,h=Q(f.clock_in),w=Q(f.clock_out);if(f.is_break||f.entry_type==="break"){if(!h)return;const x=!!w;let E=0;x&&w?(E=Math.max(0,Math.floor((w.getTime()-h.getTime())/1e3)),k+=E):E=Math.max(0,Math.floor((D.getTime()-h.getTime())/1e3)),l.push({name:"Break",start:S,end:x?v:null,durationSeconds:E,breakDurationSeconds:E,notes:x?"-":"In progress"});return}if(!h)return;const b=f.task&&(f.task.title||f.task.name),a=!!w;if(!b)if(a&&w){const x=Math.max(0,Math.floor((w.getTime()-h.getTime())/1e3)),E=Q(f.lunch_start),X=Q(f.lunch_end);let z=0;E&&X&&(z=Math.max(0,Math.floor((X.getTime()-E.getTime())/1e3)));const R=Math.max(0,x-z);u+=R,l.push({name:"Work Hours",start:S,end:v,durationSeconds:R,breakDurationSeconds:0,notes:"-"})}else{const x=Math.max(0,Math.floor((D.getTime()-h.getTime())/1e3));l.push({name:"Work Hours",start:S,end:null,durationSeconds:x,breakDurationSeconds:0,notes:"In progress"})}if(b){let x=0;a&&w?x=Math.max(0,Math.floor((w.getTime()-h.getTime())/1e3)):x=Math.max(0,Math.floor((D.getTime()-h.getTime())/1e3)),p+=x,l.push({name:f.task.title||f.task.name,start:S,end:a?v:null,durationSeconds:x,breakDurationSeconds:0,notes:a?"-":"In progress"})}}),l.sort((f,S)=>{const v=new Date(f.start).getTime(),h=new Date(S.start).getTime();return(isNaN(h)?0:h)-(isNaN(v)?0:v)}),Ze.value=l,ke.value=u,We.value=p}catch{Ze.value=[],ke.value=0,We.value=0}},Wt=()=>{!g.value||!g.value.clock_in?ie.value="Not clocked in":g.value.clock_out?ie.value="Clocked out":gt.value?ie.value="On lunch":O.value?ie.value="On break":ie.value="Clocked in"},Ot=async s=>{var e,o;N.value=!0;try{const n={};await T.post("/time-entries/clock-in",n),await he(),await J(),await ue()}catch(n){alert(((o=(e=n.response)==null?void 0:e.data)==null?void 0:o.message)||"Error clocking in")}finally{N.value=!1}},At=async()=>{var s,e;N.value=!0;try{if(M.value){alert("Pause or stop the running task first."),N.value=!1;return}await T.post("/time-entries/clock-out"),await he(),await J(),await ue(),setTimeout(()=>{Qe()},1e3)}catch(o){alert(((e=(s=o.response)==null?void 0:s.data)==null?void 0:e.message)||"Error clocking out")}finally{N.value=!1}},Ft=async()=>{var s,e;N.value=!0;try{await T.post("/time-entries/break-start"),await he(),await J(),await ue()}catch(o){alert(((e=(s=o.response)==null?void 0:s.data)==null?void 0:e.message)||"Error starting break")}finally{N.value=!1}},Rt=async()=>{var s,e;N.value=!0;try{await T.post("/time-entries/break-end"),await he(),await J(),await ue()}catch(o){alert(((e=(s=o.response)==null?void 0:s.data)==null?void 0:e.message)||"Error ending break")}finally{N.value=!1}},st=async s=>{var e,o;if(!F.value){alert("Please Time In first before starting a task.");return}if(O.value&&await Ye(),M.value&&M.value!==s)try{await T.post("/tasks/stop")}catch{}try{await T.post("/tasks/start",{task_id:s}),M.value=s,await Ke()}catch(n){alert(((o=(e=n==null?void 0:n.response)==null?void 0:e.data)==null?void 0:o.message)||"Failed to start task")}},at=async()=>{try{await T.post("/tasks/stop")}catch{}M.value=null,await Ke()},Vt=async(s,e)=>{var n,l;if(!e)return;if(!confirm(`Are you sure you want to set this task to "${e}"?`)){await J();return}N.value=!0;try{await T.post(`/tasks/${s}/status`,{status:e}),await J()}catch(u){alert(((l=(n=u==null?void 0:u.response)==null?void 0:n.data)==null?void 0:l.message)||"Failed to update task status")}finally{N.value=!1}},ot=async()=>{var s,e;if(se.value){we.value=!0;try{const o=await T.get("/my/time-entries",{params:{start_date:se.value,end_date:se.value}}),n=((s=o.data)==null?void 0:s.entries)||[];Je.value=n,L.value=[];let l=0,u=0,p=null,k=null;const D=new Date;n.forEach(v=>{const h=v.clock_in_formatted||v.clock_in,w=v.clock_out_formatted||v.clock_out,b=Q(v.clock_in),a=Q(v.clock_out);if(b&&(!p||b<p)&&(p=b,k=h),v.is_break||v.entry_type==="break"){if(!b)return;const pe=!!a;let le=0;pe&&a?(le=Math.max(0,Math.floor((a.getTime()-b.getTime())/1e3)),u+=le):le=Math.max(0,Math.floor((D.getTime()-b.getTime())/1e3)),L.value.push({name:"Break",start:h,end:pe?w:null,durationSeconds:le,breakDurationSeconds:le,notes:pe?"-":"In progress"});return}if(!b)return;const x=v.task&&(v.task.title||v.task.name),E=!!a;let X=0,z=0;E&&a?X=Math.max(0,Math.floor((a.getTime()-b.getTime())/1e3)):z=Math.max(0,Math.floor((D.getTime()-b.getTime())/1e3));const R=Q(v.lunch_start),me=Q(v.lunch_end);let ne=0;R&&me?ne=Math.max(0,Math.floor((me.getTime()-R.getTime())/1e3)):R&&!me&&(ne=Math.max(0,Math.floor((D.getTime()-R.getTime())/1e3)));const dt=E?Math.max(0,X-ne):Math.max(0,z-ne);if(x||(E&&a?L.value.push({name:"Work Hours",start:h,end:w,durationSeconds:dt,breakDurationSeconds:0,notes:"-"}):L.value.push({name:"Work Hours",start:h,end:null,durationSeconds:dt,breakDurationSeconds:0,notes:"In progress"})),x){const pe=v.task.title||v.task.name;if(E&&a){const le=Math.max(0,Math.floor((a.getTime()-b.getTime())/1e3));L.value.push({name:pe,start:h,end:w,durationSeconds:le,breakDurationSeconds:0,notes:"-"})}else L.value.push({name:pe,start:h,end:null,durationSeconds:z,breakDurationSeconds:0,notes:"In progress"})}}),L.value.sort((v,h)=>{const w=new Date(v.start).getTime(),b=new Date(h.start).getTime();return(isNaN(b)?0:b)-(isNaN(w)?0:w)});const f=L.value.filter(v=>v.name==="Work Hours").reduce((v,h)=>v+(h.durationSeconds||0),0),S=L.value.filter(v=>v.name==="Break").reduce((v,h)=>v+(h.durationSeconds||0),0);if((e=o.data)!=null&&e.daily_totals)W.value={workSeconds:o.data.daily_totals.work_seconds||0,breakSeconds:o.data.daily_totals.break_seconds||0,lunchSeconds:o.data.daily_totals.lunch_seconds||0,tasksCount:o.data.daily_totals.tasks_count||0,status:o.data.daily_totals.status||"No Entry",overtimeSeconds:o.data.daily_totals.overtime_seconds||0};else{const h=Math.max(0,f-28800);let w="No Entry";if(p){const b=(p.getUTCHours()+8)%24,a=p.getUTCMinutes();w=b<8||b===8&&a<=30?"Perfect":"Late"}W.value={workSeconds:f,breakSeconds:S,lunchSeconds:0,tasksCount:L.value.length,status:w,overtimeSeconds:h}}}catch(o){console.error("Error loading time entries",o),Je.value=[],L.value=[],W.value={workSeconds:0,breakSeconds:0,lunchSeconds:0,tasksCount:0,status:"No Entry",overtimeSeconds:0}}finally{we.value=!1}}},Q=s=>{if(!s)return null;const e=s.match(/^(\d{4})-(\d{2})-(\d{2})[ T](\d{2}):(\d{2})(?::(\d{2}))?/);if(e){const l=Number(e[1]),u=Number(e[2])-1,p=Number(e[3]),k=Number(e[4]),D=Number(e[5]),f=Number(e[6]||"0");return new Date(Date.UTC(l,u,p,k-8,D,f))}const o=s.includes("T")?s:s.replace(" ","T"),n=new Date(o);return isNaN(n.getTime())?null:n},ce=s=>{if(!s)return"--";try{const o=new Date(s);if(!isNaN(o.getTime()))return o.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!0,timeZone:"Asia/Manila"})}catch{}const e=s.match(/\b(\d{1,2}):(\d{2})(?::(\d{2}))?/);if(e){let o=parseInt(e[1],10);const n=e[2],l=o>=12?"PM":"AM";return o=o%12,o===0&&(o=12),`${o}:${n} ${l}`}return"--"},U=s=>{const e=typeof s=="number"&&isFinite(s)?Math.max(0,Math.floor(s)):0,o=Math.floor(e/3600),n=Math.floor(e%3600/60),l=e%60,u=p=>p<10?`0${p}`:`${p}`;return`${u(o)}:${u(n)}:${u(l)}`},nt=s=>{if(!s)return"--";const e=new Date(s);return isNaN(e.getTime())?s:e.toLocaleDateString("en-US",{month:"short",day:"2-digit",year:"numeric"})},lt=s=>{if(!s||s===0)return"--";const e=Math.floor(s/1e3);return U(e)},it=s=>{if(!s)return"";const e=s.toLowerCase().trim();return e==="to do"||e==="todo"?"text-gray-700":e.includes("complete")||e.includes("done")||e.includes("finished")?"bg-green-100 text-green-800":e.includes("progress")||e.includes("doing")||e.includes("in progress")||e.includes("working")?"bg-blue-100 text-blue-800":e.includes("pending")||e.includes("waiting")?"bg-yellow-100 text-yellow-800":e.includes("blocked")||e.includes("stuck")?"bg-red-100 text-red-800":e.includes("review")||e.includes("testing")?"bg-purple-100 text-purple-800":e.includes("cancel")||e.includes("closed")?"bg-gray-100 text-gray-800":"bg-indigo-100 text-indigo-800"},qt=s=>{if(!s)return"bg-gray-100 text-gray-800";const e=s.toLowerCase().trim();return e==="urgent"||e==="critical"?"bg-red-100 text-red-800":e==="high"?"bg-orange-100 text-orange-800":e==="normal"||e==="medium"?"bg-yellow-100 text-yellow-800":e==="low"?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"},rt=s=>{if(!s)return!1;const e=s.toLowerCase().trim();return e!=="to do"&&e!=="todo"},zt=s=>{if(!s)return"";const e=s.split(`
`),o=[];let n=!1,l=[];for(let p=0;p<e.length;p++){const k=e[p].trim();if(!k){n&&l.length>0&&(o.push(`<ul class="list-disc ml-6 mb-3 space-y-1">${l.join("")}</ul>`),l=[],n=!1),o.length>0&&!o[o.length-1].startsWith("<")&&o.push('</p><p class="mb-2">');continue}if(k.match(/^#{1,3}\s+/)){n&&l.length>0&&(o.push(`<ul class="list-disc ml-6 mb-3 space-y-1">${l.join("")}</ul>`),l=[],n=!1),k.startsWith("###")?o.push(`<h3 class="font-semibold text-gray-900 mt-4 mb-2 text-base">${k.replace(/^###\s+/,"")}</h3>`):k.startsWith("##")?o.push(`<h2 class="font-bold text-gray-900 mt-5 mb-3 text-lg">${k.replace(/^##\s+/,"")}</h2>`):k.startsWith("#")&&o.push(`<h1 class="font-bold text-gray-900 mt-6 mb-4 text-xl">${k.replace(/^#\s+/,"")}</h1>`);continue}if(k.match(/^[\-\*â€¢]\s+/)){n||(n=!0);const f=k.replace(/^[\-\*â€¢]\s+/,"").trim();l.push(`<li class="mb-1">${f}</li>`);continue}if(k.match(/^\d+\.\s+/)){n||(n=!0);const f=k.replace(/^\d+\.\s+/,"").trim();l.push(`<li class="mb-1 list-decimal">${f}</li>`);continue}n&&l.length>0&&(o.push(`<ul class="list-disc ml-6 mb-3 space-y-1">${l.join("")}</ul>`),l=[],n=!1);let D=k.replace(/\*\*(.+?)\*\*/g,'<strong class="font-semibold">$1</strong>').replace(/\*(.+?)\*/g,'<em class="italic">$1</em>');o.push(D)}n&&l.length>0&&o.push(`<ul class="list-disc ml-6 mb-3 space-y-1">${l.join("")}</ul>`);let u=o.join("<br>");return u.startsWith("<")||(u='<p class="mb-2">'+u),u.endsWith(">")||(u=u+"</p>"),u};return(s,e)=>(d(),r(B,null,[ut(Jt(Qt),{title:"Dashboard"}),ut(es,null,{header:ct(()=>[...e[23]||(e[23]=[t("h2",{class:"text-xl font-semibold leading-tight text-gray-800"}," Time Tracker Dashboard ",-1)])]),default:ct(()=>{var o,n,l,u,p,k,D,f,S,v,h,w,b;return[t("div",ts,[t("div",ss,[Y.value!=="admin"?(d(),r("div",as,[t("nav",os,[t("button",{onClick:e[0]||(e[0]=a=>de.value="dashboard"),class:A(["whitespace-nowrap border-b-2 py-4 px-1 text-sm font-medium",de.value==="dashboard"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700"])}," Dashboard ",2),t("button",{onClick:e[1]||(e[1]=a=>{de.value="time-entries",ot()}),class:A(["whitespace-nowrap border-b-2 py-4 px-1 text-sm font-medium",de.value==="time-entries"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700"])}," Time Entries ",2)])])):y("",!0),de.value==="dashboard"||Y.value==="admin"||Y.value==="developer"?(d(),r("div",ns,[t("div",ls,[t("div",is,[t("div",rs,[e[25]||(e[25]=t("h3",{class:"text-xs font-semibold uppercase tracking-wide text-gray-500"},"Work Day Timer",-1)),t("p",ds,i(Bt.value),1),t("p",us,i(F.value?"Working":"Idle"),1),O.value?(d(),r("div",cs,[t("p",ms,[e[24]||(e[24]=Pe("Break Timer: ",-1)),t("span",ps,i(Pt.value),1)])])):y("",!0),t("div",vs,[t("button",{onClick:Nt,disabled:N.value,class:A(["rounded-md px-3 py-1.5 text-xs font-semibold text-white",F.value?"bg-red-600 hover:bg-red-700":"bg-green-600 hover:bg-green-700"])},i(F.value?"Time Out":"Time In"),11,gs),t("button",{onClick:$t,disabled:N.value,class:A(["rounded-md px-3 py-1.5 text-xs font-semibold text-white",O.value?"bg-orange-600 hover:bg-orange-700":"bg-yellow-600 hover:bg-yellow-700"])},i(O.value?"Break Out":"Break In"),11,xs)])])]),t("div",ys,[t("div",fs,[e[27]||(e[27]=t("h3",{class:"text-xs font-semibold uppercase tracking-wide text-gray-500"},"Running Task",-1)),M.value?(d(),r("div",hs,[t("button",{onClick:e[2]||(e[2]=a=>tt(M.value)),class:"text-indigo-600 hover:underline text-sm"},i(((o=K.value.find(a=>a.id===M.value))==null?void 0:o.title)||"#"+M.value),1),t("p",ks,[Pe(i(Ut.value),1),(n=K.value.find(a=>a.id===M.value))!=null&&n.estimated_time?(d(),r("span",bs," / "+i(lt((l=K.value.find(a=>a.id===M.value))==null?void 0:l.estimated_time)),1)):y("",!0)]),t("div",_s,[t("button",{onClick:e[3]||(e[3]=a=>at()),disabled:N.value,class:"rounded-md bg-yellow-600 px-3 py-1.5 text-xs font-semibold text-white hover:bg-yellow-700"},"Pause",8,ws)])])):(d(),r("div",Ss,[t("div",Ts,[ee(t("select",{"onUpdate:modelValue":e[4]||(e[4]=a=>ve.value=a),class:"w-full rounded-md border-gray-300 text-sm shadow-sm"},[e[26]||(e[26]=t("option",{value:null},"Select a task",-1)),(d(!0),r(B,null,j(K.value,a=>(d(),r("option",{key:a.id,value:a.id},i(a.title),9,Ds))),128))],512),[[Ue,ve.value]]),t("button",{onClick:e[5]||(e[5]=a=>ve.value?st(ve.value):void 0),disabled:N.value||!ve.value,class:"rounded-md bg-green-600 px-3 py-1.5 text-xs font-semibold text-white hover:bg-green-700 disabled:opacity-50"},"Start",8,Ms)]),K.value.length?y("",!0):(d(),r("p",Cs,"No tasks available."))]))])]),t("div",Ns,[t("div",$s,[e[29]||(e[29]=t("h3",{class:"text-xs font-semibold uppercase tracking-wide text-gray-500"},"Daily Logs",-1)),t("p",Es,[Pe(i(jt.value),1),e[28]||(e[28]=t("span",{class:"text-sm font-normal text-gray-500"}," / 8 Hours",-1))]),t("div",{class:"mt-4 flex space-x-2"},[t("button",{onClick:Ht,class:"rounded-md bg-indigo-600 px-3 py-1.5 text-xs font-semibold text-white hover:bg-indigo-700"},"Daily Logs")])])])]),t("div",Is,[t("div",Ls,[t("div",Bs,[e[33]||(e[33]=t("h3",{class:"text-lg font-medium leading-6 text-gray-900"},"My Tasks",-1)),t("div",Ps,[t("button",{onClick:_t,disabled:_e.value,class:"rounded-md bg-green-600 px-3 py-1.5 text-xs font-semibold text-white hover:bg-green-700 disabled:opacity-60 disabled:cursor-not-allowed flex items-center gap-2"},[_e.value?(d(),r("span",js)):y("",!0),t("span",null,i(_e.value?"Syncingâ€¦":"Refresh from ClickUp"),1)],8,Us),ee(t("input",{"onUpdate:modelValue":e[6]||(e[6]=a=>Ae.value=a),onInput:e[7]||(e[7]=a=>G(1)),type:"text",placeholder:"Search tasks",class:"rounded-md border-gray-300 text-sm shadow-sm"},null,544),[[je,Ae.value]]),ee(t("select",{"onUpdate:modelValue":e[8]||(e[8]=a=>Se.value=a),onChange:e[9]||(e[9]=a=>G(1)),class:"rounded-md border-gray-300 text-sm shadow-sm"},[e[30]||(e[30]=t("option",{value:"all"},"All",-1)),(d(!0),r(B,null,j(Te.value,a=>(d(),r("option",{key:a,value:a},i(a),9,Hs))),128))],544),[[Ue,Se.value]]),ee(t("select",{"onUpdate:modelValue":e[10]||(e[10]=a=>De.value=a),onChange:e[11]||(e[11]=a=>G(1)),class:"rounded-md border-gray-300 text-sm shadow-sm"},[...e[31]||(e[31]=[t("option",{value:"all"},"All priorities",-1),t("option",{value:"urgent"},"Urgent",-1),t("option",{value:"high"},"High",-1),t("option",{value:"normal"},"Normal",-1),t("option",{value:"low"},"Low",-1),t("option",{value:"none"},"None",-1)])],544),[[Ue,De.value]]),ee(t("input",{"onUpdate:modelValue":e[12]||(e[12]=a=>Me.value=a),onChange:e[13]||(e[13]=a=>G(1)),type:"date",class:"rounded-md border-gray-300 text-sm shadow-sm"},null,544),[[je,Me.value]]),ee(t("input",{"onUpdate:modelValue":e[14]||(e[14]=a=>Ce.value=a),onChange:e[15]||(e[15]=a=>G(1)),type:"date",class:"rounded-md border-gray-300 text-sm shadow-sm"},null,544),[[je,Ce.value]]),ee(t("select",{"onUpdate:modelValue":e[16]||(e[16]=a=>xe.value=a),onChange:e[17]||(e[17]=a=>G(1)),class:"rounded-md border-gray-300 text-sm shadow-sm"},[...e[32]||(e[32]=[t("option",{value:5},"5",-1),t("option",{value:10},"10",-1),t("option",{value:20},"20",-1),t("option",{value:50},"50",-1)])],544),[[Ue,xe.value,void 0,{number:!0}]])])]),t("div",Ws,[t("table",Os,[e[37]||(e[37]=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Task"),t("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Campaign"),t("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Parent Task"),t("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Status"),t("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Due Date"),t("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Estimated Time"),t("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Priority"),t("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Actions")])],-1)),t("tbody",As,[(d(!0),r(B,null,j(vt.value,a=>(d(),r("tr",{key:a.id},[t("td",Fs,[t("button",{onClick:x=>tt(a.id),class:"hover:underline"},i(a.title),9,Rs)]),t("td",Vs,i(a.clickup_list_name||"--"),1),t("td",qs,i(a.parent_task_name||"N/A"),1),t("td",zs,[rt(a.status)?(d(),r("span",{key:0,class:A(["inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-semibold",it(a.status)])},i(a.status||"â€”"),3)):(d(),r("span",Ys,i(a.status||"â€”"),1))]),t("td",Ks,i(a.due_date?new Date(a.due_date).toLocaleDateString():"--"),1),t("td",Zs,i(lt(a.estimated_time)),1),t("td",Gs,[t("span",{class:A(["inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-semibold",qt(a.priority||null)])},i(a.priority||"None"),3)]),t("td",Js,[t("div",Qs,[t("button",{onClick:x=>M.value===a.id?at():st(a.id),disabled:N.value,class:A(["rounded-full p-2 text-white",M.value===a.id?"bg-yellow-600 hover:bg-yellow-700":"bg-green-600 hover:bg-green-700"]),"aria-label":M.value===a.id?"Pause":"Play"},[M.value!==a.id?(d(),r("svg",ea,[...e[34]||(e[34]=[t("path",{d:"M8 5v14l11-7z"},null,-1)])])):(d(),r("svg",ta,[...e[35]||(e[35]=[t("path",{d:"M6 5h4v14H6zM14 5h4v14h-4z"},null,-1)])]))],10,Xs),t("select",{value:a.status||"",onChange:x=>Vt(a.id,x.target.value),class:"rounded-md border-gray-300 text-xs shadow-sm"},[e[36]||(e[36]=t("option",{disabled:"",value:""},"Set statusâ€¦",-1)),(d(!0),r(B,null,j(Te.value,x=>(d(),r("option",{key:x+a.id,value:x},i(x),9,aa))),128)),Te.value.includes("complete")?y("",!0):(d(),r("option",oa,"complete")),Te.value.includes("done")?y("",!0):(d(),r("option",na,"done"))],40,sa)])])]))),128))])]),t("div",la,[t("div",null," Page "+i(ae.value)+" of "+i(Ne.value)+" â€¢ "+i(Fe.value.length)+" total ",1),t("div",ia,[t("button",{onClick:e[18]||(e[18]=a=>G(ae.value-1)),disabled:ae.value<=1,class:"rounded-md border px-3 py-1 disabled:opacity-50"},"Prev",8,ra),t("button",{onClick:e[19]||(e[19]=a=>G(ae.value+1)),disabled:ae.value>=Ne.value,class:"rounded-md border px-3 py-1 disabled:opacity-50"},"Next",8,da)])])])])]),t("div",ua,[t("div",ca,[e[39]||(e[39]=t("h3",{class:"text-lg font-medium leading-6 text-gray-900 mb-4"},"Today's Time Events",-1)),Be.value.length===0?(d(),r("div",ma," No time entries recorded today. Clock in to start tracking time. ")):(d(),r("div",pa,[t("table",va,[e[38]||(e[38]=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Task"),t("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Start Time"),t("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"End Time"),t("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Duration"),t("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Break Duration"),t("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Notes")])],-1)),t("tbody",ga,[(d(!0),r(B,null,j(Be.value,(a,x)=>(d(),r("tr",{key:x},[t("td",xa,i(a.name),1),t("td",ya,i(ce(a.start)),1),t("td",fa,i(ce(a.end)),1),t("td",ha,i(U(a.durationSeconds)),1),t("td",ka,i(U(a.breakDurationSeconds||0)),1),t("td",ba,i(a.notes||"-"),1)]))),128))])])]))])]),Y.value==="admin"?(d(),r("div",_a,[t("div",wa,[t("div",Sa,[e[40]||(e[40]=t("h3",{class:"text-lg font-medium leading-6 text-gray-900"},"Real-Time Activity Log",-1)),t("button",{onClick:Re,disabled:Ee.value,class:"rounded-md bg-indigo-600 px-3 py-1.5 text-xs font-semibold text-white hover:bg-indigo-500"},"Refresh",8,Ta)]),t("div",Da,[t("table",Ma,[e[42]||(e[42]=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"User"),t("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Action"),t("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Description"),t("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Time")])],-1)),t("tbody",Ca,[(d(!0),r(B,null,j($e.value,a=>{var x;return d(),r("tr",{key:a.id},[t("td",Na,i(((x=a.user)==null?void 0:x.name)||"Unknown"),1),t("td",$a,i(a.action),1),t("td",Ea,i(a.description),1),t("td",Ia,i(new Date(a.created_at).toLocaleString()),1)])}),128)),$e.value.length===0&&!Ee.value?(d(),r("tr",La,[...e[41]||(e[41]=[t("td",{colspan:"4",class:"px-4 py-4 text-center text-sm text-gray-500"},"No activity logs found",-1)])])):y("",!0)])])])])])):y("",!0)])):y("",!0),de.value==="time-entries"&&Y.value!=="admin"?(d(),r("div",Ba,[t("div",Pa,[t("div",Ua,[t("div",null,[e[43]||(e[43]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Date",-1)),ee(t("input",{"onUpdate:modelValue":e[20]||(e[20]=a=>se.value=a),onChange:ot,type:"date",class:"w-full rounded-md border-gray-300 shadow-sm"},null,544),[[je,se.value]])])])]),t("div",ja,[e[49]||(e[49]=t("h3",{class:"text-lg font-medium leading-6 text-gray-900 mb-4"},"Daily Summary",-1)),t("div",Ha,[t("div",null,[e[44]||(e[44]=t("div",{class:"text-gray-500"},"ðŸ•’ Time In Hours",-1)),t("div",Wa,i(U(W.value.workSeconds)),1)]),t("div",null,[e[45]||(e[45]=t("div",{class:"text-gray-500"},"â˜• Total Breaks",-1)),t("div",Oa,i(U(W.value.breakSeconds)),1)]),t("div",null,[e[46]||(e[46]=t("div",{class:"text-gray-500"},"ðŸ“‹ Entries",-1)),t("div",Aa,i(W.value.tasksCount),1)]),t("div",null,[e[47]||(e[47]=t("div",{class:"text-gray-500"},"â° Status",-1)),t("div",{class:A(["font-semibold",{"text-green-700":W.value.status==="Perfect","text-yellow-700":W.value.status==="Late","text-gray-700":W.value.status==="No Entry"}])},i(W.value.status),3)]),t("div",null,[e[48]||(e[48]=t("div",{class:"text-gray-500"},"âš¡ Overtime",-1)),t("div",Fa,i(U(W.value.overtimeSeconds)),1)])])]),t("div",Ra,[t("div",Va,[t("table",qa,[e[51]||(e[51]=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Task"),t("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Start Time"),t("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"End Time"),t("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Duration"),t("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Break Duration"),t("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Notes")])],-1)),t("tbody",za,[(d(!0),r(B,null,j(L.value,(a,x)=>(d(),r("tr",{key:x},[t("td",Ya,i(a.name),1),t("td",Ka,i(ce(a.start)),1),t("td",Za,i(ce(a.end)),1),t("td",Ga,i(U(a.durationSeconds)),1),t("td",Ja,i(U(a.breakDurationSeconds||0)),1),t("td",Qa,i(a.notes||"-"),1)]))),128)),L.value.length===0&&!we.value?(d(),r("tr",Xa,[...e[50]||(e[50]=[t("td",{colspan:"6",class:"px-4 py-4 text-center text-sm text-gray-500"},"No entries for selected day",-1)])])):y("",!0)])])]),we.value?(d(),r("div",eo,[...e[52]||(e[52]=[t("div",{class:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600"},null,-1),t("p",{class:"mt-2 text-sm text-gray-500"},"Loading...",-1)])])):y("",!0)])])):y("",!0)]),He.value?(d(),r("div",to,[t("div",so,[t("div",ao,[e[53]||(e[53]=t("h4",{class:"text-md font-semibold"},"Daily Logs",-1)),t("button",{onClick:e[21]||(e[21]=a=>He.value=!1),class:"rounded-md bg-gray-100 px-2 py-1 text-xs hover:bg-gray-200"},"Close")]),t("div",oo,[Be.value.length===0?(d(),r("div",no,"No entry today.")):(d(),r("div",lo,[t("div",io,[t("div",ro,[e[54]||(e[54]=t("div",{class:"text-xs font-medium text-gray-500 uppercase tracking-wide"},"Total Work Hours",-1)),t("div",uo,i(U(ke.value)),1)]),t("div",co,[e[55]||(e[55]=t("div",{class:"text-xs font-medium text-gray-500 uppercase tracking-wide"},"Total Task Hours",-1)),t("div",mo,i(U(We.value)),1)])]),t("div",po,[t("table",vo,[e[56]||(e[56]=t("thead",{class:"bg-gray-50 sticky top-0"},[t("tr",null,[t("th",{class:"px-4 py-2 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Task"),t("th",{class:"px-4 py-2 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Start Time"),t("th",{class:"px-4 py-2 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"End Time"),t("th",{class:"px-4 py-2 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Duration"),t("th",{class:"px-4 py-2 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Break Duration"),t("th",{class:"px-4 py-2 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Notes")])],-1)),t("tbody",go,[(d(!0),r(B,null,j(Be.value,(a,x)=>(d(),r("tr",{key:x},[t("td",xo,i(a.name),1),t("td",yo,i(ce(a.start)),1),t("td",fo,i(ce(a.end)),1),t("td",ho,i(U(a.durationSeconds)),1),t("td",ko,i(U(a.breakDurationSeconds||0)),1),t("td",bo,i(a.notes||"-"),1)]))),128))])])])]))])])])):y("",!0),ge.value?(d(),r("div",_o,[t("div",wo,[t("div",So,[e[57]||(e[57]=t("h4",{class:"text-md font-semibold text-gray-900"},"Sync ClickUp Spaces",-1)),t("button",{onClick:Dt,disabled:V.value&&((u=m.value)==null?void 0:u.status)==="syncing",class:"rounded-md bg-gray-100 px-2 py-1 text-xs hover:bg-gray-200 disabled:opacity-50"},"Cancel",8,To)]),t("div",Do,[m.value?(d(),r("div",Mo,[t("div",Co,[t("div",No,[t("span",$o," Space "+i(m.value.current)+" of "+i(m.value.total),1),t("span",Eo,i(Math.round(m.value.current/m.value.total*100))+"% ",1)]),t("div",Io,[t("div",{class:"bg-indigo-600 h-2 rounded-full transition-all duration-300",style:Xt({width:`${m.value.current/m.value.total*100}%`})},null,4)])]),t("div",{class:A(["rounded-md border p-4 space-y-3",{"border-blue-200 bg-blue-50":m.value.status==="checking","border-green-200 bg-green-50":m.value.status==="completed","border-yellow-200 bg-yellow-50":m.value.status==="skipped","border-red-200 bg-red-50":m.value.status==="error","border-indigo-200 bg-indigo-50":m.value.status==="syncing"}])},[t("div",Lo,[m.value.status==="checking"||m.value.status==="syncing"?(d(),r("span",Bo)):m.value.status==="completed"?(d(),r("span",Po,"âœ“")):m.value.status==="skipped"?(d(),r("span",Uo,"âŠ˜")):m.value.status==="error"?(d(),r("span",jo,"âœ—")):y("",!0),t("h5",Ho,i(m.value.spaceName),1)]),m.value.status==="checking"&&((p=I.value)==null?void 0:p.is_member)===!0?(d(),r("div",Wo,[e[58]||(e[58]=t("p",{class:"text-sm text-gray-700"},"You are a member of this space. Would you like to sync tasks from it?",-1)),t("div",{class:"flex gap-2"},[t("button",{onClick:St,class:"flex-1 rounded-md bg-indigo-600 px-3 py-2 text-xs font-semibold text-white hover:bg-indigo-700"}," Yes, Sync This Space "),t("button",{onClick:Tt,class:"flex-1 rounded-md bg-gray-200 px-3 py-2 text-xs font-medium text-gray-700 hover:bg-gray-300"}," Skip ")])])):m.value.status==="checking"&&((k=I.value)==null?void 0:k.is_member)===!1?(d(),r("div",Oo," You are not a member of this space. Skipping... ")):m.value.status==="syncing"?(d(),r("div",Ao," Syncing tasks from this space... ")):m.value.status==="completed"&&m.value.result?(d(),r("div",Fo,[e[59]||(e[59]=t("div",{class:"font-medium text-green-700"},"Sync completed!",-1)),t("div",Ro," Created: "+i(((D=m.value.result.summary)==null?void 0:D.created)||0)+", Updated: "+i(((f=m.value.result.summary)==null?void 0:f.updated)||0)+", Unchanged: "+i(((S=m.value.result.summary)==null?void 0:S.unchanged)||0),1)])):m.value.status==="skipped"?(d(),r("div",Vo," This space was skipped. ")):m.value.status==="error"?(d(),r("div",qo," An error occurred while processing this space. ")):y("",!0)],2)])):y("",!0),_.value.length>0?(d(),r("div",zo,[e[60]||(e[60]=t("h6",{class:"text-xs font-medium text-gray-600 mb-2"},"Completed Spaces:",-1)),t("div",Yo,[(d(!0),r(B,null,j(_.value,(a,x)=>{var E,X,z,R,me,ne;return d(),r("div",{key:x,class:"flex items-center justify-between p-2 rounded bg-gray-50"},[t("span",Ko,i(a.name),1),t("span",{class:A(["px-2 py-0.5 rounded text-xs font-medium",{"bg-green-100 text-green-700":(E=a.result)==null?void 0:E.ok,"bg-yellow-100 text-yellow-700":(X=a.result)==null?void 0:X.skipped,"bg-red-100 text-red-700":!((z=a.result)!=null&&z.ok)&&!((R=a.result)!=null&&R.skipped)}])},i((me=a.result)!=null&&me.ok?"Synced":(ne=a.result)!=null&&ne.skipped?"Skipped":"Error"),3)])}),128))])])):y("",!0),!m.value&&V.value?(d(),r("div",Zo,[...e[61]||(e[61]=[t("span",{class:"h-3 w-3 rounded-full border-2 border-gray-300 border-t-indigo-600 animate-spin"},null,-1),t("span",null,"Initializing space sync...",-1)])])):y("",!0)])])])):y("",!0),Oe.value&&$.value?(d(),r("div",Go,[t("div",Jo,[t("div",{class:"flex items-center justify-between border-b px-4 py-3"},[e[62]||(e[62]=t("h4",{class:"text-md font-semibold"},"ClickUp Sync Summary",-1)),t("button",{onClick:bt,class:"rounded-md bg-gray-100 px-2 py-1 text-xs hover:bg-gray-200"},"Close")]),t("div",Qo,[t("div",Xo,[e[64]||(e[64]=t("p",null,"Latest sync completed successfully.",-1)),$.value.sources.length?(d(),r("p",en,[e[63]||(e[63]=Pe(" Sources: ",-1)),t("span",tn,i($.value.sources.join(", ")),1)])):y("",!0)]),t("div",sn,[t("div",an,[e[65]||(e[65]=t("div",{class:"text-xs uppercase tracking-wide text-indigo-600"},"Total Processed",-1)),t("div",on,i($.value.summary.total),1)]),t("div",nn,[e[66]||(e[66]=t("div",{class:"text-xs uppercase tracking-wide text-green-600"},"Created",-1)),t("div",ln,i($.value.summary.created),1)]),t("div",rn,[e[67]||(e[67]=t("div",{class:"text-xs uppercase tracking-wide text-blue-600"},"Updated",-1)),t("div",dn,i($.value.summary.updated),1)]),t("div",un,[e[68]||(e[68]=t("div",{class:"text-xs uppercase tracking-wide text-gray-600"},"No Changes",-1)),t("div",cn,i($.value.summary.unchanged),1)]),t("div",mn,[e[69]||(e[69]=t("div",{class:"text-xs uppercase tracking-wide text-amber-600"},"Skipped",-1)),t("div",pn,i($.value.summary.skipped),1)])]),$.value.created.length?(d(),r("div",vn,[e[70]||(e[70]=t("h5",{class:"text-sm font-semibold text-gray-900"},"New tasks",-1)),t("ul",gn,[(d(!0),r(B,null,j($.value.created,a=>(d(),r("li",{key:"created-"+a.id,class:"rounded-md border border-green-200 bg-green-50 px-3 py-2"},[t("div",xn,[t("span",yn,i(a.title),1),t("span",fn,i(nt(a.due_date)),1)]),t("div",hn,[a.status?(d(),r("span",kn,"Status: "+i(a.status),1)):y("",!0),a.priority?(d(),r("span",bn,"Priority: "+i(a.priority),1)):y("",!0)])]))),128))])])):y("",!0),$.value.updated.length?(d(),r("div",_n,[e[71]||(e[71]=t("h5",{class:"text-sm font-semibold text-gray-900"},"Updated tasks",-1)),t("ul",wn,[(d(!0),r(B,null,j($.value.updated,a=>(d(),r("li",{key:"updated-"+a.id,class:"rounded-md border border-blue-200 bg-blue-50 px-3 py-2"},[t("div",Sn,[t("span",Tn,i(a.title),1),t("span",Dn,i(nt(a.due_date)),1)]),t("div",Mn,[a.status?(d(),r("span",Cn,"Status: "+i(a.status),1)):y("",!0),a.priority?(d(),r("span",Nn,"Priority: "+i(a.priority),1)):y("",!0)])]))),128))])])):y("",!0),$.value.skipped.length?(d(),r("div",$n,[e[72]||(e[72]=t("h5",{class:"text-sm font-semibold text-gray-900"},"Skipped items",-1)),t("ul",En,[(d(!0),r(B,null,j($.value.skipped,a=>(d(),r("li",{key:"skipped-"+a.id,class:"rounded-md border border-amber-200 bg-amber-50 px-3 py-2 text-xs text-amber-900"},[t("div",In,[t("span",Ln,i(a.id),1),t("span",Bn,i(a.reason),1)])]))),128))])])):y("",!0)])])])):y("",!0),be.value?(d(),r("div",Pn,[t("div",Un,[t("div",jn,[e[73]||(e[73]=t("h4",{class:"text-md font-semibold"},"Task Details",-1)),t("button",{onClick:e[22]||(e[22]=a=>be.value=!1),class:"rounded-md bg-gray-100 px-2 py-1 text-xs hover:bg-gray-200"},"Close")]),P.value?(d(),r("div",Hn,[t("div",Wn,[t("h2",On,i((v=P.value.task)==null?void 0:v.title),1),t("div",An,[(h=P.value.task)!=null&&h.status?(d(),r("span",Fn,[e[74]||(e[74]=t("span",{class:"text-gray-600"},"Status:",-1)),rt(P.value.task.status)?(d(),r("span",{key:0,class:A(["inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-semibold ml-1",it(P.value.task.status)])},i(P.value.task.status),3)):(d(),r("span",Rn,i(P.value.task.status),1))])):y("",!0),(w=P.value.clickup)!=null&&w.url?(d(),r("span",Vn,[t("a",{href:P.value.clickup.url,target:"_blank",class:"text-indigo-600 hover:underline text-sm font-medium"},"Open in ClickUp â†’",8,qn)])):y("",!0)])]),(b=P.value.clickup)!=null&&b.text_content?(d(),r("div",zn,[t("div",{innerHTML:zt(P.value.clickup.text_content),class:"prose prose-sm max-w-none"},null,8,Yn)])):(d(),r("div",Kn," No additional details available. "))])):y("",!0)])])):y("",!0)])]}),_:1})],64))}});export{Xn as default};
