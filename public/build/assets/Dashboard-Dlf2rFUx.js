import{d as Rt,r as c,c as N,o as Vt,A as qt,B as zt,a as i,b as lt,u as Yt,h as Kt,e as it,f as t,i as x,g as r,n as A,t as d,j as Ie,l as X,F as P,k as j,v as Le,m as Be,C as Zt}from"./app-CcBQiH1p.js";import{_ as Gt}from"./AuthenticatedLayout.vue_vue_type_script_setup_true_lang-DzkaLqtW.js";import{a as T}from"./api-Bb-tm60f.js";const Jt={class:"py-12"},Qt={class:"mx-auto max-w-[95%] sm:px-6 lg:px-8"},Xt={key:0,class:"border-b border-gray-200 mb-6"},es={class:"-mb-px flex space-x-8"},ts={key:1},ss={key:0,class:"mb-6 grid gap-4 md:grid-cols-3"},as={class:"overflow-hidden bg-white shadow sm:rounded-lg"},os={class:"px-4 py-5 sm:p-6"},ns={class:"mt-2 text-3xl font-bold text-gray-900"},ls={class:"text-xs text-gray-500"},is={key:0,class:"mt-2"},rs={class:"text-sm text-gray-600"},ds={class:"font-semibold"},us={class:"mt-4 flex flex-wrap gap-2"},cs=["disabled"],ms=["disabled"],ps={class:"overflow-hidden bg-white shadow sm:rounded-lg"},vs={class:"px-4 py-5 sm:p-6"},gs={key:0,class:"mt-2"},xs={class:"text-2xl font-bold text-gray-900 mt-1"},ys={key:0,class:"text-sm font-normal text-gray-500"},fs={class:"mt-3"},hs=["disabled"],ks={key:1,class:"mt-2"},bs={class:"flex items-center gap-2 w-full"},_s=["value"],ws=["disabled"],Ss={key:0,class:"text-sm text-gray-500 mt-2"},Ts={class:"overflow-hidden bg-white shadow sm:rounded-lg"},Ds={class:"px-4 py-5 sm:p-6"},Ms={class:"mt-2 text-3xl font-bold text-gray-900"},Cs={key:1,class:"mb-6 overflow-hidden bg-white shadow sm:rounded-lg"},Ns={class:"px-4 py-5 sm:p-6"},$s={class:"flex items-center justify-between mb-4"},Es=["disabled"],Is={class:"overflow-x-auto"},Ls={class:"min-w-full divide-y divide-gray-200"},Bs={class:"divide-y divide-gray-200 bg-white"},Ps={class:"px-4 py-4 text-sm text-gray-900"},Us={class:"px-4 py-4 text-sm text-gray-500"},js={class:"px-4 py-4 text-sm text-gray-500"},Hs={class:"px-4 py-4 text-sm text-gray-500"},Ws={key:0},Os={key:2,class:"mb-6 overflow-hidden bg-white shadow sm:rounded-lg"},As={class:"px-4 py-5 sm:p-6"},Fs={class:"flex items-center justify-between mb-3"},Rs={class:"flex items-center gap-2"},Vs=["disabled"],qs={key:0,class:"h-3 w-3 rounded-full border-2 border-white border-t-transparent animate-spin"},zs=["value"],Ys={class:"overflow-x-auto"},Ks={class:"min-w-full divide-y divide-gray-200"},Zs={class:"divide-y divide-gray-200 bg-white"},Gs={class:"whitespace-nowrap px-6 py-4 text-sm text-indigo-600"},Js=["onClick"],Qs={class:"whitespace-nowrap px-6 py-4 text-sm text-gray-900"},Xs={class:"whitespace-nowrap px-6 py-4 text-sm text-gray-900"},ea={class:"whitespace-nowrap px-6 py-4 text-sm"},ta={key:1,class:"text-sm text-gray-700"},sa={class:"whitespace-nowrap px-6 py-4 text-sm text-gray-900"},aa={class:"whitespace-nowrap px-6 py-4 text-sm text-gray-500"},oa={class:"whitespace-nowrap px-6 py-4 text-sm"},na={class:"whitespace-nowrap px-6 py-4 text-sm text-gray-900"},la={class:"flex items-center space-x-2"},ia=["onClick","disabled","aria-label"],ra={key:0,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",class:"h-4 w-4"},da={key:1,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",class:"h-4 w-4"},ua=["value","onChange"],ca=["value"],ma={key:0,value:"complete"},pa={key:1,value:"done"},va={class:"flex items-center justify-between px-6 py-3 text-sm text-gray-600"},ga={class:"space-x-2"},xa=["disabled"],ya=["disabled"],fa={class:"overflow-hidden bg-white shadow sm:rounded-lg"},ha={class:"px-4 py-5 sm:p-6"},ka={key:0,class:"text-center py-8 text-gray-500"},ba={key:1,class:"overflow-x-auto"},_a={class:"min-w-full divide-y divide-gray-200"},wa={class:"divide-y divide-gray-200"},Sa={class:"px-4 py-4 text-sm text-gray-900"},Ta={class:"px-4 py-4 text-sm text-gray-500"},Da={class:"px-4 py-4 text-sm text-gray-500"},Ma={class:"px-4 py-4 text-sm text-gray-900 font-semibold"},Ca={class:"px-4 py-4 text-sm text-gray-500"},Na={class:"px-4 py-4 text-sm text-gray-500"},$a={key:2,class:"space-y-6"},Ea={class:"bg-white shadow rounded-lg p-4"},Ia={class:"grid gap-4 sm:grid-cols-2"},La={class:"bg-white shadow rounded-lg p-5"},Ba={class:"grid gap-4 sm:grid-cols-3 lg:grid-cols-5 text-sm"},Pa={class:"font-semibold"},Ua={class:"font-semibold"},ja={class:"font-semibold"},Ha={class:"font-semibold"},Wa={class:"bg-white shadow rounded-lg"},Oa={class:"overflow-x-auto"},Aa={class:"min-w-full divide-y divide-gray-200"},Fa={class:"divide-y divide-gray-200"},Ra={class:"px-4 py-4 text-sm text-gray-900"},Va={class:"px-4 py-4 text-sm text-gray-500"},qa={class:"px-4 py-4 text-sm text-gray-500"},za={class:"px-4 py-4 text-sm text-gray-900 font-semibold"},Ya={class:"px-4 py-4 text-sm text-gray-500"},Ka={class:"px-4 py-4 text-sm text-gray-500"},Za={key:0},Ga={key:0,class:"text-center py-8"},Ja={key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50"},Qa={class:"w-full max-w-2xl rounded-lg bg-white shadow-lg"},Xa={class:"flex items-center justify-between border-b px-4 py-3"},eo={class:"p-4"},to={key:0,class:"text-gray-500 text-sm"},so={key:1,class:"overflow-x-auto"},ao={class:"min-w-full divide-y divide-gray-200"},oo={class:"divide-y divide-gray-200 bg-white"},no={class:"px-4 py-2 text-sm text-gray-900"},lo={class:"px-4 py-2 text-sm text-gray-700"},io={class:"px-4 py-2 text-sm text-gray-700"},ro={class:"px-4 py-2 text-sm text-gray-700 font-semibold"},uo={class:"px-4 py-2 text-sm text-gray-700"},co={class:"px-4 py-2 text-sm text-gray-700"},mo={key:1,class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50"},po={class:"w-full max-w-lg rounded-lg bg-white shadow-xl"},vo={class:"flex items-center justify-between border-b px-5 py-3"},go=["disabled"],xo={class:"p-5 space-y-4 text-sm text-gray-700"},yo={key:0},fo={class:"mb-4"},ho={class:"flex items-center justify-between mb-2"},ko={class:"text-xs font-medium text-gray-600"},bo={class:"text-xs text-gray-500"},_o={class:"w-full bg-gray-200 rounded-full h-2"},wo={class:"flex items-center gap-2"},So={key:0,class:"h-4 w-4 rounded-full border-2 border-current border-t-transparent animate-spin"},To={key:1,class:"text-green-600 text-lg"},Do={key:2,class:"text-yellow-600 text-lg"},Mo={key:3,class:"text-red-600 text-lg"},Co={class:"font-semibold text-gray-900"},No={key:0,class:"space-y-3"},$o={key:1,class:"text-sm text-gray-600"},Eo={key:2,class:"text-sm text-gray-600"},Io={key:3,class:"text-sm space-y-1"},Lo={class:"text-xs text-gray-600"},Bo={key:4,class:"text-sm text-yellow-700"},Po={key:5,class:"text-sm text-red-700"},Uo={key:1,class:"mt-4"},jo={class:"max-h-32 overflow-y-auto space-y-1 text-xs"},Ho={class:"text-gray-700"},Wo={key:2,class:"flex items-center gap-2 text-sm text-gray-500"},Oo={key:2,class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50"},Ao={class:"w-full max-w-3xl rounded-lg bg-white shadow-lg"},Fo={class:"p-5 text-sm text-gray-700 space-y-5"},Ro={class:"space-y-1"},Vo={key:0,class:"text-xs text-gray-500"},qo={class:"font-medium text-gray-600"},zo={class:"grid gap-3 sm:grid-cols-2 lg:grid-cols-5"},Yo={class:"rounded-md bg-indigo-50 px-4 py-3"},Ko={class:"text-xl font-semibold text-indigo-900"},Zo={class:"rounded-md bg-green-50 px-4 py-3"},Go={class:"text-xl font-semibold text-green-900"},Jo={class:"rounded-md bg-blue-50 px-4 py-3"},Qo={class:"text-xl font-semibold text-blue-900"},Xo={class:"rounded-md bg-gray-100 px-4 py-3"},en={class:"text-xl font-semibold text-gray-900"},tn={class:"rounded-md bg-amber-50 px-4 py-3"},sn={class:"text-xl font-semibold text-amber-900"},an={key:0,class:"space-y-2"},on={class:"max-h-48 overflow-y-auto space-y-2 pr-1"},nn={class:"flex items-start justify-between gap-3"},ln={class:"font-medium text-green-900 leading-tight"},rn={class:"text-xs text-green-700 whitespace-nowrap"},dn={class:"mt-1 flex flex-wrap gap-3 text-xs text-green-800"},un={key:0},cn={key:1},mn={key:1,class:"space-y-2"},pn={class:"max-h-48 overflow-y-auto space-y-2 pr-1"},vn={class:"flex items-start justify-between gap-3"},gn={class:"font-medium text-blue-900 leading-tight"},xn={class:"text-xs text-blue-700 whitespace-nowrap"},yn={class:"mt-1 flex flex-wrap gap-3 text-xs text-blue-800"},fn={key:0},hn={key:1},kn={key:2,class:"space-y-2"},bn={class:"max-h-40 overflow-y-auto space-y-1 pr-1"},_n={class:"flex items-start justify-between gap-3"},wn={class:"font-medium leading-tight"},Sn={class:"text-amber-700"},Tn={key:3,class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50"},Dn={class:"w-full max-w-3xl max-h-[90vh] rounded-lg bg-white shadow-lg flex flex-col"},Mn={class:"flex items-center justify-between border-b px-4 py-3 flex-shrink-0"},Cn={key:0,class:"p-6 text-sm text-gray-700 overflow-y-auto flex-1"},Nn={class:"mb-4 pb-4 border-b"},$n={class:"font-semibold text-lg text-gray-900 mb-2"},En={class:"flex items-center gap-3 flex-wrap"},In={key:0,class:"text-sm"},Ln={key:1,class:"ml-1 text-gray-700"},Bn={key:1},Pn=["href"],Un={key:0,class:"task-content"},jn=["innerHTML"],Hn={key:1,class:"text-gray-500 italic"},Rn=Rt({__name:"Dashboard",setup(Wn){const g=c(null),$=c(!1),oe=c(""),ee=c(new Date),F=c("employee"),Y=c([]),de=c(null),M=c(null),Pe=c(!1),ze=c([]),Ue=c(0),K=c([]),U=c(null),ye=c(!1),je=c(!1),fe=c(!1),E=c(null),ue=c(!1);c(!1),c(null);const Ye=c([]),rt=c([]),dt=N(()=>Ye.value.length>0);N(()=>dt.value&&rt.value.length===Ye.value.length);const q=c(!1),H=c(0),ne=c([]),I=c(null),p=c(null),w=c([]),le=c("dashboard"),te=c(""),Ke=c([]),he=c(!1),W=c({workSeconds:0,breakSeconds:0,lunchSeconds:0,tasksCount:0,status:"No Entry",overtimeSeconds:0}),B=c([]),He=c(""),se=c(1),ce=c(10),ke=c("all"),be=N(()=>{const s=new Set;return(Y.value||[]).forEach(e=>{const o=(e.status||"").toString().trim();o&&s.add(o)}),Array.from(s).sort((e,o)=>e.localeCompare(o))}),_e=c("all"),we=c(""),Se=c(""),We=N(()=>{const s=He.value.trim().toLowerCase();let e=Y.value;if(ke.value!=="all"){const o=ke.value.toLowerCase();e=e.filter(n=>(n.status||"").toLowerCase()===o)}if(_e.value!=="all"){const o=_e.value;e=e.filter(n=>(n.priority||"none").toLowerCase()===o)}if(we.value){const o=new Date(we.value).getTime();e=e.filter(n=>n.due_date?new Date(n.due_date).getTime()>=o:!1)}if(Se.value){const o=new Date(Se.value).getTime();e=e.filter(n=>n.due_date?new Date(n.due_date).getTime()<=o:!1)}return s?e.filter(o=>(o.title||"").toLowerCase().includes(s)):e}),Te=N(()=>Math.max(1,Math.ceil(We.value.length/ce.value))),ut=N(()=>{const e=(Math.min(se.value,Te.value)-1)*ce.value;return We.value.slice(e,e+ce.value)}),Z=s=>{const e=Math.max(1,Math.min(s,Te.value));se.value=e},De=c([]),Me=c(!1),Oe=async()=>{var s;Me.value=!0;try{const e=await T.get("/admin/analytics/activity-logs",{params:{limit:100}});De.value=((s=e.data)==null?void 0:s.data)||[]}catch{De.value=[]}finally{Me.value=!1}};let Ae=null,me=null;const Ce=c(!1),Ne=c(!1),pe=c(!1),Fe=c(!1),R=N(()=>{var s,e;return!!((s=g.value)!=null&&s.clock_in)&&!((e=g.value)!=null&&e.clock_out)}),O=N(()=>{var s,e;return!!((s=g.value)!=null&&s.break_start)&&!((e=g.value)!=null&&e.break_end)}),ct=N(()=>{var s,e;return((s=g.value)==null?void 0:s.lunch_start)&&!((e=g.value)!=null&&e.lunch_end)}),$e=N(()=>{const s=[];if(!g.value)return s;const e=g.value;if(e.clock_in&&e.clock_out){const o=Math.max(0,Math.floor((new Date(e.clock_out).getTime()-new Date(e.clock_in).getTime())/1e3)),n=e.break_start?new Date(e.break_start):null,l=e.break_end?new Date(e.break_end):null;let u=0;n&&l&&(u=Math.max(0,Math.floor((l.getTime()-n.getTime())/1e3)));const v=Math.max(0,o-u);s.push({name:"Work Hours",start:e.clock_in,end:e.clock_out,durationSeconds:v,breakDurationSeconds:u,notes:"-"})}if(e.break_start&&e.break_end){const o=Math.max(0,Math.floor((new Date(e.break_end).getTime()-new Date(e.break_start).getTime())/1e3));s.push({name:"Break",start:e.break_start,end:e.break_end,durationSeconds:o,breakDurationSeconds:o,notes:"-"})}return K.value.forEach(o=>{var n;if(o.clock_in&&o.clock_out){const l=Math.max(0,Math.floor((new Date(o.clock_out).getTime()-new Date(o.clock_in).getTime())/1e3));s.push({name:((n=o.task)==null?void 0:n.title)||`Task #${o.task_id}`,start:o.clock_in,end:o.clock_out,durationSeconds:l,breakDurationSeconds:0,notes:"-"})}}),s.sort((o,n)=>{const l=new Date(o.start).getTime(),u=new Date(n.start).getTime();return(isNaN(u)?0:u)-(isNaN(l)?0:l)}),s}),mt=async()=>{"Notification"in window&&Notification.permission==="default"&&await Notification.requestPermission()},Re=(s,e,o)=>{"Notification"in window&&Notification.permission==="granted"&&new Notification(s,{body:e,icon:"/favicon.ico",badge:"/favicon.ico",tag:"time-tracker-notification",requireInteraction:!1,...o})},pt=()=>{var s;if(O.value&&((s=g.value)!=null&&s.break_start)){const e=new Date(g.value.break_start),o=ee.value,n=Math.floor((o.getTime()-e.getTime())/1e3),l=Math.floor(n/60);l>=13&&!Ce.value&&(Re("Break Reminder","You're approaching the 15-minute break limit. Please end your break soon.",{tag:"break-13-min"}),Ce.value=!0),l>=15&&!Ne.value&&(Re("Break Over Limit","You've exceeded the 15-minute break limit. Please end your break now.",{tag:"break-15-min",requireInteraction:!0}),Ne.value=!0)}else O.value||(Ce.value=!1,Ne.value=!1)},Ze=async()=>{var s,e;if(!(Fe.value||pe.value)&&!R.value&&(s=g.value)!=null&&s.clock_out&&(e=g.value)!=null&&e.clock_in){const o=new Date(g.value.clock_in),n=new Date(g.value.clock_out);Math.floor((n.getTime()-o.getTime())/1e3)/3600>=1&&!g.value.lunch_start&&!pe.value&&(Re("Lunch Reminder","You've been working for 1 hour without taking lunch. Please remember to take your lunch break.",{tag:"lunch-reminder",requireInteraction:!0}),pe.value=!0,Fe.value=!0)}},vt=()=>{me&&clearInterval(me),me=window.setInterval(()=>{pt(),pe.value||Ze()},6e4)},Ge=s=>{if(R.value)return s.preventDefault(),s.returnValue="",""};Vt(async()=>{const s=new Date;te.value=s.toISOString().split("T")[0],await mt(),ve(),xt(),G(),qe(),ie(),Ae=window.setInterval(()=>{ee.value=new Date},1e3),vt(),window.addEventListener("beforeunload",Ge)}),qt(()=>{Ae&&window.clearInterval(Ae),me&&clearInterval(me),window.removeEventListener("beforeunload",Ge)});const ve=async()=>{try{const s=await T.get("/time-entries/current");g.value=s.data,Pt(),O.value||(Ce.value=!1,Ne.value=!1);const e=new Date().toISOString().split("T")[0];te.value!==e&&(pe.value=!1,Fe.value=!1)}catch(s){g.value=null,oe.value="No entry today",console.error("Error fetching current entry:",s)}},gt=zt(),xt=async()=>{var e,o;const s=(e=gt.props.auth)==null?void 0:e.user;if(s!=null&&s.role){const n=s.role;["admin","manager","employee","developer"].includes(n)&&(F.value=n)}else try{const l=(((o=(await T.get("/admin/users")).data)==null?void 0:o.data)||[]).find(u=>(u==null?void 0:u.id)&&(u==null?void 0:u.email));if(l!=null&&l.role){const u=l.role;["admin","manager","employee","developer"].includes(u)&&(F.value=u)}}catch{}F.value==="admin"&&(await Oe(),setInterval(()=>{Oe()},5e3))},G=async()=>{try{const s=await T.get("/my/tasks");Y.value=s.data}catch{}},yt=()=>{je.value=!1,E.value=null},ft=async()=>{fe.value||q.value||await ht()},ht=async()=>{var s,e,o;if(!q.value){q.value=!0,w.value=[],H.value=0,p.value=null;try{const n=await T.get("/my/clickup/configured-spaces");if(ne.value=((s=n.data)==null?void 0:s.space_ids)||[],ne.value.length===0){alert("No ClickUp spaces configured. Please set CLICKUP_SPACE_IDS in your environment variables."),q.value=!1;return}ue.value=!0,await ae()}catch(n){alert(((o=(e=n==null?void 0:n.response)==null?void 0:e.data)==null?void 0:o.error)||"Failed to start space sync"),q.value=!1,ue.value=!1}}},ae=async()=>{var e,o;if(H.value>=ne.value.length){q.value=!1,ue.value=!1,await G(),ne.value.length,w.value.filter(n=>{var l;return(l=n.result)==null?void 0:l.ok}).length,w.value.filter(n=>{var l,u;return!((l=n.result)!=null&&l.ok)&&((u=n.result)==null?void 0:u.skipped)}).length,E.value={summary:{total:w.value.reduce((n,l)=>{var u,v;return n+(((v=(u=l.result)==null?void 0:u.summary)==null?void 0:v.total)||0)},0),created:w.value.reduce((n,l)=>{var u,v;return n+(((v=(u=l.result)==null?void 0:u.summary)==null?void 0:v.created)||0)},0),updated:w.value.reduce((n,l)=>{var u,v;return n+(((v=(u=l.result)==null?void 0:u.summary)==null?void 0:v.updated)||0)},0),unchanged:w.value.reduce((n,l)=>{var u,v;return n+(((v=(u=l.result)==null?void 0:u.summary)==null?void 0:v.unchanged)||0)},0),skipped:w.value.reduce((n,l)=>{var u,v;return n+(((v=(u=l.result)==null?void 0:u.summary)==null?void 0:v.skipped)||0)},0)},created:w.value.flatMap(n=>{var l;return((l=n.result)==null?void 0:l.created)||[]}),updated:w.value.flatMap(n=>{var l;return((l=n.result)==null?void 0:l.updated)||[]}),skipped:w.value.flatMap(n=>{var l;return((l=n.result)==null?void 0:l.skipped)||[]}),sources:w.value.map(n=>`Space: ${n.name} (${n.space_id})`)},je.value=!0;return}const s=ne.value[H.value];p.value={current:H.value+1,total:ne.value.length,spaceName:"Loading...",status:"checking"};try{const n=await T.get(`/my/clickup/space/${s}/info`);if(I.value=n.data,!I.value){p.value.status="error",w.value.push({space_id:s,name:"Unknown",result:{ok:!1,error:"Failed to get space info"}}),H.value++,setTimeout(()=>{ae()},1e3);return}if(p.value={...p.value,spaceName:I.value.name},!I.value.is_member){p.value.status="skipped",w.value.push({space_id:s,name:I.value.name,result:{ok:!1,skipped:!0,reason:"User is not a member of this space"}}),H.value++,setTimeout(()=>{ae()},1e3);return}p.value.status="checking"}catch(n){p.value.status="error",w.value.push({space_id:s,name:"Unknown",result:{ok:!1,error:((o=(e=n==null?void 0:n.response)==null?void 0:e.data)==null?void 0:o.error)||"Failed to get space info"}}),H.value++,setTimeout(()=>{ae()},1e3)}},kt=async()=>{var e,o;if(!I.value||!p.value)return;const s=I.value.space_id;if(s){p.value.status="syncing";try{const n=await T.post(`/my/clickup/space/${s}/sync`);p.value.status="completed",p.value.result=n.data,w.value.push({space_id:s,name:I.value.name,result:n.data}),H.value++,setTimeout(()=>{ae()},1500)}catch(n){p.value.status="error",w.value.push({space_id:s,name:I.value.name,result:{ok:!1,error:((o=(e=n==null?void 0:n.response)==null?void 0:e.data)==null?void 0:o.error)||"Failed to sync space"}}),H.value++,setTimeout(()=>{ae()},1500)}}},bt=()=>{if(!I.value)return;const s=I.value.space_id;s&&(w.value.push({space_id:s,name:I.value.name,result:{ok:!1,skipped:!0,reason:"User skipped this space"}}),H.value++,ae())},_t=()=>{q.value=!1,ue.value=!1,H.value=0,p.value=null,I.value=null,w.value=[]},Je=async()=>{try{await Ut()}catch{}},wt=async()=>{try{await jt()}catch{}},St=async()=>{try{await Ht()}catch{}},Ve=async()=>{try{await Wt()}catch{}},qe=async()=>{try{const s=await T.get("/tasks/today-entries");K.value=s.data||[];const e=(K.value||[]).find(o=>o.clock_in&&!o.clock_out);M.value=e?e.task_id:null}catch{K.value=[]}},Qe=async s=>{try{const e=await T.get(`/tasks/${s}/sync`);U.value=e.data,ye.value=!0}catch{ye.value=!1}},Tt=async()=>{if(O.value){await Ve();return}R.value?await wt():await Je()},Dt=async()=>{if(M.value){alert("Pause or stop the running task first.");return}O.value?await Ve():(R.value||await Je(),await St())},z=s=>s<10?`0${s}`:`${s}`,Mt=N(()=>{var s;return R.value&&((s=g.value)!=null&&s.clock_in)?new Date(g.value.clock_in):null}),Ct=N(()=>{var s;return O.value&&((s=g.value)!=null&&s.break_start)?new Date(g.value.break_start):null}),Nt=N(()=>{const s=K.value.find(e=>e.clock_in&&!e.clock_out);return s?new Date(s.clock_in):null}),$t=N(()=>{const s=Mt.value;if(!s)return"00:00:00";const e=ee.value.getTime()-s.getTime(),o=Math.max(0,Math.floor(e/1e3)),n=Math.floor(o/3600),l=Math.floor(o%3600/60),u=o%60;return`${z(n)}:${z(l)}:${z(u)}`}),Et=N(()=>{const s=Ct.value;if(!s)return"00:00:00";const e=ee.value.getTime()-s.getTime(),o=Math.max(0,Math.floor(e/1e3)),n=Math.floor(o/3600),l=Math.floor(o%3600/60),u=o%60;return`${z(n)}:${z(l)}:${z(u)}`}),It=N(()=>{const s=Nt.value;if(!s)return"00:00:00";const e=ee.value.getTime()-s.getTime(),o=Math.max(0,Math.floor(e/1e3)),n=Math.floor(o/3600),l=Math.floor(o%3600/60),u=o%60;return`${z(n)}:${z(l)}:${z(u)}`}),Lt=N(()=>{var o,n;let s=Ue.value||0;if(R.value&&((o=g.value)!=null&&o.clock_in)&&!((n=g.value)!=null&&n.clock_out)){const l=new Date(g.value.clock_in),u=ee.value,v=Math.max(0,Math.floor((u.getTime()-l.getTime())/1e3));let f=0;if(g.value.break_start)if(g.value.break_end){const S=new Date(g.value.break_start),m=new Date(g.value.break_end);f=Math.max(0,Math.floor((m.getTime()-S.getTime())/1e3))}else{const S=new Date(g.value.break_start);f=Math.max(0,Math.floor((u.getTime()-S.getTime())/1e3))}let y=0;if(g.value.lunch_start)if(g.value.lunch_end){const S=new Date(g.value.lunch_start),m=new Date(g.value.lunch_end);y=Math.max(0,Math.floor((m.getTime()-S.getTime())/1e3))}else{const S=new Date(g.value.lunch_start);y=Math.max(0,Math.floor((u.getTime()-S.getTime())/1e3))}const _=Math.max(0,v-f-y);s+=_}return K.value&&K.value.length>0&&K.value.forEach(l=>{if(l.clock_in&&!l.clock_out){const u=new Date(l.clock_in),v=ee.value,f=Math.max(0,Math.floor((v.getTime()-u.getTime())/1e3));s+=f}}),(s/3600).toFixed(2)}),Bt=async()=>{await ie(),Pe.value=!0},ie=async()=>{var s;try{const e=new Date().toISOString().split("T")[0],n=((s=(await T.get("/my/time-entries",{params:{start_date:e,end_date:e}})).data)==null?void 0:s.entries)||[],l=[];let u=0,v=0;const f=new Date;n.forEach(y=>{const _=y.clock_in_formatted||y.clock_in,S=y.clock_out_formatted||y.clock_out,m=J(y.clock_in),k=J(y.clock_out);if(y.is_break||y.entry_type==="break"){if(!m)return;const a=!!k;let h=0;a&&k?(h=Math.max(0,Math.floor((k.getTime()-m.getTime())/1e3)),v+=h):h=Math.max(0,Math.floor((f.getTime()-m.getTime())/1e3)),l.push({name:"Break",start:_,end:a?S:null,durationSeconds:h,breakDurationSeconds:h,notes:a?"-":"In progress"});return}if(!m)return;const L=y.task&&(y.task.title||y.task.name),b=!!k;if(!L)if(b&&k){const a=Math.max(0,Math.floor((k.getTime()-m.getTime())/1e3)),h=J(y.lunch_start),Q=J(y.lunch_end);let C=0;h&&Q&&(C=Math.max(0,Math.floor((Q.getTime()-h.getTime())/1e3)));const D=Math.max(0,a-C);u+=D,l.push({name:"Work Hours",start:_,end:S,durationSeconds:D,breakDurationSeconds:0,notes:"-"})}else{const a=Math.max(0,Math.floor((f.getTime()-m.getTime())/1e3));l.push({name:"Work Hours",start:_,end:null,durationSeconds:a,breakDurationSeconds:0,notes:"In progress"})}if(L)if(b&&k){const a=Math.max(0,Math.floor((k.getTime()-m.getTime())/1e3));l.push({name:y.task.title||y.task.name,start:_,end:S,durationSeconds:a,breakDurationSeconds:0,notes:"-"})}else{const a=Math.max(0,Math.floor((f.getTime()-m.getTime())/1e3));l.push({name:y.task.title||y.task.name,start:_,end:null,durationSeconds:a,breakDurationSeconds:0,notes:"In progress"})}}),l.sort((y,_)=>{const S=new Date(y.start).getTime(),m=new Date(_.start).getTime();return(isNaN(m)?0:m)-(isNaN(S)?0:S)}),ze.value=l,Ue.value=u}catch{ze.value=[],Ue.value=0}},Pt=()=>{!g.value||!g.value.clock_in?oe.value="Not clocked in":g.value.clock_out?oe.value="Clocked out":ct.value?oe.value="On lunch":O.value?oe.value="On break":oe.value="Clocked in"},Ut=async s=>{var e,o;$.value=!0;try{const n={};await T.post("/time-entries/clock-in",n),await ve(),await G(),await ie()}catch(n){alert(((o=(e=n.response)==null?void 0:e.data)==null?void 0:o.message)||"Error clocking in")}finally{$.value=!1}},jt=async()=>{var s,e;$.value=!0;try{if(M.value){alert("Pause or stop the running task first."),$.value=!1;return}await T.post("/time-entries/clock-out"),await ve(),await G(),await ie(),setTimeout(()=>{Ze()},1e3)}catch(o){alert(((e=(s=o.response)==null?void 0:s.data)==null?void 0:e.message)||"Error clocking out")}finally{$.value=!1}},Ht=async()=>{var s,e;$.value=!0;try{await T.post("/time-entries/break-start"),await ve(),await G(),await ie()}catch(o){alert(((e=(s=o.response)==null?void 0:s.data)==null?void 0:e.message)||"Error starting break")}finally{$.value=!1}},Wt=async()=>{var s,e;$.value=!0;try{await T.post("/time-entries/break-end"),await ve(),await G(),await ie()}catch(o){alert(((e=(s=o.response)==null?void 0:s.data)==null?void 0:e.message)||"Error ending break")}finally{$.value=!1}},Xe=async s=>{var e,o;if(!R.value){alert("Please Time In first before starting a task.");return}if(O.value&&await Ve(),M.value&&M.value!==s)try{await T.post("/tasks/stop")}catch{}try{await T.post("/tasks/start",{task_id:s}),M.value=s,await qe()}catch(n){alert(((o=(e=n==null?void 0:n.response)==null?void 0:e.data)==null?void 0:o.message)||"Failed to start task")}},et=async()=>{try{await T.post("/tasks/stop")}catch{}M.value=null,await qe()},Ot=async(s,e)=>{var n,l;if(!e)return;if(!confirm(`Are you sure you want to set this task to "${e}"?`)){await G();return}$.value=!0;try{await T.post(`/tasks/${s}/status`,{status:e}),await G()}catch(u){alert(((l=(n=u==null?void 0:u.response)==null?void 0:n.data)==null?void 0:l.message)||"Failed to update task status")}finally{$.value=!1}},tt=async()=>{var s,e;if(te.value){he.value=!0;try{const o=await T.get("/my/time-entries",{params:{start_date:te.value,end_date:te.value}}),n=((s=o.data)==null?void 0:s.entries)||[];Ke.value=n,B.value=[];let l=0,u=0,v=null,f=null;const y=new Date;n.forEach(m=>{const k=m.clock_in_formatted||m.clock_in,L=m.clock_out_formatted||m.clock_out,b=J(m.clock_in),a=J(m.clock_out);if(b&&(!v||b<v)&&(v=b,f=k),m.is_break||m.entry_type==="break"){if(!b)return;const C=!!a;let D=0;C&&a?(D=Math.max(0,Math.floor((a.getTime()-b.getTime())/1e3)),u+=D):D=Math.max(0,Math.floor((y.getTime()-b.getTime())/1e3)),B.value.push({name:"Break",start:k,end:C?L:null,durationSeconds:D,breakDurationSeconds:D,notes:C?"-":"In progress"});return}if(!b)return;const h=m.task&&(m.task.title||m.task.name),Q=!!a;if(!h)if(Q&&a){const C=Math.max(0,Math.floor((a.getTime()-b.getTime())/1e3));l+=C;const D=J(m.lunch_start),ge=J(m.lunch_end);let xe=0;D&&ge&&(xe=Math.max(0,Math.floor((ge.getTime()-D.getTime())/1e3)));const Ee=Math.max(0,C-xe);B.value.push({name:"Work Hours",start:k,end:L,durationSeconds:Ee,breakDurationSeconds:0,notes:"-"})}else{const C=Math.max(0,Math.floor((y.getTime()-b.getTime())/1e3));B.value.push({name:"Work Hours",start:k,end:null,durationSeconds:C,breakDurationSeconds:0,notes:"In progress"})}if(h){const C=m.task.title||m.task.name;if(Q&&a){const D=Math.max(0,Math.floor((a.getTime()-b.getTime())/1e3));B.value.push({name:C,start:k,end:L,durationSeconds:D,breakDurationSeconds:0,notes:"-"})}else{const D=Math.max(0,Math.floor((y.getTime()-b.getTime())/1e3));B.value.push({name:C,start:k,end:null,durationSeconds:D,breakDurationSeconds:0,notes:"In progress"})}}}),B.value.sort((m,k)=>{const L=new Date(m.start).getTime(),b=new Date(k.start).getTime();return(isNaN(b)?0:b)-(isNaN(L)?0:L)});const _=B.value.filter(m=>m.name==="Work Hours").reduce((m,k)=>m+(k.durationSeconds||0),0),S=B.value.filter(m=>m.name==="Break").reduce((m,k)=>m+(k.durationSeconds||0),0);if((e=o.data)!=null&&e.daily_totals)W.value={workSeconds:_,breakSeconds:S,lunchSeconds:o.data.daily_totals.lunch_seconds||0,tasksCount:o.data.daily_totals.tasks_count||0,status:o.data.daily_totals.status||"No Entry",overtimeSeconds:o.data.daily_totals.overtime_seconds||0};else{const k=Math.max(0,_-28800);let L="No Entry";if(v){const b=(v.getUTCHours()+8)%24,a=v.getUTCMinutes();L=b<8||b===8&&a<=30?"Perfect":"Late"}W.value={workSeconds:_,breakSeconds:S,lunchSeconds:0,tasksCount:B.value.length,status:L,overtimeSeconds:k}}}catch(o){console.error("Error loading time entries",o),Ke.value=[],B.value=[],W.value={workSeconds:0,breakSeconds:0,lunchSeconds:0,tasksCount:0,status:"No Entry",overtimeSeconds:0}}finally{he.value=!1}}},J=s=>{if(!s)return null;const e=s.match(/^(\d{4})-(\d{2})-(\d{2})[ T](\d{2}):(\d{2})(?::(\d{2}))?/);if(e){const l=Number(e[1]),u=Number(e[2])-1,v=Number(e[3]),f=Number(e[4]),y=Number(e[5]),_=Number(e[6]||"0");return new Date(Date.UTC(l,u,v,f-8,y,_))}const o=s.includes("T")?s:s.replace(" ","T"),n=new Date(o);return isNaN(n.getTime())?null:n},re=s=>{if(!s)return"--";try{const o=new Date(s);if(!isNaN(o.getTime()))return o.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!0,timeZone:"Asia/Manila"})}catch{}const e=s.match(/\b(\d{1,2}):(\d{2})(?::(\d{2}))?/);if(e){let o=parseInt(e[1],10);const n=e[2],l=o>=12?"PM":"AM";return o=o%12,o===0&&(o=12),`${o}:${n} ${l}`}return"--"},V=s=>{const e=typeof s=="number"&&isFinite(s)?Math.max(0,Math.floor(s)):0,o=Math.floor(e/3600),n=Math.floor(e%3600/60),l=e%60,u=v=>v<10?`0${v}`:`${v}`;return`${u(o)}:${u(n)}:${u(l)}`},st=s=>{if(!s)return"--";const e=new Date(s);return isNaN(e.getTime())?s:e.toLocaleDateString("en-US",{month:"short",day:"2-digit",year:"numeric"})},at=s=>{if(!s||s===0)return"--";const e=Math.floor(s/1e3);return V(e)},ot=s=>{if(!s)return"";const e=s.toLowerCase().trim();return e==="to do"||e==="todo"?"text-gray-700":e.includes("complete")||e.includes("done")||e.includes("finished")?"bg-green-100 text-green-800":e.includes("progress")||e.includes("doing")||e.includes("in progress")||e.includes("working")?"bg-blue-100 text-blue-800":e.includes("pending")||e.includes("waiting")?"bg-yellow-100 text-yellow-800":e.includes("blocked")||e.includes("stuck")?"bg-red-100 text-red-800":e.includes("review")||e.includes("testing")?"bg-purple-100 text-purple-800":e.includes("cancel")||e.includes("closed")?"bg-gray-100 text-gray-800":"bg-indigo-100 text-indigo-800"},At=s=>{if(!s)return"bg-gray-100 text-gray-800";const e=s.toLowerCase().trim();return e==="urgent"||e==="critical"?"bg-red-100 text-red-800":e==="high"?"bg-orange-100 text-orange-800":e==="normal"||e==="medium"?"bg-yellow-100 text-yellow-800":e==="low"?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"},nt=s=>{if(!s)return!1;const e=s.toLowerCase().trim();return e!=="to do"&&e!=="todo"},Ft=s=>{if(!s)return"";const e=s.split(`
`),o=[];let n=!1,l=[];for(let v=0;v<e.length;v++){const f=e[v].trim();if(!f){n&&l.length>0&&(o.push(`<ul class="list-disc ml-6 mb-3 space-y-1">${l.join("")}</ul>`),l=[],n=!1),o.length>0&&!o[o.length-1].startsWith("<")&&o.push('</p><p class="mb-2">');continue}if(f.match(/^#{1,3}\s+/)){n&&l.length>0&&(o.push(`<ul class="list-disc ml-6 mb-3 space-y-1">${l.join("")}</ul>`),l=[],n=!1),f.startsWith("###")?o.push(`<h3 class="font-semibold text-gray-900 mt-4 mb-2 text-base">${f.replace(/^###\s+/,"")}</h3>`):f.startsWith("##")?o.push(`<h2 class="font-bold text-gray-900 mt-5 mb-3 text-lg">${f.replace(/^##\s+/,"")}</h2>`):f.startsWith("#")&&o.push(`<h1 class="font-bold text-gray-900 mt-6 mb-4 text-xl">${f.replace(/^#\s+/,"")}</h1>`);continue}if(f.match(/^[\-\*â€¢]\s+/)){n||(n=!0);const _=f.replace(/^[\-\*â€¢]\s+/,"").trim();l.push(`<li class="mb-1">${_}</li>`);continue}if(f.match(/^\d+\.\s+/)){n||(n=!0);const _=f.replace(/^\d+\.\s+/,"").trim();l.push(`<li class="mb-1 list-decimal">${_}</li>`);continue}n&&l.length>0&&(o.push(`<ul class="list-disc ml-6 mb-3 space-y-1">${l.join("")}</ul>`),l=[],n=!1);let y=f.replace(/\*\*(.+?)\*\*/g,'<strong class="font-semibold">$1</strong>').replace(/\*(.+?)\*/g,'<em class="italic">$1</em>');o.push(y)}n&&l.length>0&&o.push(`<ul class="list-disc ml-6 mb-3 space-y-1">${l.join("")}</ul>`);let u=o.join("<br>");return u.startsWith("<")||(u='<p class="mb-2">'+u),u.endsWith(">")||(u=u+"</p>"),u};return(s,e)=>(r(),i(P,null,[lt(Yt(Kt),{title:"Dashboard"}),lt(Gt,null,{header:it(()=>[...e[23]||(e[23]=[t("h2",{class:"text-xl font-semibold leading-tight text-gray-800"}," Time Tracker Dashboard ",-1)])]),default:it(()=>{var o,n,l,u,v,f,y,_,S,m,k,L,b;return[t("div",Jt,[t("div",Qt,[F.value!=="admin"?(r(),i("div",Xt,[t("nav",es,[t("button",{onClick:e[0]||(e[0]=a=>le.value="dashboard"),class:A(["whitespace-nowrap border-b-2 py-4 px-1 text-sm font-medium",le.value==="dashboard"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700"])}," Dashboard ",2),t("button",{onClick:e[1]||(e[1]=a=>{le.value="time-entries",tt()}),class:A(["whitespace-nowrap border-b-2 py-4 px-1 text-sm font-medium",le.value==="time-entries"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700"])}," Time Entries ",2)])])):x("",!0),le.value==="dashboard"||F.value==="admin"||F.value==="developer"?(r(),i("div",ts,[F.value!=="admin"?(r(),i("div",ss,[t("div",as,[t("div",os,[e[25]||(e[25]=t("h3",{class:"text-xs font-semibold uppercase tracking-wide text-gray-500"},"Work Day Timer",-1)),t("p",ns,d($t.value),1),t("p",ls,d(R.value?"Working":"Idle"),1),O.value?(r(),i("div",is,[t("p",rs,[e[24]||(e[24]=Ie("Break Timer: ",-1)),t("span",ds,d(Et.value),1)])])):x("",!0),t("div",us,[t("button",{onClick:Tt,disabled:$.value,class:A(["rounded-md px-3 py-1.5 text-xs font-semibold text-white",R.value?"bg-red-600 hover:bg-red-700":"bg-green-600 hover:bg-green-700"])},d(R.value?"Time Out":"Time In"),11,cs),t("button",{onClick:Dt,disabled:$.value,class:A(["rounded-md px-3 py-1.5 text-xs font-semibold text-white",O.value?"bg-orange-600 hover:bg-orange-700":"bg-yellow-600 hover:bg-yellow-700"])},d(O.value?"Break Out":"Break In"),11,ms)])])]),t("div",ps,[t("div",vs,[e[27]||(e[27]=t("h3",{class:"text-xs font-semibold uppercase tracking-wide text-gray-500"},"Running Task",-1)),M.value?(r(),i("div",gs,[t("button",{onClick:e[2]||(e[2]=a=>Qe(M.value)),class:"text-indigo-600 hover:underline text-sm"},d(((o=Y.value.find(a=>a.id===M.value))==null?void 0:o.title)||"#"+M.value),1),t("p",xs,[Ie(d(It.value),1),(n=Y.value.find(a=>a.id===M.value))!=null&&n.estimated_time?(r(),i("span",ys," / "+d(at((l=Y.value.find(a=>a.id===M.value))==null?void 0:l.estimated_time)),1)):x("",!0)]),t("div",fs,[t("button",{onClick:e[3]||(e[3]=a=>et()),disabled:$.value,class:"rounded-md bg-yellow-600 px-3 py-1.5 text-xs font-semibold text-white hover:bg-yellow-700"},"Pause",8,hs)])])):(r(),i("div",ks,[t("div",bs,[X(t("select",{"onUpdate:modelValue":e[4]||(e[4]=a=>de.value=a),class:"w-full rounded-md border-gray-300 text-sm shadow-sm"},[e[26]||(e[26]=t("option",{value:null},"Select a task",-1)),(r(!0),i(P,null,j(Y.value,a=>(r(),i("option",{key:a.id,value:a.id},d(a.title),9,_s))),128))],512),[[Le,de.value]]),t("button",{onClick:e[5]||(e[5]=a=>de.value?Xe(de.value):void 0),disabled:$.value||!de.value,class:"rounded-md bg-green-600 px-3 py-1.5 text-xs font-semibold text-white hover:bg-green-700 disabled:opacity-50"},"Start",8,ws)]),Y.value.length?x("",!0):(r(),i("p",Ss,"No tasks available."))]))])]),t("div",Ts,[t("div",Ds,[e[29]||(e[29]=t("h3",{class:"text-xs font-semibold uppercase tracking-wide text-gray-500"},"Daily Logs",-1)),t("p",Ms,[Ie(d(Lt.value),1),e[28]||(e[28]=t("span",{class:"text-sm font-normal text-gray-500"}," / 8 Hours",-1))]),t("div",{class:"mt-4 flex space-x-2"},[t("button",{onClick:Bt,class:"rounded-md bg-indigo-600 px-3 py-1.5 text-xs font-semibold text-white hover:bg-indigo-700"},"Daily Logs")])])])])):x("",!0),F.value==="admin"?(r(),i("div",Cs,[t("div",Ns,[t("div",$s,[e[30]||(e[30]=t("h3",{class:"text-lg font-medium leading-6 text-gray-900"},"Real-Time Activity Log",-1)),t("button",{onClick:Oe,disabled:Me.value,class:"rounded-md bg-indigo-600 px-3 py-1.5 text-xs font-semibold text-white hover:bg-indigo-500"},"Refresh",8,Es)]),t("div",Is,[t("table",Ls,[e[32]||(e[32]=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"User"),t("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Action"),t("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Description"),t("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Time")])],-1)),t("tbody",Bs,[(r(!0),i(P,null,j(De.value,a=>{var h;return r(),i("tr",{key:a.id},[t("td",Ps,d(((h=a.user)==null?void 0:h.name)||"Unknown"),1),t("td",Us,d(a.action),1),t("td",js,d(a.description),1),t("td",Hs,d(new Date(a.created_at).toLocaleString()),1)])}),128)),De.value.length===0&&!Me.value?(r(),i("tr",Ws,[...e[31]||(e[31]=[t("td",{colspan:"4",class:"px-4 py-4 text-center text-sm text-gray-500"},"No activity logs found",-1)])])):x("",!0)])])])])])):x("",!0),F.value!=="admin"?(r(),i("div",Os,[t("div",As,[t("div",Fs,[e[36]||(e[36]=t("h3",{class:"text-lg font-medium leading-6 text-gray-900"},"My Tasks",-1)),t("div",Rs,[t("button",{onClick:ft,disabled:fe.value,class:"rounded-md bg-green-600 px-3 py-1.5 text-xs font-semibold text-white hover:bg-green-700 disabled:opacity-60 disabled:cursor-not-allowed flex items-center gap-2"},[fe.value?(r(),i("span",qs)):x("",!0),t("span",null,d(fe.value?"Syncingâ€¦":"Refresh from ClickUp"),1)],8,Vs),X(t("input",{"onUpdate:modelValue":e[6]||(e[6]=a=>He.value=a),onInput:e[7]||(e[7]=a=>Z(1)),type:"text",placeholder:"Search tasks",class:"rounded-md border-gray-300 text-sm shadow-sm"},null,544),[[Be,He.value]]),X(t("select",{"onUpdate:modelValue":e[8]||(e[8]=a=>ke.value=a),onChange:e[9]||(e[9]=a=>Z(1)),class:"rounded-md border-gray-300 text-sm shadow-sm"},[e[33]||(e[33]=t("option",{value:"all"},"All",-1)),(r(!0),i(P,null,j(be.value,a=>(r(),i("option",{key:a,value:a},d(a),9,zs))),128))],544),[[Le,ke.value]]),X(t("select",{"onUpdate:modelValue":e[10]||(e[10]=a=>_e.value=a),onChange:e[11]||(e[11]=a=>Z(1)),class:"rounded-md border-gray-300 text-sm shadow-sm"},[...e[34]||(e[34]=[t("option",{value:"all"},"All priorities",-1),t("option",{value:"urgent"},"Urgent",-1),t("option",{value:"high"},"High",-1),t("option",{value:"normal"},"Normal",-1),t("option",{value:"low"},"Low",-1),t("option",{value:"none"},"None",-1)])],544),[[Le,_e.value]]),X(t("input",{"onUpdate:modelValue":e[12]||(e[12]=a=>we.value=a),onChange:e[13]||(e[13]=a=>Z(1)),type:"date",class:"rounded-md border-gray-300 text-sm shadow-sm"},null,544),[[Be,we.value]]),X(t("input",{"onUpdate:modelValue":e[14]||(e[14]=a=>Se.value=a),onChange:e[15]||(e[15]=a=>Z(1)),type:"date",class:"rounded-md border-gray-300 text-sm shadow-sm"},null,544),[[Be,Se.value]]),X(t("select",{"onUpdate:modelValue":e[16]||(e[16]=a=>ce.value=a),onChange:e[17]||(e[17]=a=>Z(1)),class:"rounded-md border-gray-300 text-sm shadow-sm"},[...e[35]||(e[35]=[t("option",{value:5},"5",-1),t("option",{value:10},"10",-1),t("option",{value:20},"20",-1),t("option",{value:50},"50",-1)])],544),[[Le,ce.value,void 0,{number:!0}]])])]),t("div",Ys,[t("table",Ks,[e[40]||(e[40]=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Task"),t("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Campaign"),t("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Parent Task"),t("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Status"),t("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Due Date"),t("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Estimated Time"),t("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Priority"),t("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Actions")])],-1)),t("tbody",Zs,[(r(!0),i(P,null,j(ut.value,a=>(r(),i("tr",{key:a.id},[t("td",Gs,[t("button",{onClick:h=>Qe(a.id),class:"hover:underline"},d(a.title),9,Js)]),t("td",Qs,d(a.clickup_list_name||"--"),1),t("td",Xs,d(a.parent_task_name||"N/A"),1),t("td",ea,[nt(a.status)?(r(),i("span",{key:0,class:A(["inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-semibold",ot(a.status)])},d(a.status||"â€”"),3)):(r(),i("span",ta,d(a.status||"â€”"),1))]),t("td",sa,d(a.due_date?new Date(a.due_date).toLocaleDateString():"--"),1),t("td",aa,d(at(a.estimated_time)),1),t("td",oa,[t("span",{class:A(["inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-semibold",At(a.priority||null)])},d(a.priority||"None"),3)]),t("td",na,[t("div",la,[t("button",{onClick:h=>M.value===a.id?et():Xe(a.id),disabled:$.value,class:A(["rounded-full p-2 text-white",M.value===a.id?"bg-yellow-600 hover:bg-yellow-700":"bg-green-600 hover:bg-green-700"]),"aria-label":M.value===a.id?"Pause":"Play"},[M.value!==a.id?(r(),i("svg",ra,[...e[37]||(e[37]=[t("path",{d:"M8 5v14l11-7z"},null,-1)])])):(r(),i("svg",da,[...e[38]||(e[38]=[t("path",{d:"M6 5h4v14H6zM14 5h4v14h-4z"},null,-1)])]))],10,ia),t("select",{value:a.status||"",onChange:h=>Ot(a.id,h.target.value),class:"rounded-md border-gray-300 text-xs shadow-sm"},[e[39]||(e[39]=t("option",{disabled:"",value:""},"Set statusâ€¦",-1)),(r(!0),i(P,null,j(be.value,h=>(r(),i("option",{key:h+a.id,value:h},d(h),9,ca))),128)),be.value.includes("complete")?x("",!0):(r(),i("option",ma,"complete")),be.value.includes("done")?x("",!0):(r(),i("option",pa,"done"))],40,ua)])])]))),128))])]),t("div",va,[t("div",null," Page "+d(se.value)+" of "+d(Te.value)+" â€¢ "+d(We.value.length)+" total ",1),t("div",ga,[t("button",{onClick:e[18]||(e[18]=a=>Z(se.value-1)),disabled:se.value<=1,class:"rounded-md border px-3 py-1 disabled:opacity-50"},"Prev",8,xa),t("button",{onClick:e[19]||(e[19]=a=>Z(se.value+1)),disabled:se.value>=Te.value,class:"rounded-md border px-3 py-1 disabled:opacity-50"},"Next",8,ya)])])])])])):x("",!0),t("div",fa,[t("div",ha,[e[42]||(e[42]=t("h3",{class:"text-lg font-medium leading-6 text-gray-900 mb-4"},"Today's Time Events",-1)),$e.value.length===0?(r(),i("div",ka," No time entries recorded today. Clock in to start tracking time. ")):(r(),i("div",ba,[t("table",_a,[e[41]||(e[41]=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Task"),t("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Start Time"),t("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"End Time"),t("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Duration"),t("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Break Duration"),t("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Notes")])],-1)),t("tbody",wa,[(r(!0),i(P,null,j($e.value,(a,h)=>(r(),i("tr",{key:h},[t("td",Sa,d(a.name),1),t("td",Ta,d(re(a.start)),1),t("td",Da,d(re(a.end)),1),t("td",Ma,d(V(a.durationSeconds)),1),t("td",Ca,d(V(a.breakDurationSeconds||0)),1),t("td",Na,d(a.notes||"-"),1)]))),128))])])]))])])])):x("",!0),le.value==="time-entries"&&F.value!=="admin"?(r(),i("div",$a,[t("div",Ea,[t("div",Ia,[t("div",null,[e[43]||(e[43]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Date",-1)),X(t("input",{"onUpdate:modelValue":e[20]||(e[20]=a=>te.value=a),onChange:tt,type:"date",class:"w-full rounded-md border-gray-300 shadow-sm"},null,544),[[Be,te.value]])])])]),t("div",La,[e[49]||(e[49]=t("h3",{class:"text-lg font-medium leading-6 text-gray-900 mb-4"},"Daily Summary",-1)),t("div",Ba,[t("div",null,[e[44]||(e[44]=t("div",{class:"text-gray-500"},"ðŸ•’ Time In Hours",-1)),t("div",Pa,d(V(W.value.workSeconds)),1)]),t("div",null,[e[45]||(e[45]=t("div",{class:"text-gray-500"},"â˜• Total Breaks",-1)),t("div",Ua,d(V(W.value.breakSeconds)),1)]),t("div",null,[e[46]||(e[46]=t("div",{class:"text-gray-500"},"ðŸ“‹ Entries",-1)),t("div",ja,d(W.value.tasksCount),1)]),t("div",null,[e[47]||(e[47]=t("div",{class:"text-gray-500"},"â° Status",-1)),t("div",{class:A(["font-semibold",{"text-green-700":W.value.status==="Perfect","text-yellow-700":W.value.status==="Late","text-gray-700":W.value.status==="No Entry"}])},d(W.value.status),3)]),t("div",null,[e[48]||(e[48]=t("div",{class:"text-gray-500"},"âš¡ Overtime",-1)),t("div",Ha,d(V(W.value.overtimeSeconds)),1)])])]),t("div",Wa,[t("div",Oa,[t("table",Aa,[e[51]||(e[51]=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Task"),t("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Start Time"),t("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"End Time"),t("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Duration"),t("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Break Duration"),t("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Notes")])],-1)),t("tbody",Fa,[(r(!0),i(P,null,j(B.value,(a,h)=>(r(),i("tr",{key:h},[t("td",Ra,d(a.name),1),t("td",Va,d(re(a.start)),1),t("td",qa,d(re(a.end)),1),t("td",za,d(V(a.durationSeconds)),1),t("td",Ya,d(V(a.breakDurationSeconds||0)),1),t("td",Ka,d(a.notes||"-"),1)]))),128)),B.value.length===0&&!he.value?(r(),i("tr",Za,[...e[50]||(e[50]=[t("td",{colspan:"6",class:"px-4 py-4 text-center text-sm text-gray-500"},"No entries for selected day",-1)])])):x("",!0)])])]),he.value?(r(),i("div",Ga,[...e[52]||(e[52]=[t("div",{class:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600"},null,-1),t("p",{class:"mt-2 text-sm text-gray-500"},"Loading...",-1)])])):x("",!0)])])):x("",!0)]),Pe.value?(r(),i("div",Ja,[t("div",Qa,[t("div",Xa,[e[53]||(e[53]=t("h4",{class:"text-md font-semibold"},"Daily Logs",-1)),t("button",{onClick:e[21]||(e[21]=a=>Pe.value=!1),class:"rounded-md bg-gray-100 px-2 py-1 text-xs"},"Close")]),t("div",eo,[$e.value.length===0?(r(),i("div",to,"No entry today.")):(r(),i("div",so,[t("table",ao,[e[54]||(e[54]=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{class:"px-4 py-2 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Task"),t("th",{class:"px-4 py-2 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Start Time"),t("th",{class:"px-4 py-2 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"End Time"),t("th",{class:"px-4 py-2 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Duration"),t("th",{class:"px-4 py-2 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Break Duration"),t("th",{class:"px-4 py-2 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Notes")])],-1)),t("tbody",oo,[(r(!0),i(P,null,j($e.value,(a,h)=>(r(),i("tr",{key:h},[t("td",no,d(a.name),1),t("td",lo,d(re(a.start)),1),t("td",io,d(re(a.end)),1),t("td",ro,d(V(a.durationSeconds)),1),t("td",uo,d(V(a.breakDurationSeconds||0)),1),t("td",co,d(a.notes||"-"),1)]))),128))])])]))])])])):x("",!0),ue.value?(r(),i("div",mo,[t("div",po,[t("div",vo,[e[55]||(e[55]=t("h4",{class:"text-md font-semibold text-gray-900"},"Sync ClickUp Spaces",-1)),t("button",{onClick:_t,disabled:q.value&&((u=p.value)==null?void 0:u.status)==="syncing",class:"rounded-md bg-gray-100 px-2 py-1 text-xs hover:bg-gray-200 disabled:opacity-50"},"Cancel",8,go)]),t("div",xo,[p.value?(r(),i("div",yo,[t("div",fo,[t("div",ho,[t("span",ko," Space "+d(p.value.current)+" of "+d(p.value.total),1),t("span",bo,d(Math.round(p.value.current/p.value.total*100))+"% ",1)]),t("div",_o,[t("div",{class:"bg-indigo-600 h-2 rounded-full transition-all duration-300",style:Zt({width:`${p.value.current/p.value.total*100}%`})},null,4)])]),t("div",{class:A(["rounded-md border p-4 space-y-3",{"border-blue-200 bg-blue-50":p.value.status==="checking","border-green-200 bg-green-50":p.value.status==="completed","border-yellow-200 bg-yellow-50":p.value.status==="skipped","border-red-200 bg-red-50":p.value.status==="error","border-indigo-200 bg-indigo-50":p.value.status==="syncing"}])},[t("div",wo,[p.value.status==="checking"||p.value.status==="syncing"?(r(),i("span",So)):p.value.status==="completed"?(r(),i("span",To,"âœ“")):p.value.status==="skipped"?(r(),i("span",Do,"âŠ˜")):p.value.status==="error"?(r(),i("span",Mo,"âœ—")):x("",!0),t("h5",Co,d(p.value.spaceName),1)]),p.value.status==="checking"&&((v=I.value)==null?void 0:v.is_member)===!0?(r(),i("div",No,[e[56]||(e[56]=t("p",{class:"text-sm text-gray-700"},"You are a member of this space. Would you like to sync tasks from it?",-1)),t("div",{class:"flex gap-2"},[t("button",{onClick:kt,class:"flex-1 rounded-md bg-indigo-600 px-3 py-2 text-xs font-semibold text-white hover:bg-indigo-700"}," Yes, Sync This Space "),t("button",{onClick:bt,class:"flex-1 rounded-md bg-gray-200 px-3 py-2 text-xs font-medium text-gray-700 hover:bg-gray-300"}," Skip ")])])):p.value.status==="checking"&&((f=I.value)==null?void 0:f.is_member)===!1?(r(),i("div",$o," You are not a member of this space. Skipping... ")):p.value.status==="syncing"?(r(),i("div",Eo," Syncing tasks from this space... ")):p.value.status==="completed"&&p.value.result?(r(),i("div",Io,[e[57]||(e[57]=t("div",{class:"font-medium text-green-700"},"Sync completed!",-1)),t("div",Lo," Created: "+d(((y=p.value.result.summary)==null?void 0:y.created)||0)+", Updated: "+d(((_=p.value.result.summary)==null?void 0:_.updated)||0)+", Unchanged: "+d(((S=p.value.result.summary)==null?void 0:S.unchanged)||0),1)])):p.value.status==="skipped"?(r(),i("div",Bo," This space was skipped. ")):p.value.status==="error"?(r(),i("div",Po," An error occurred while processing this space. ")):x("",!0)],2)])):x("",!0),w.value.length>0?(r(),i("div",Uo,[e[58]||(e[58]=t("h6",{class:"text-xs font-medium text-gray-600 mb-2"},"Completed Spaces:",-1)),t("div",jo,[(r(!0),i(P,null,j(w.value,(a,h)=>{var Q,C,D,ge,xe,Ee;return r(),i("div",{key:h,class:"flex items-center justify-between p-2 rounded bg-gray-50"},[t("span",Ho,d(a.name),1),t("span",{class:A(["px-2 py-0.5 rounded text-xs font-medium",{"bg-green-100 text-green-700":(Q=a.result)==null?void 0:Q.ok,"bg-yellow-100 text-yellow-700":(C=a.result)==null?void 0:C.skipped,"bg-red-100 text-red-700":!((D=a.result)!=null&&D.ok)&&!((ge=a.result)!=null&&ge.skipped)}])},d((xe=a.result)!=null&&xe.ok?"Synced":(Ee=a.result)!=null&&Ee.skipped?"Skipped":"Error"),3)])}),128))])])):x("",!0),!p.value&&q.value?(r(),i("div",Wo,[...e[59]||(e[59]=[t("span",{class:"h-3 w-3 rounded-full border-2 border-gray-300 border-t-indigo-600 animate-spin"},null,-1),t("span",null,"Initializing space sync...",-1)])])):x("",!0)])])])):x("",!0),je.value&&E.value?(r(),i("div",Oo,[t("div",Ao,[t("div",{class:"flex items-center justify-between border-b px-4 py-3"},[e[60]||(e[60]=t("h4",{class:"text-md font-semibold"},"ClickUp Sync Summary",-1)),t("button",{onClick:yt,class:"rounded-md bg-gray-100 px-2 py-1 text-xs hover:bg-gray-200"},"Close")]),t("div",Fo,[t("div",Ro,[e[62]||(e[62]=t("p",null,"Latest sync completed successfully.",-1)),E.value.sources.length?(r(),i("p",Vo,[e[61]||(e[61]=Ie(" Sources: ",-1)),t("span",qo,d(E.value.sources.join(", ")),1)])):x("",!0)]),t("div",zo,[t("div",Yo,[e[63]||(e[63]=t("div",{class:"text-xs uppercase tracking-wide text-indigo-600"},"Total Processed",-1)),t("div",Ko,d(E.value.summary.total),1)]),t("div",Zo,[e[64]||(e[64]=t("div",{class:"text-xs uppercase tracking-wide text-green-600"},"Created",-1)),t("div",Go,d(E.value.summary.created),1)]),t("div",Jo,[e[65]||(e[65]=t("div",{class:"text-xs uppercase tracking-wide text-blue-600"},"Updated",-1)),t("div",Qo,d(E.value.summary.updated),1)]),t("div",Xo,[e[66]||(e[66]=t("div",{class:"text-xs uppercase tracking-wide text-gray-600"},"No Changes",-1)),t("div",en,d(E.value.summary.unchanged),1)]),t("div",tn,[e[67]||(e[67]=t("div",{class:"text-xs uppercase tracking-wide text-amber-600"},"Skipped",-1)),t("div",sn,d(E.value.summary.skipped),1)])]),E.value.created.length?(r(),i("div",an,[e[68]||(e[68]=t("h5",{class:"text-sm font-semibold text-gray-900"},"New tasks",-1)),t("ul",on,[(r(!0),i(P,null,j(E.value.created,a=>(r(),i("li",{key:"created-"+a.id,class:"rounded-md border border-green-200 bg-green-50 px-3 py-2"},[t("div",nn,[t("span",ln,d(a.title),1),t("span",rn,d(st(a.due_date)),1)]),t("div",dn,[a.status?(r(),i("span",un,"Status: "+d(a.status),1)):x("",!0),a.priority?(r(),i("span",cn,"Priority: "+d(a.priority),1)):x("",!0)])]))),128))])])):x("",!0),E.value.updated.length?(r(),i("div",mn,[e[69]||(e[69]=t("h5",{class:"text-sm font-semibold text-gray-900"},"Updated tasks",-1)),t("ul",pn,[(r(!0),i(P,null,j(E.value.updated,a=>(r(),i("li",{key:"updated-"+a.id,class:"rounded-md border border-blue-200 bg-blue-50 px-3 py-2"},[t("div",vn,[t("span",gn,d(a.title),1),t("span",xn,d(st(a.due_date)),1)]),t("div",yn,[a.status?(r(),i("span",fn,"Status: "+d(a.status),1)):x("",!0),a.priority?(r(),i("span",hn,"Priority: "+d(a.priority),1)):x("",!0)])]))),128))])])):x("",!0),E.value.skipped.length?(r(),i("div",kn,[e[70]||(e[70]=t("h5",{class:"text-sm font-semibold text-gray-900"},"Skipped items",-1)),t("ul",bn,[(r(!0),i(P,null,j(E.value.skipped,a=>(r(),i("li",{key:"skipped-"+a.id,class:"rounded-md border border-amber-200 bg-amber-50 px-3 py-2 text-xs text-amber-900"},[t("div",_n,[t("span",wn,d(a.id),1),t("span",Sn,d(a.reason),1)])]))),128))])])):x("",!0)])])])):x("",!0),ye.value?(r(),i("div",Tn,[t("div",Dn,[t("div",Mn,[e[71]||(e[71]=t("h4",{class:"text-md font-semibold"},"Task Details",-1)),t("button",{onClick:e[22]||(e[22]=a=>ye.value=!1),class:"rounded-md bg-gray-100 px-2 py-1 text-xs hover:bg-gray-200"},"Close")]),U.value?(r(),i("div",Cn,[t("div",Nn,[t("h2",$n,d((m=U.value.task)==null?void 0:m.title),1),t("div",En,[(k=U.value.task)!=null&&k.status?(r(),i("span",In,[e[72]||(e[72]=t("span",{class:"text-gray-600"},"Status:",-1)),nt(U.value.task.status)?(r(),i("span",{key:0,class:A(["inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-semibold ml-1",ot(U.value.task.status)])},d(U.value.task.status),3)):(r(),i("span",Ln,d(U.value.task.status),1))])):x("",!0),(L=U.value.clickup)!=null&&L.url?(r(),i("span",Bn,[t("a",{href:U.value.clickup.url,target:"_blank",class:"text-indigo-600 hover:underline text-sm font-medium"},"Open in ClickUp â†’",8,Pn)])):x("",!0)])]),(b=U.value.clickup)!=null&&b.text_content?(r(),i("div",Un,[t("div",{innerHTML:Ft(U.value.clickup.text_content),class:"prose prose-sm max-w-none"},null,8,jn)])):(r(),i("div",Hn," No additional details available. "))])):x("",!0)])])):x("",!0)])]}),_:1})],64))}});export{Rn as default};
