import{d as Nt,r as d,c as nt,o as Lt,w as X,a as r,b as bt,u as Et,h as At,e as ft,f as t,g as k,n as C,i as l,t as n,j as Y,F as w,k as T,l as q,v as _t,m as it}from"./app-D-IFITG_.js";import{_ as $t}from"./AuthenticatedLayout.vue_vue_type_script_setup_true_lang-DJ0xeEPs.js";import{a as z}from"./api-BX-Iyv_S.js";const Wt={class:"py-12"},Ft={class:"mx-auto max-w-7xl sm:px-6 lg:px-8"},Bt={class:"border-b border-gray-200 mb-6"},Pt={class:"-mb-px flex space-x-8"},Rt={key:0,class:"space-y-8"},It={class:"space-y-6"},Vt={class:"flex flex-wrap items-center justify-between gap-3"},Ot={key:0,class:"text-sm text-gray-500"},jt={class:"flex items-center gap-2"},qt=["disabled"],zt={key:0,class:"h-3 w-3 animate-spin rounded-full border-2 border-indigo-500 border-t-transparent"},Zt={key:0,class:"bg-white shadow rounded-lg p-10 text-center text-sm text-gray-500"},Gt={key:1,class:"bg-red-50 border border-red-200 text-red-700 rounded-lg p-6 flex flex-col gap-4"},Qt={class:"text-sm"},Jt={key:2,class:"space-y-8"},Kt={class:"grid gap-4 md:grid-cols-2 xl:grid-cols-3"},Xt={class:"text-sm font-semibold uppercase tracking-wide text-gray-500"},Yt={class:"mt-2 text-3xl font-bold"},te={class:"mt-2 text-sm text-gray-600"},ee={class:"grid gap-6 lg:grid-cols-2"},se={class:"rounded-xl bg-white shadow-sm"},ae={class:"border-b border-gray-100 px-5 py-4"},oe={class:"text-sm text-gray-500"},re={key:0,class:"divide-y divide-gray-100"},le={class:"font-medium text-gray-900"},ne={class:"text-sm text-gray-500"},ie={key:0,class:"ml-1 text-gray-400"},de={class:"text-right"},ue={class:"text-sm font-semibold text-indigo-600"},ce={class:"text-xs text-gray-500"},me={key:1,class:"px-5 py-6 text-sm text-gray-500"},ve={class:"rounded-xl bg-white shadow-sm"},xe={class:"space-y-4 px-5 py-6"},ge={class:"text-sm font-medium text-gray-600"},pe={class:"text-sm font-semibold text-gray-900 text-right"},ye={key:1,class:"space-y-6"},he={class:"bg-white shadow rounded-lg p-4"},be={class:"grid gap-4 sm:grid-cols-3"},fe=["value"],_e={class:"flex items-end gap-2"},ke=["disabled"],we=["disabled"],Se={class:"bg-white shadow rounded-lg p-5"},Te={class:"grid gap-4 sm:grid-cols-3 lg:grid-cols-5 text-sm"},De={class:"font-semibold"},Ue={class:"font-semibold"},He={class:"font-semibold"},Ce={class:"font-semibold"},Me={class:"bg-white shadow rounded-lg"},Ne={class:"overflow-x-auto"},Le={class:"min-w-full divide-y divide-gray-200"},Ee={class:"divide-y divide-gray-200"},Ae={class:"px-4 py-4 text-sm text-gray-900"},$e={class:"px-4 py-4 text-sm text-gray-500"},We={class:"px-4 py-4 text-sm text-gray-500"},Fe={class:"px-4 py-4 text-sm text-gray-900 font-semibold"},Be={class:"px-4 py-4 text-sm text-gray-500"},Pe={class:"px-4 py-4 text-sm text-gray-500"},Re={key:0},Ie={key:0,class:"text-center py-8"},Ve={key:2,class:"space-y-6"},Oe={class:"bg-white shadow rounded-lg p-4"},je={class:"flex justify-between items-center mb-4"},qe={class:"flex items-center gap-2"},ze={class:"grid gap-4 sm:grid-cols-2"},Ze={class:"bg-white shadow rounded-lg"},Ge={class:"overflow-x-auto"},Qe={class:"min-w-full divide-y divide-gray-200"},Je={class:"divide-y divide-gray-200 bg-white"},Ke={class:"px-4 py-4 whitespace-nowrap"},Xe={class:"flex items-center"},Ye={class:"flex-shrink-0 h-10 w-10"},ts={class:"h-10 w-10 rounded-full bg-indigo-100 flex items-center justify-center"},es={class:"text-indigo-600 font-medium"},ss={class:"ml-4"},as={class:"text-sm font-medium text-gray-900"},os={class:"text-sm text-gray-500"},rs={class:"px-4 py-4 whitespace-nowrap"},ls={class:"px-4 py-4"},ns={class:"text-sm text-gray-900"},is={class:"px-4 py-4 whitespace-nowrap text-sm text-gray-500"},ds={class:"text-xs text-gray-400"},us={key:0},cs={key:0,class:"text-center py-8"},ms={key:3,class:"space-y-6"},vs={class:"bg-white shadow rounded-lg p-4 flex flex-wrap items-end gap-4"},xs={class:"ml-auto flex flex-wrap items-end gap-3"},gs=["disabled"],ps={key:0,class:"h-3 w-3 animate-spin rounded-full border-2 border-white border-t-transparent"},ys={key:0,class:"bg-red-50 border border-red-200 text-red-700 rounded-lg p-4"},hs={class:"text-sm"},bs={key:1,class:"bg-white shadow rounded-lg"},fs={key:0,class:"p-8 text-center text-sm text-gray-500"},_s={key:1,class:"p-8 text-center text-sm text-gray-500"},ks={key:2,class:"overflow-x-auto"},ws={class:"min-w-full divide-y divide-gray-200"},Ss={class:"bg-gray-50"},Ts={class:"divide-y divide-gray-200 bg-white"},Ds={class:"px-4 py-3 text-sm text-gray-900 whitespace-nowrap"},Us={key:0},Hs={class:"font-medium text-indigo-700"},Cs={class:"text-gray-600"},Ms={key:1,class:"text-gray-300"},Ns={class:"px-4 py-3 text-sm text-right text-gray-900 whitespace-nowrap"},Ls={class:"px-4 py-3 text-sm text-right text-gray-900 whitespace-nowrap"},Es="Asia/Manila",Bs=Nt({__name:"Analytics",setup(As){const g=d(null),tt=d(!0),Z=d(null),F=d(!1),et=async()=>{var a,e;try{Z.value=null;const{data:s}=await z.get("/admin/analytics/summary");g.value=s}catch(s){console.error(s),Z.value=((e=(a=s==null?void 0:s.response)==null?void 0:a.data)==null?void 0:e.error)||"Unable to load analytics summary.",g.value=null}finally{tt.value=!1,F.value=!1}},dt=async()=>{F.value=!0,await et()},st=a=>`${a.toFixed(2)} h`,B=a=>a.toLocaleString(),at=a=>new Date(a).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),ut=a=>new Date(a).toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"}),kt=a=>{if(a===null)return"--";const e=Math.floor(a/60),s=a%60;return e===0?`${s}m`:`${e}h ${s}m`},wt=a=>a?new Date(a).toLocaleString("en-US",{hour:"numeric",minute:"2-digit"}):"--",St=nt(()=>{if(!g.value)return[];const a=g.value.totals;return[{title:"Hours Logged Today",value:st(a.hours_today),subtitle:"Completed work hours",accent:"border-blue-500 bg-blue-50 text-blue-700"},{title:"Hours Logged This Week",value:st(a.hours_week),subtitle:"Monâ€“Sun total",accent:"border-indigo-500 bg-indigo-50 text-indigo-700"},{title:"Active Users Today",value:B(a.active_users_today),subtitle:"Unique employees with activity",accent:"border-emerald-500 bg-emerald-50 text-emerald-700"},{title:"Active Users This Week",value:B(a.active_users_week),subtitle:"Unique employees this week",accent:"border-teal-500 bg-teal-50 text-teal-700"},{title:"Avg Hours / User (Week)",value:st(a.average_hours_per_user_week),subtitle:"Hours per active user",accent:"border-purple-500 bg-purple-50 text-purple-700"},{title:"Open Clock-ins",value:B(a.open_entries),subtitle:"Users still on the clock",accent:"border-amber-500 bg-amber-50 text-amber-700"}]}),Tt=nt(()=>{if(!g.value)return[];const a=g.value.totals;return[{label:"Late clock-ins today",value:B(a.late_clock_ins_today)},{label:"Completed entries today",value:B(a.total_entries_today)},{label:"Week window",value:`${at(g.value.dates.week_start)} â†’ ${at(g.value.dates.week_end)}`},{label:"Report generated",value:ut(g.value.generated_at)}]}),ct=nt(()=>{var a;return(((a=g.value)==null?void 0:a.open_entries.length)??0)>0}),x=d("overview"),m=d(null),f=d(""),M=d([]),mt=d([]),G=d(!1),b=d([]),_=d({workSeconds:0,breakSeconds:0,lunchSeconds:0,tasksCount:0,status:"No Entry",overtimeSeconds:0});d([]);const ot=d([]),Q=d(!1),P=d(""),Dt=d(Date.now()),N=d(""),L=d(""),R=d([]),I=d([]),E=d(!1),J=d(null),vt=()=>{const a=new Date,e=new Date;e.setDate(a.getDate()-13),N.value=e.toISOString().split("T")[0],L.value=a.toISOString().split("T")[0]},xt=async()=>{var a,e;E.value=!0,J.value=null;try{const s={};N.value&&(s.start_date=N.value),L.value&&(s.end_date=L.value);const{data:u}=await z.get("/admin/analytics/utilization/gaps",{params:s}),p=(u==null?void 0:u.data)||[];if(!p.length){R.value=[],I.value=[];return}const v=new Set,y=new Set;p.forEach(i=>{i.user&&v.add(i.user),i.date&&y.add(i.date)});const O=Array.from(v).sort((i,o)=>i.localeCompare(o)),$=Array.from(y).sort((i,o)=>i.localeCompare(o)),U={};$.forEach(i=>{U[i]={date:i,cells:{},totalTaskHours:0,totalWorkHours:0}}),p.forEach(i=>{const o=U[i.date];if(!o)return;const c=i.user||"Unknown";o.cells[c]||(o.cells[c]={taskHours:0,workHours:0});const h=o.cells[c],S=Number.isFinite(i.worked_hours)?i.worked_hours:0,j=Number.isFinite(i.task_hours)?i.task_hours:0;h.workHours+=S,h.taskHours+=j,o.totalWorkHours+=S,o.totalTaskHours+=j}),R.value=O,I.value=$.map(i=>U[i])}catch(s){console.error("Error loading user hours matrix",s),J.value=((e=(a=s==null?void 0:s.response)==null?void 0:a.data)==null?void 0:e.error)||"Unable to load user hours.",R.value=[],I.value=[]}finally{E.value=!1}},V=a=>{const e=typeof a=="number"&&isFinite(a)?Math.max(0,Math.floor(a)):0,s=Math.floor(e/3600),u=Math.floor(e%3600/60),p=e%60,v=y=>y<10?`0${y}`:`${y}`;return`${v(s)}:${v(u)}:${v(p)}`},rt=a=>{if(!a)return"--";try{const s=new Date(a);if(!isNaN(s.getTime()))return s.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!0,timeZone:Es})}catch{}const e=a.match(/\b(\d{1,2}):(\d{2})(?::(\d{2}))?/);if(e){let s=parseInt(e[1],10);const u=e[2],p=s>=12?"PM":"AM";return s=s%12,s===0&&(s=12),`${s}:${u} ${p}`}return"--"},A=a=>{if(!a)return null;const e=a.match(/^(\d{4})-(\d{2})-(\d{2})[ T](\d{2}):(\d{2})(?::(\d{2}))?/);if(e){const p=Number(e[1]),v=Number(e[2])-1,y=Number(e[3]),O=Number(e[4]),$=Number(e[5]),U=Number(e[6]||"0");return new Date(Date.UTC(p,v,y,O-8,$,U))}const s=a.includes("T")?a:a.replace(" ","T"),u=new Date(s);return isNaN(u.getTime())?null:u},Ut=async()=>{try{const a=await z.get("/admin/analytics/users");M.value=a.data,!m.value&&M.value.length>0&&(m.value=M.value[0].id)}catch(a){console.error("Error loading users:",a)}},lt=async()=>{var a;if(m.value){G.value=!0;try{const e=await z.get(`/admin/analytics/user/${m.value}`,{params:{start_date:f.value,end_date:f.value}}),s=((a=e.data)==null?void 0:a.entries)||e.data||[];mt.value=s,b.value=[];let u=0,p=0,v=null;s.forEach(o=>{var j,gt,pt,yt;if(o.entry_type==="break"||o.is_break){const D=A(o.clock_in),H=A(o.clock_out);if(D&&H){const W=Math.max(0,Math.floor((H.getTime()-D.getTime())/1e3));p+=W,b.value.push({name:"Break",start:o.clock_in_formatted||o.clock_in,end:o.clock_out_formatted||o.clock_out,durationSeconds:W,breakDurationSeconds:W,notes:"-"})}return}const c=A(o.clock_in),h=A(o.clock_out);c&&(!v||c<v)&&(v=c);const S=!!o.task&&(o.task.title||o.task.name);if(c&&h&&!S){const D=Math.max(0,Math.floor((h.getTime()-c.getTime())/1e3));u+=D;const H=A(o.lunch_start),W=A(o.lunch_end);let ht=0;H&&W&&(ht=Math.max(0,Math.floor((W.getTime()-H.getTime())/1e3)));const Mt=Math.max(0,D-ht);b.value.push({name:"Work Hours",start:o.clock_in_formatted||o.clock_in,end:o.clock_out_formatted||o.clock_out,durationSeconds:Mt,breakDurationSeconds:0,notes:"-"})}if(S&&c&&h){const D=Math.max(0,Math.floor((h.getTime()-c.getTime())/1e3));b.value.push({name:((j=o.task)==null?void 0:j.title)||((gt=o.task)==null?void 0:gt.name)||"Task",start:o.clock_in_formatted||o.clock_in,end:o.clock_out_formatted||o.clock_out,durationSeconds:D,breakDurationSeconds:0,notes:"-"})}else if(S&&c&&!h){const H=Math.max(0,Math.floor((new Date().getTime()-c.getTime())/1e3));b.value.push({name:((pt=o.task)==null?void 0:pt.title)||((yt=o.task)==null?void 0:yt.name)||"Task",start:o.clock_in_formatted||o.clock_in,end:null,durationSeconds:H,breakDurationSeconds:0,notes:"In progress"})}}),b.value.sort((o,c)=>{const h=new Date(o.start??"").getTime(),S=new Date(c.start??"").getTime();return(isNaN(S)?0:S)-(isNaN(h)?0:h)});const y=b.value.filter(o=>o.name==="Work Hours").reduce((o,c)=>o+(c.durationSeconds||0),0),O=b.value.filter(o=>o.name==="Break").reduce((o,c)=>o+(c.durationSeconds||0),0),$=8*3600,U=Math.max(0,y-$);let i="No Entry";if(v){const o=v,c=(o.getUTCHours()+8)%24,h=o.getUTCMinutes();i=c<8||c===8&&h<=30?"Perfect":"Late"}_.value={workSeconds:y,breakSeconds:O,lunchSeconds:0,tasksCount:b.value.length,status:i,overtimeSeconds:U}}catch(e){console.error("Error loading user daily analytics",e),mt.value=[],_.value={workSeconds:0,breakSeconds:0,lunchSeconds:0,tasksCount:0,status:"No Entry",overtimeSeconds:0}}finally{G.value=!1}}},K=async(a=!1)=>{a||(Q.value=!0);try{const e={limit:100};P.value&&(e.action=P.value);const s=await z.get("/admin/analytics/activity-logs",{params:e});ot.value=s.data.data,Dt.value=Date.now()}catch(e){console.error("Error loading activity logs:",e),a||alert("Failed to load activity logs")}finally{Q.value=!1}},Ht=()=>{if(!m.value){alert("Please select a user first");return}const a=new URLSearchParams({user_id:String(m.value),start_date:f.value,end_date:f.value});window.location.href=`/api/admin/analytics/user-summary/export/csv?${a.toString()}`},Ct=()=>{if(!m.value){alert("Please select a user first");return}const a=new URLSearchParams({user_id:String(m.value),start_date:f.value,end_date:f.value});window.location.href=`/api/admin/analytics/user-summary/export/pdf?${a.toString()}`};return Lt(()=>{const a=new Date;f.value=a.toISOString().split("T")[0],Ut(),K(),et(),vt()}),X(x,a=>{a==="overview"?et():a==="summary"?(!m.value&&M.value.length>0&&(m.value=M.value[0].id),m.value&&lt()):a==="activity"?K(!0):a==="user-hours"&&((!N.value||!L.value)&&vt(),xt())}),X(m,a=>{x.value==="summary"&&a&&lt()}),X(f,()=>{x.value==="summary"&&m.value&&lt()}),X(P,()=>{x.value==="activity"&&K(!0)}),(a,e)=>(l(),r(w,null,[bt(Et(At),{title:"Analytics"}),bt($t,null,{header:ft(()=>[...e[10]||(e[10]=[t("h2",{class:"text-xl font-semibold leading-tight text-gray-800"}," Analytics & Reports ",-1)])]),default:ft(()=>[t("div",Wt,[t("div",Ft,[t("div",Bt,[t("nav",Pt,[t("button",{onClick:e[0]||(e[0]=s=>x.value="overview"),class:C(["whitespace-nowrap border-b-2 py-4 px-1 text-sm font-medium",x.value==="overview"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700"])}," Overview ",2),t("button",{onClick:e[1]||(e[1]=s=>x.value="summary"),class:C(["whitespace-nowrap border-b-2 py-4 px-1 text-sm font-medium",x.value==="summary"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700"])}," User Summary ",2),t("button",{onClick:e[2]||(e[2]=s=>x.value="user-hours"),class:C(["whitespace-nowrap border-b-2 py-4 px-1 text-sm font-medium",x.value==="user-hours"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700"])}," User Hours ",2),t("button",{onClick:e[3]||(e[3]=s=>x.value="activity"),class:C(["whitespace-nowrap border-b-2 py-4 px-1 text-sm font-medium",x.value==="activity"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700"])}," Activity Log ",2)])]),x.value==="overview"?(l(),r("div",Rt,[t("section",It,[t("div",Vt,[t("div",null,[e[11]||(e[11]=t("h3",{class:"text-lg font-semibold text-gray-900"},"Company Health Overview",-1)),g.value?(l(),r("p",Ot," As of "+n(ut(g.value.generated_at)),1)):k("",!0)]),t("div",jt,[t("button",{type:"button",onClick:dt,disabled:F.value||tt.value,class:"inline-flex items-center gap-2 rounded-md border border-indigo-200 bg-white px-4 py-2 text-sm font-medium text-indigo-600 shadow-sm transition hover:bg-indigo-50 disabled:cursor-not-allowed disabled:border-gray-200 disabled:text-gray-400"},[F.value?(l(),r("span",zt)):k("",!0),t("span",null,n(F.value?"Refreshingâ€¦":"Refresh"),1)],8,qt)])]),tt.value?(l(),r("div",Zt,[...e[12]||(e[12]=[t("div",{class:"mx-auto mb-3 h-8 w-8 animate-spin rounded-full border-b-2 border-indigo-600"},null,-1),Y(" Loading analytics summaryâ€¦ ",-1)])])):Z.value?(l(),r("div",Gt,[t("div",null,[e[13]||(e[13]=t("h4",{class:"font-semibold text-red-800"},"We couldnâ€™t load the analytics overview.",-1)),t("p",Qt,n(Z.value),1)]),t("div",null,[t("button",{type:"button",onClick:dt,class:"inline-flex items-center rounded-md bg-red-600 px-4 py-2 text-sm font-medium text-white shadow-sm transition hover:bg-red-500"}," Try again ")])])):g.value?(l(),r("div",Jt,[t("div",Kt,[(l(!0),r(w,null,T(St.value,s=>(l(),r("div",{key:s.title,class:C(["rounded-xl border bg-white p-6 shadow-sm transition hover:-translate-y-1 hover:shadow-md",s.accent])},[t("h4",Xt,n(s.title),1),t("p",Yt,n(s.value),1),t("p",te,n(s.subtitle),1)],2))),128))]),t("div",ee,[t("div",se,[t("div",ae,[e[14]||(e[14]=t("h4",{class:"text-base font-semibold text-gray-800"},"Whoâ€™s still on the clock",-1)),t("p",oe,n(ct.value?"Top 10 current sessions":"No one is clocked in right now."),1)]),ct.value?(l(),r("div",re,[(l(!0),r(w,null,T(g.value.open_entries,s=>(l(),r("div",{key:s.entry_id,class:"flex items-center justify-between gap-3 px-5 py-4"},[t("div",null,[t("p",le,n(s.user.name||"Unknown User"),1),t("p",ne,[Y(n(s.user.email||"No email listed")+" ",1),s.user.team?(l(),r("span",ie,"Â· "+n(s.user.team),1)):k("",!0)])]),t("div",de,[t("p",ue,n(kt(s.minutes_running)),1),t("p",ce,"since "+n(wt(s.clock_in)),1)])]))),128))])):(l(),r("div",me," All clocks are cleared for today. Great job! "))]),t("div",ve,[e[15]||(e[15]=t("div",{class:"border-b border-gray-100 px-5 py-4"},[t("h4",{class:"text-base font-semibold text-gray-800"},"At a glance"),t("p",{class:"text-sm text-gray-500"},"Quick context for today and the week.")],-1)),t("dl",xe,[(l(!0),r(w,null,T(Tt.value,s=>(l(),r("div",{key:s.label,class:"flex items-center justify-between gap-4"},[t("dt",ge,n(s.label),1),t("dd",pe,n(s.value),1)]))),128))])])])])):k("",!0)])])):x.value==="summary"?(l(),r("div",ye,[t("div",he,[t("div",be,[t("div",null,[e[17]||(e[17]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"User",-1)),q(t("select",{"onUpdate:modelValue":e[4]||(e[4]=s=>m.value=s),class:"w-full rounded-md border-gray-300 shadow-sm"},[e[16]||(e[16]=t("option",{value:null},"Select User",-1)),(l(!0),r(w,null,T(M.value,s=>(l(),r("option",{key:s.id,value:s.id},n(s.name),9,fe))),128))],512),[[_t,m.value]])]),t("div",null,[e[18]||(e[18]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Date",-1)),q(t("input",{"onUpdate:modelValue":e[5]||(e[5]=s=>f.value=s),type:"date",class:"w-full rounded-md border-gray-300 shadow-sm"},null,512),[[it,f.value]])]),t("div",_e,[t("button",{onClick:Ht,disabled:!m.value,class:"flex-1 rounded-md bg-green-600 px-4 py-2 text-sm font-medium text-white shadow-sm hover:bg-green-500 disabled:bg-gray-400 disabled:cursor-not-allowed"}," Export CSV ",8,ke),t("button",{onClick:Ct,disabled:!m.value,class:"flex-1 rounded-md bg-red-600 px-4 py-2 text-sm font-medium text-white shadow-sm hover:bg-red-500 disabled:bg-gray-400 disabled:cursor-not-allowed"}," Export PDF ",8,we)])])]),t("div",Se,[e[24]||(e[24]=t("h3",{class:"text-lg font-medium leading-6 text-gray-900 mb-4"},"Daily Summary",-1)),t("div",Te,[t("div",null,[e[19]||(e[19]=t("div",{class:"text-gray-500"},"ðŸ•’ Time In Hours",-1)),t("div",De,n(V(_.value.workSeconds)),1)]),t("div",null,[e[20]||(e[20]=t("div",{class:"text-gray-500"},"â˜• Total Breaks",-1)),t("div",Ue,n(V(_.value.breakSeconds)),1)]),t("div",null,[e[21]||(e[21]=t("div",{class:"text-gray-500"},"ðŸ“‹ Entries",-1)),t("div",He,n(_.value.tasksCount),1)]),t("div",null,[e[22]||(e[22]=t("div",{class:"text-gray-500"},"â° Status",-1)),t("div",{class:C(["font-semibold",{"text-green-700":_.value.status==="Perfect","text-yellow-700":_.value.status==="Late","text-gray-700":_.value.status==="No Entry"}])},n(_.value.status),3)]),t("div",null,[e[23]||(e[23]=t("div",{class:"text-gray-500"},"âš¡ Overtime",-1)),t("div",Ce,n(V(_.value.overtimeSeconds)),1)])])]),t("div",Me,[t("div",Ne,[t("table",Le,[e[26]||(e[26]=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Task"),t("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Start Time"),t("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"End Time"),t("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Duration"),t("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Break Duration"),t("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Notes")])],-1)),t("tbody",Ee,[(l(!0),r(w,null,T(b.value,(s,u)=>(l(),r("tr",{key:u},[t("td",Ae,n(s.name),1),t("td",$e,n(rt(s.start)),1),t("td",We,n(rt(s.end)),1),t("td",Fe,n(V(s.durationSeconds)),1),t("td",Be,n(V(s.breakDurationSeconds||0)),1),t("td",Pe,n(s.notes||"-"),1)]))),128)),b.value.length===0&&!G.value?(l(),r("tr",Re,[...e[25]||(e[25]=[t("td",{colspan:"6",class:"px-4 py-4 text-center text-sm text-gray-500"},"No entries for selected day",-1)])])):k("",!0)])])]),G.value?(l(),r("div",Ie,[...e[27]||(e[27]=[t("div",{class:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600"},null,-1),t("p",{class:"mt-2 text-sm text-gray-500"},"Loading...",-1)])])):k("",!0)])])):x.value==="activity"?(l(),r("div",Ve,[t("div",Oe,[t("div",je,[e[29]||(e[29]=t("h3",{class:"text-lg font-medium text-gray-900"},"Real-Time Activity Log",-1)),t("div",qe,[e[28]||(e[28]=t("div",{class:"flex items-center gap-2 text-sm text-gray-600"},[t("span",{class:"inline-block w-2 h-2 bg-green-500 rounded-full animate-pulse"}),t("span",null,"Live Updates")],-1)),t("button",{onClick:e[6]||(e[6]=s=>K()),class:"rounded-md bg-indigo-600 px-3 py-1.5 text-xs font-medium text-white shadow-sm hover:bg-indigo-500"}," Refresh ")])]),t("div",ze,[t("div",null,[e[31]||(e[31]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Filter by Action",-1)),q(t("select",{"onUpdate:modelValue":e[7]||(e[7]=s=>P.value=s),class:"w-full rounded-md border-gray-300 shadow-sm"},[...e[30]||(e[30]=[t("option",{value:""},"All Actions",-1),t("option",{value:"clock_in"},"Clock In",-1),t("option",{value:"clock_out"},"Clock Out",-1),t("option",{value:"break_start"},"Break Start",-1),t("option",{value:"break_end"},"Break End",-1),t("option",{value:"lunch_start"},"Lunch Start",-1),t("option",{value:"lunch_end"},"Lunch End",-1)])],512),[[_t,P.value]])])])]),t("div",Ze,[t("div",Ge,[t("table",Qe,[e[33]||(e[33]=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"User"),t("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Action"),t("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Description"),t("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Time")])],-1)),t("tbody",Je,[(l(!0),r(w,null,T(ot.value,s=>{var u,p,v;return l(),r("tr",{key:s.id,class:"hover:bg-gray-50"},[t("td",Ke,[t("div",Xe,[t("div",Ye,[t("div",ts,[t("span",es,n((u=s.user)!=null&&u.name?s.user.name.charAt(0).toUpperCase():"?"),1)])]),t("div",ss,[t("div",as,n(((p=s.user)==null?void 0:p.name)||"Unknown User"),1),t("div",os,n((v=s.user)==null?void 0:v.email),1)])])]),t("td",rs,[t("span",{class:C(["px-2 inline-flex text-xs leading-5 font-semibold rounded-full",{"bg-green-100 text-green-800":s.action==="clock_in","bg-red-100 text-red-800":s.action==="clock_out","bg-yellow-100 text-yellow-800":s.action.includes("break"),"bg-blue-100 text-blue-800":s.action.includes("lunch")}])},n(s.action.replace("_"," ").replace(/\b\w/g,y=>y.toUpperCase())),3)]),t("td",ls,[t("div",ns,n(s.description),1)]),t("td",is,[Y(n(at(s.created_at))+" ",1),t("div",ds,n(rt(s.created_at)),1)])])}),128)),ot.value.length===0&&!Q.value?(l(),r("tr",us,[...e[32]||(e[32]=[t("td",{colspan:"4",class:"px-4 py-4 text-center text-sm text-gray-500"},"No activity logs found",-1)])])):k("",!0)])])]),Q.value?(l(),r("div",cs,[...e[34]||(e[34]=[t("div",{class:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600"},null,-1),t("p",{class:"mt-2 text-sm text-gray-500"},"Loading...",-1)])])):k("",!0)])])):x.value==="user-hours"?(l(),r("div",ms,[t("div",vs,[e[37]||(e[37]=t("div",null,[t("h3",{class:"text-lg font-semibold text-gray-900"},"User Hours Matrix"),t("p",{class:"text-sm text-gray-500"}," Each cell shows Task Hours / Work Hours for that user and date. Totals per date are on the right. ")],-1)),t("div",xs,[t("div",null,[e[35]||(e[35]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Start Date",-1)),q(t("input",{type:"date","onUpdate:modelValue":e[8]||(e[8]=s=>N.value=s),class:"rounded-md border-gray-300 shadow-sm text-sm"},null,512),[[it,N.value]])]),t("div",null,[e[36]||(e[36]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"End Date",-1)),q(t("input",{type:"date","onUpdate:modelValue":e[9]||(e[9]=s=>L.value=s),class:"rounded-md border-gray-300 shadow-sm text-sm"},null,512),[[it,L.value]])]),t("button",{type:"button",onClick:xt,disabled:E.value,class:"inline-flex items-center gap-2 rounded-md bg-indigo-600 px-4 py-2 text-sm font-medium text-white shadow-sm hover:bg-indigo-500 disabled:opacity-60 disabled:cursor-not-allowed"},[E.value?(l(),r("span",ps)):k("",!0),t("span",null,n(E.value?"Loadingâ€¦":"Apply"),1)],8,gs)])]),J.value?(l(),r("div",ys,[t("p",hs,n(J.value),1)])):(l(),r("div",bs,[E.value?(l(),r("div",fs,[...e[38]||(e[38]=[t("div",{class:"mx-auto mb-3 h-8 w-8 animate-spin rounded-full border-b-2 border-indigo-600"},null,-1),Y(" Loading user hoursâ€¦ ",-1)])])):I.value.length?(l(),r("div",ks,[t("table",ws,[t("thead",Ss,[t("tr",null,[e[39]||(e[39]=t("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"}," Date ",-1)),(l(!0),r(w,null,T(R.value,s=>(l(),r("th",{key:s,class:"px-4 py-3 text-center text-xs font-medium uppercase tracking-wider text-gray-500"},n(s),1))),128)),e[40]||(e[40]=t("th",{class:"px-4 py-3 text-right text-xs font-medium uppercase tracking-wider text-gray-500"}," Total Task ",-1)),e[41]||(e[41]=t("th",{class:"px-4 py-3 text-right text-xs font-medium uppercase tracking-wider text-gray-500"}," Total Work ",-1))])]),t("tbody",Ts,[(l(!0),r(w,null,T(I.value,s=>(l(),r("tr",{key:s.date},[t("td",Ds,n(s.date),1),(l(!0),r(w,null,T(R.value,u=>(l(),r("td",{key:u+s.date,class:"px-4 py-3 text-xs text-gray-700 text-center align-top"},[s.cells[u]?(l(),r("div",Us,[t("div",Hs," Task: "+n(s.cells[u].taskHours.toFixed(2))+" h ",1),t("div",Cs," Work: "+n(s.cells[u].workHours.toFixed(2))+" h ",1)])):(l(),r("div",Ms,"â€”"))]))),128)),t("td",Ns,n(s.totalTaskHours.toFixed(2))+" h ",1),t("td",Ls,n(s.totalWorkHours.toFixed(2))+" h ",1)]))),128))])])])):(l(),r("div",_s," No data for selected range. "))]))])):k("",!0)])])]),_:1})],64))}});export{Bs as default};
