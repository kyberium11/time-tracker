import{_ as w}from"./AuthenticatedLayout.vue_vue_type_script_setup_true_lang-B2UCnFOi.js";import{d as v,r as n,o as k,c as o,a as h,u as b,h as C,w as _,b as t,f as i,F as r,i as g,k as L,t as a,n as N,e as f}from"./app-DTkfuwJy.js";import{a as D}from"./api-Dav2hHfa.js";const S={class:"flex items-center justify-between"},U=["disabled"],T={class:"py-12"},E={class:"mx-auto max-w-7xl sm:px-6 lg:px-8"},V={class:"mb-4 overflow-hidden bg-white shadow sm:rounded-lg"},A={class:"px-4 py-5 sm:p-6"},B={key:0,class:"text-sm text-gray-500"},F={key:1,class:"list-disc pl-5 space-y-1 text-sm text-gray-700"},I={class:"font-medium"},M={class:"mb-6 overflow-hidden bg-white shadow sm:rounded-lg"},j={class:"px-4 py-5 sm:p-6 overflow-x-auto"},J={class:"min-w-full divide-y divide-gray-200"},O={class:"divide-y divide-gray-200 bg-white"},P={class:"whitespace-nowrap px-6 py-4 text-sm text-gray-700"},W={class:"whitespace-nowrap px-6 py-4 text-sm text-gray-900"},z={class:"whitespace-nowrap px-6 py-4 text-sm text-gray-700"},K={class:"whitespace-nowrap px-6 py-4 text-sm text-gray-700"},R={class:"whitespace-nowrap px-6 py-4 text-sm text-gray-700"},$={class:"px-6 py-4 text-xs text-gray-500"},q={class:"whitespace-pre-wrap"},G={key:0},H={class:"overflow-hidden bg-white shadow sm:rounded-lg"},Q={class:"px-4 py-5 sm:p-6 overflow-x-auto"},X={class:"min-w-full divide-y divide-gray-200"},Y={class:"divide-y divide-gray-200 bg-white"},Z={class:"whitespace-nowrap px-6 py-4 text-sm text-gray-700"},tt={class:"whitespace-nowrap px-6 py-4 text-sm text-gray-700"},et={class:"whitespace-nowrap px-6 py-4 text-sm text-gray-900"},st={class:"whitespace-nowrap px-6 py-4 text-sm text-gray-700"},at={class:"px-6 py-4 text-xs text-gray-500"},ot={class:"whitespace-pre-wrap"},it={key:0},ct=v({__name:"ClickUpLogs",setup(dt){const c=n([]),l=n(!1),p=n([]),x=n([]),u=async()=>{var y,s,e;l.value=!0;try{const d=await D.get("/admin/clickup/webhook-logs");c.value=((y=d.data)==null?void 0:y.logs)||[],p.value=((s=d.data)==null?void 0:s.webhooks)||[],x.value=((e=d.data)==null?void 0:e.time_entry_logs)||[]}catch{alert("Failed to load ClickUp logs")}finally{l.value=!1}};return k(u),(y,s)=>(i(),o(r,null,[h(b(C),{title:"ClickUp Logs"}),h(w,null,{header:_(()=>[t("div",S,[s[0]||(s[0]=t("h2",{class:"text-xl font-semibold leading-tight text-gray-800"},"ClickUp Webhook Logs",-1)),t("button",{onClick:u,disabled:l.value,class:"rounded-md bg-indigo-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-indigo-500"}," Refresh ",8,U)])]),default:_(()=>[t("div",T,[t("div",E,[t("div",V,[t("div",A,[s[1]||(s[1]=t("h3",{class:"text-md font-semibold mb-2"},"Active ClickUp Webhooks",-1)),p.value.length?(i(),o("ul",F,[(i(!0),o(r,null,g(p.value,e=>{var d,m;return i(),o("li",{key:e.id},[t("span",I,a(e.id),1),L(" → "+a(e.endpoint)+" (events: "+a((e.events||[]).join(", "))+") ",1),t("span",{class:N(["ml-2 text-xs",((d=e.health)==null?void 0:d.status)==="active"?"text-green-600":"text-red-600"])},a((m=e.health)==null?void 0:m.status),3)])}),128))])):(i(),o("div",B,"No webhooks found (or CLICKUP_TEAM_ID not set)."))])]),t("div",M,[t("div",j,[t("table",J,[s[3]||(s[3]=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Time"),t("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Event"),t("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Task ID"),t("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Status"),t("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Message"),t("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Payload")])],-1)),t("tbody",O,[(i(!0),o(r,null,g(c.value,e=>(i(),o("tr",{key:e.id},[t("td",P,a(new Date(e.created_at).toLocaleString()),1),t("td",W,a(e.event||"—"),1),t("td",z,a(e.task_id||"—"),1),t("td",K,a(e.status_code??"—"),1),t("td",R,a(e.message||"—"),1),t("td",$,[t("pre",q,a(JSON.stringify(e.payload,null,2)),1)])]))),128)),!c.value.length&&!l.value?(i(),o("tr",G,[...s[2]||(s[2]=[t("td",{colspan:"6",class:"px-6 py-6 text-center text-sm text-gray-500"},"No logs yet.",-1)])])):f("",!0)])])])]),t("div",H,[t("div",Q,[s[6]||(s[6]=t("h3",{class:"text-md font-semibold mb-2"},"Time Entry Sync Logs",-1)),t("table",X,[s[5]||(s[5]=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Time"),t("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"User"),t("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Action"),t("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Description"),t("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Details")])],-1)),t("tbody",Y,[(i(!0),o(r,null,g(x.value,e=>{var d;return i(),o("tr",{key:e.id},[t("td",Z,a(new Date(e.created_at).toLocaleString()),1),t("td",tt,a(((d=e.user)==null?void 0:d.name)||e.user_id),1),t("td",et,a(e.action),1),t("td",st,a(e.description),1),t("td",at,[t("pre",ot,a(JSON.stringify(e.metadata,null,2)),1)])])}),128)),!x.value.length&&!l.value?(i(),o("tr",it,[...s[4]||(s[4]=[t("td",{colspan:"5",class:"px-6 py-6 text-center text-sm text-gray-500"},"No time entry sync logs yet.",-1)])])):f("",!0)])])])])])])]),_:1})],64))}});export{ct as default};
