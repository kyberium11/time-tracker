import{d as $,r as c,o as q,c as r,a as k,u as A,h as D,w as U,b as e,e as T,f as n,F as b,i as C,t as i,n as j,p as B,g as d,j as u,v as E}from"./app-Dk8IlJ-Y.js";import{_ as F}from"./AuthenticatedLayout.vue_vue_type_script_setup_true_lang-DfxVbcsK.js";import{a as x}from"./api-DjUCQSwv.js";const P={class:"flex items-center justify-between"},z={class:"py-12"},I={class:"mx-auto max-w-7xl sm:px-6 lg:px-8"},R={class:"overflow-hidden bg-white shadow sm:rounded-lg"},L={class:"min-w-full divide-y divide-gray-200"},G={class:"divide-y divide-gray-200 bg-white"},H={class:"whitespace-nowrap px-6 py-4 text-sm font-medium text-gray-900"},J={class:"whitespace-nowrap px-6 py-4 text-sm text-gray-500"},K={class:"whitespace-nowrap px-6 py-4 text-sm text-gray-500"},O=["value","onChange"],Q=["selected"],W=["selected"],X=["selected"],Y={class:"whitespace-nowrap px-6 py-4 text-sm text-gray-500"},Z={class:"whitespace-nowrap px-6 py-4 text-sm text-gray-500"},ee={class:"whitespace-nowrap px-6 py-4 text-sm text-gray-500"},te={key:0},se={key:1,class:"text-gray-400 italic"},ae={class:"whitespace-nowrap px-6 py-4 text-sm font-medium"},le=["onClick"],oe=["onClick"],ie={key:0,class:"fixed inset-0 z-50 overflow-y-auto","aria-labelledby":"modal-title",role:"dialog","aria-modal":"true"},de={class:"flex min-h-screen items-end justify-center px-4 pt-4 pb-20 text-center sm:block sm:p-0"},re={class:"relative inline-block transform overflow-hidden rounded-lg bg-white text-left align-bottom shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-lg"},ne={class:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4"},me={class:"text-lg font-medium leading-6 text-gray-900 mb-4"},ue={class:"mb-4"},pe={class:"mb-4"},ce={class:"mb-4"},xe={class:"block text-sm font-medium text-gray-700"},fe=["required"],ge={class:"mb-4"},ye=["required"],ve={class:"mb-4"},be={class:"mb-4"},we=["value"],he={class:"mb-4 grid grid-cols-2 gap-4"},_e={class:"mb-4"},Ve=$({__name:"Users",setup(ke){const w=c([]),p=c(!1),y=c(!1),o=c(null),l=c({name:"",email:"",password:"",password_confirmation:"",role:"employee",team_id:null,shift_start:"",shift_end:"",clickup_user_id:""}),h=c([]),V=async()=>{try{const a=await x.get("/admin/teams");h.value=a.data}catch(a){console.error("Error fetching teams:",a)}},g=async()=>{p.value=!0;try{const a=await x.get("/admin/users");w.value=a.data.data}catch(a){console.error("Error fetching users:",a),alert("Failed to fetch users")}finally{p.value=!1}},_=a=>{var t;a?(o.value=a,l.value={name:a.name,email:a.email,password:"",password_confirmation:"",role:a.role,team_id:((t=a.team)==null?void 0:t.id)||null,shift_start:a.shift_start||"",shift_end:a.shift_end||"",clickup_user_id:a.clickup_user_id||""}):(o.value=null,l.value={name:"",email:"",password:"",password_confirmation:"",role:"employee",team_id:null,shift_start:"",shift_end:"",clickup_user_id:""}),y.value=!0},v=()=>{y.value=!1,o.value=null},M=async()=>{var a,t;p.value=!0;try{o.value?await x.put(`/admin/users/${o.value.id}`,l.value):await x.post("/admin/users",l.value),await g(),v(),l.value={name:"",email:"",password:"",password_confirmation:"",role:"employee",team_id:null,shift_start:"",shift_end:"",clickup_user_id:""}}catch(s){alert(((t=(a=s.response)==null?void 0:a.data)==null?void 0:t.message)||"Error saving user")}finally{p.value=!1}},N=async a=>{var t,s;if(confirm("Are you sure you want to delete this user?"))try{await x.delete(`/admin/users/${a}`),await g()}catch(m){alert(((s=(t=m.response)==null?void 0:t.data)==null?void 0:s.message)||"Error deleting user")}},S=async(a,t)=>{var s,m;if(confirm(`Are you sure you want to change this user's role to ${t}?`)){p.value=!0;try{await x.put(`/admin/users/${a}`,{role:t}),await g()}catch(f){alert(((m=(s=f.response)==null?void 0:s.data)==null?void 0:m.message)||"Error updating role")}finally{p.value=!1}}};return q(()=>{g(),V()}),(a,t)=>(n(),r(b,null,[k(A(D),{title:"User Management"}),k(F,null,{header:U(()=>[e("div",P,[t[10]||(t[10]=e("h2",{class:"text-xl font-semibold leading-tight text-gray-800"}," User Management ",-1)),e("button",{onClick:t[0]||(t[0]=s=>_()),class:"rounded-md bg-indigo-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-indigo-500"}," Add User ")])]),default:U(()=>[e("div",z,[e("div",I,[e("div",R,[e("table",L,[t[11]||(t[11]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"}," Name "),e("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"}," Email "),e("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"}," Role "),e("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"}," ClickUp User ID "),e("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"}," Team "),e("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"}," Shift Time "),e("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"}," Actions ")])],-1)),e("tbody",G,[(n(!0),r(b,null,C(w.value,s=>{var m;return n(),r("tr",{key:s.id},[e("td",H,i(s.name),1),e("td",J,i(s.email),1),e("td",K,[e("select",{value:s.role,onChange:f=>S(s.id,f.target.value),class:j(["inline-flex rounded-full px-3 py-1 text-xs font-semibold leading-5 border-0 cursor-pointer",s.role==="admin"?"bg-purple-600 text-white hover:bg-purple-700":s.role==="manager"?"bg-blue-600 text-white hover:bg-blue-700":"bg-green-600 text-white hover:bg-green-700"])},[e("option",{value:"admin",selected:s.role==="admin"},"Admin",8,Q),e("option",{value:"manager",selected:s.role==="manager"},"Manager",8,W),e("option",{value:"employee",selected:s.role==="employee"},"Employee",8,X)],42,O)]),e("td",Y,i(s.clickup_user_id||"â€”"),1),e("td",Z,i(((m=s.team)==null?void 0:m.name)||"No team"),1),e("td",ee,[s.shift_start&&s.shift_end?(n(),r("span",te,i(s.shift_start)+" - "+i(s.shift_end),1)):(n(),r("span",se,"Not set"))]),e("td",ae,[e("button",{onClick:f=>_(s),class:"rounded-md bg-indigo-600 px-3 py-1.5 text-xs font-semibold text-white shadow-sm hover:bg-indigo-500"}," Edit ",8,le),e("button",{onClick:f=>N(s.id),class:"ml-2 rounded-md bg-red-600 px-3 py-1.5 text-xs font-semibold text-white shadow-sm hover:bg-red-500"}," Delete ",8,oe)])])}),128))])])])])]),y.value?(n(),r("div",ie,[e("div",de,[e("div",{class:"fixed inset-0 transition-opacity bg-gray-500 bg-opacity-75","aria-hidden":"true",onClick:v}),e("div",re,[e("div",ne,[e("h3",me,i(o.value?"Edit User":"Add User"),1),e("form",{onSubmit:B(M,["prevent"])},[e("div",ue,[t[12]||(t[12]=e("label",{class:"block text-sm font-medium text-gray-700"},"Name",-1)),d(e("input",{"onUpdate:modelValue":t[1]||(t[1]=s=>l.value.name=s),type:"text",required:"",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm"},null,512),[[u,l.value.name]])]),e("div",pe,[t[13]||(t[13]=e("label",{class:"block text-sm font-medium text-gray-700"},"Email",-1)),d(e("input",{"onUpdate:modelValue":t[2]||(t[2]=s=>l.value.email=s),type:"email",required:"",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm"},null,512),[[u,l.value.email]])]),e("div",ce,[e("label",xe,i(o.value?"New Password (leave blank to keep current)":"Password"),1),d(e("input",{"onUpdate:modelValue":t[3]||(t[3]=s=>l.value.password=s),type:"password",required:!o.value,class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm"},null,8,fe),[[u,l.value.password]])]),e("div",ge,[t[14]||(t[14]=e("label",{class:"block text-sm font-medium text-gray-700"},"Confirm Password",-1)),d(e("input",{"onUpdate:modelValue":t[4]||(t[4]=s=>l.value.password_confirmation=s),type:"password",required:!o.value,class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm"},null,8,ye),[[u,l.value.password_confirmation]])]),e("div",ve,[t[16]||(t[16]=e("label",{class:"block text-sm font-medium text-gray-700"},"Role",-1)),d(e("select",{"onUpdate:modelValue":t[5]||(t[5]=s=>l.value.role=s),required:"",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm"},[...t[15]||(t[15]=[e("option",{value:"admin"},"Admin",-1),e("option",{value:"manager"},"Manager",-1),e("option",{value:"employee"},"Employee",-1)])],512),[[E,l.value.role]])]),e("div",be,[t[18]||(t[18]=e("label",{class:"block text-sm font-medium text-gray-700"},"Team",-1)),d(e("select",{"onUpdate:modelValue":t[6]||(t[6]=s=>l.value.team_id=s),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm"},[t[17]||(t[17]=e("option",{value:null},"No team",-1)),(n(!0),r(b,null,C(h.value,s=>(n(),r("option",{key:s.id,value:s.id},i(s.name),9,we))),128))],512),[[E,l.value.team_id]])]),e("div",he,[e("div",null,[t[19]||(t[19]=e("label",{class:"block text-sm font-medium text-gray-700"},"Shift Start",-1)),d(e("input",{"onUpdate:modelValue":t[7]||(t[7]=s=>l.value.shift_start=s),type:"time",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm"},null,512),[[u,l.value.shift_start]])]),e("div",null,[t[20]||(t[20]=e("label",{class:"block text-sm font-medium text-gray-700"},"Shift End",-1)),d(e("input",{"onUpdate:modelValue":t[8]||(t[8]=s=>l.value.shift_end=s),type:"time",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm"},null,512),[[u,l.value.shift_end]])])]),e("div",_e,[t[21]||(t[21]=e("label",{class:"block text-sm font-medium text-gray-700"},"ClickUp User ID",-1)),d(e("input",{"onUpdate:modelValue":t[9]||(t[9]=s=>l.value.clickup_user_id=s),type:"text",placeholder:"e.g. 12345678",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm"},null,512),[[u,l.value.clickup_user_id]]),t[22]||(t[22]=e("p",{class:"mt-1 text-xs text-gray-500"},"Use the member's numeric id from ClickUp.",-1))]),e("div",{class:"flex justify-end space-x-3"},[e("button",{type:"button",onClick:v,class:"rounded-md border border-gray-300 px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50"}," Cancel "),t[23]||(t[23]=e("button",{type:"submit",class:"rounded-md bg-indigo-600 px-4 py-2 text-sm font-medium text-white hover:bg-indigo-700"}," Save ",-1))])],32)])])])])):T("",!0)]),_:1})],64))}});export{Ve as default};
