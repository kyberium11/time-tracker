import{d as H,r as c,o as J,a as l,b as D,u as K,h as P,e as V,f as e,i as p,g as o,F as m,k as x,t as i,j as A,s as Q,l as $,m as F,v as R,n as X}from"./app-BUeWMMJP.js";import{_ as Y}from"./AuthenticatedLayout.vue_vue_type_script_setup_true_lang-B959LKiL.js";import{a as v}from"./api-BiU2kzRh.js";const Z={class:"flex items-center justify-between"},ee={class:"py-12"},te={class:"mx-auto max-w-7xl sm:px-6 lg:px-8 space-y-6"},se={key:0,class:"flex justify-center py-12"},ae={key:1,class:"grid gap-6"},le={class:"px-6 py-4 border-b border-gray-200"},oe={class:"flex items-center justify-between"},ne={class:"text-lg font-medium text-gray-900"},ie={key:0,class:"text-sm text-gray-500 mt-1"},de={class:"flex gap-2"},re=["onClick"],ce=["onClick"],ue=["onClick"],me={class:"px-6 py-4 space-y-3"},ve={key:0,class:"flex items-center text-sm"},ge={class:"ml-2 text-gray-900"},ye={key:1,class:"text-sm text-gray-500 italic"},be={class:"mt-4"},fe={class:"text-sm font-medium text-gray-700 mb-2"},pe={key:0,class:"space-y-2"},xe={class:"font-medium text-gray-900"},he={class:"text-gray-500 ml-2"},_e={class:"text-right text-xs text-gray-600"},we={key:1,class:"text-sm text-gray-500 italic"},ke={key:0,class:"text-center py-12 text-gray-500"},Me={key:0,class:"fixed inset-0 z-50 overflow-y-auto","aria-labelledby":"modal-title",role:"dialog","aria-modal":"true"},Ce={class:"flex min-h-screen items-end justify-center px-4 pt-4 pb-20 text-center sm:block sm:p-0"},Te={class:"relative inline-block transform overflow-hidden rounded-lg bg-white text-left align-bottom shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-lg"},$e={class:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4"},je={class:"text-lg font-medium leading-6 text-gray-900 mb-4"},Ee={class:"mb-4"},Ne={class:"mb-4"},Se={class:"mb-4"},De=["value"],Ve={key:1,class:"fixed inset-0 z-50 overflow-y-auto","aria-labelledby":"modal-title",role:"dialog","aria-modal":"true"},Ae={class:"flex min-h-screen items-end justify-center px-4 pt-4 pb-20 text-center sm:block sm:p-0"},Fe={class:"relative inline-block transform overflow-hidden rounded-lg bg-white text-left align-bottom shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-2xl"},Ue={class:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4"},ze={class:"text-lg font-medium leading-6 text-gray-900 mb-4"},Be={class:"max-h-96 overflow-y-auto"},Ie={class:"space-y-2"},Le=["onClick"],Oe={class:"font-medium text-gray-900"},qe={class:"text-sm text-gray-500"},We={key:0,class:"text-xs text-orange-600 mt-1"},Ge={class:"flex items-center"},He={key:0,class:"w-5 h-5 bg-indigo-600 rounded-full flex items-center justify-center"},Je={key:1,class:"w-5 h-5 border-2 border-gray-300 rounded-full"},Xe=H({__name:"Teams",setup(Ke){const h=c([]),j=c([]),E=c([]),g=c(!1),k=c(!1),M=c(!1),f=c(null),y=c(null),r=c({name:"",description:"",manager_id:null}),u=c({selectedMembers:[]}),U=[{label:"Sunday",value:0},{label:"Monday",value:1},{label:"Tuesday",value:2},{label:"Wednesday",value:3},{label:"Thursday",value:4},{label:"Friday",value:5},{label:"Saturday",value:6}],z=a=>{var t;return((t=U.find(d=>d.value===a))==null?void 0:t.label)??"Unknown"};J(()=>{_(),B()});const _=async()=>{g.value=!0;try{const a=await v.get("/admin/teams");h.value=a.data}catch(a){console.error("Error fetching teams:",a),alert("Failed to fetch teams")}finally{g.value=!1}},B=async()=>{try{const a=await v.get("/admin/teams/managers/list");j.value=a.data}catch(a){console.error("Error fetching managers:",a)}},I=async()=>{try{const a=await v.get("/admin/users");E.value=a.data.data||a.data}catch(a){console.error("Error fetching users:",a)}},N=a=>{a?(f.value=a,r.value={name:a.name,description:a.description||"",manager_id:a.manager_id}):(f.value=null,r.value={name:"",description:"",manager_id:null}),k.value=!0},C=()=>{k.value=!1,f.value=null},L=async()=>{var a,t;g.value=!0;try{f.value?await v.put(`/admin/teams/${f.value.id}`,r.value):await v.post("/admin/teams",r.value),await _(),C(),r.value={name:"",description:"",manager_id:null}}catch(d){alert(((t=(a=d.response)==null?void 0:a.data)==null?void 0:t.message)||"Error saving team")}finally{g.value=!1}},O=async a=>{var t,d;if(confirm("Are you sure you want to delete this team?"))try{await v.delete(`/admin/teams/${a}`),await _()}catch(s){alert(((d=(t=s.response)==null?void 0:t.data)==null?void 0:d.message)||"Error deleting team")}},q=async a=>{var t;y.value=a,await I(),u.value.selectedMembers=((t=a.members)==null?void 0:t.map(d=>d.id))||[],M.value=!0},T=()=>{M.value=!1,y.value=null,u.value.selectedMembers=[]},W=async()=>{var a,t,d;if(y.value){g.value=!0;try{for(const n of u.value.selectedMembers)await v.put(`/admin/users/${n}`,{team_id:y.value.id});const b=(((a=y.value.members)==null?void 0:a.map(n=>n.id))||[]).filter(n=>!u.value.selectedMembers.includes(n));for(const n of b)await v.put(`/admin/users/${n}`,{team_id:null});await _(),T()}catch(s){alert(((d=(t=s.response)==null?void 0:t.data)==null?void 0:d.message)||"Error updating team members")}finally{g.value=!1}}},G=a=>{const t=u.value.selectedMembers.indexOf(a);t>-1?u.value.selectedMembers.splice(t,1):u.value.selectedMembers.push(a)};return(a,t)=>(o(),l(m,null,[D(K(P),{title:"Team Management"}),D(Y,null,{header:V(()=>[e("div",Z,[t[4]||(t[4]=e("h2",{class:"text-xl font-semibold leading-tight text-gray-800"}," Team Management ",-1)),e("button",{onClick:t[0]||(t[0]=d=>N()),class:"rounded-md bg-indigo-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-indigo-500"}," Add Team ")])]),default:V(()=>{var d;return[e("div",ee,[e("div",te,[g.value&&h.value.length===0?(o(),l("div",se,[...t[5]||(t[5]=[e("div",{class:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600"},null,-1)])])):(o(),l("div",ae,[(o(!0),l(m,null,x(h.value,s=>{var b;return o(),l("div",{key:s.id,class:"bg-white shadow rounded-lg overflow-hidden"},[e("div",le,[e("div",oe,[e("div",null,[e("h3",ne,i(s.name),1),s.description?(o(),l("p",ie,i(s.description),1)):p("",!0)]),e("div",de,[e("button",{onClick:n=>q(s),class:"rounded-md bg-green-600 px-3 py-1.5 text-xs font-semibold text-white shadow-sm hover:bg-green-500"}," Manage Members ",8,re),e("button",{onClick:n=>N(s),class:"rounded-md bg-indigo-600 px-3 py-1.5 text-xs font-semibold text-white shadow-sm hover:bg-indigo-500"}," Edit ",8,ce),e("button",{onClick:n=>O(s.id),class:"rounded-md bg-red-600 px-3 py-1.5 text-xs font-semibold text-white shadow-sm hover:bg-red-500"}," Delete ",8,ue)])])]),e("div",me,[s.manager?(o(),l("div",ve,[t[6]||(t[6]=e("span",{class:"font-medium text-gray-700"},"Manager:",-1)),e("span",ge,i(s.manager.name)+" ("+i(s.manager.email)+")",1)])):(o(),l("div",ye,"No manager assigned")),e("div",be,[e("h4",fe,"Team Members ("+i(((b=s.members)==null?void 0:b.length)||0)+")",1),s.members&&s.members.length>0?(o(),l("div",pe,[(o(!0),l(m,null,x(s.members,n=>{var S;return o(),l("div",{key:n.id,class:"flex items-center justify-between text-sm p-2 bg-gray-50 rounded"},[e("div",null,[e("span",xe,i(n.name),1),e("span",he,"("+i(n.email)+")",1)]),e("div",_e,[(S=n.shift_schedule)!=null&&S.length?(o(!0),l(m,{key:0},x(n.shift_schedule,w=>(o(),l("div",{key:`${n.id}-${w.day_of_week}`},i(z(w.day_of_week))+": "+i(w.start_time)+" - "+i(w.end_time),1))),128)):n.shift_start&&n.shift_end?(o(),l(m,{key:1},[A(" Default: "+i(n.shift_start)+" - "+i(n.shift_end),1)],64)):(o(),l(m,{key:2},[A(" Shift not set ")],64))])])}),128))])):(o(),l("p",we,"No members in this team"))])])])}),128)),h.value.length===0?(o(),l("div",ke,[...t[7]||(t[7]=[e("p",null,'No teams created yet. Click "Add Team" to get started.',-1)])])):p("",!0)]))])]),k.value?(o(),l("div",Me,[e("div",Ce,[e("div",{class:"fixed inset-0 transition-opacity bg-gray-500 bg-opacity-75","aria-hidden":"true",onClick:C}),e("div",Te,[e("div",$e,[e("h3",je,i(f.value?"Edit Team":"Add Team"),1),e("form",{onSubmit:Q(L,["prevent"])},[e("div",Ee,[t[8]||(t[8]=e("label",{class:"block text-sm font-medium text-gray-700"},"Team Name",-1)),$(e("input",{"onUpdate:modelValue":t[1]||(t[1]=s=>r.value.name=s),type:"text",required:"",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm"},null,512),[[F,r.value.name]])]),e("div",Ne,[t[9]||(t[9]=e("label",{class:"block text-sm font-medium text-gray-700"},"Description",-1)),$(e("textarea",{"onUpdate:modelValue":t[2]||(t[2]=s=>r.value.description=s),rows:"3",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm"},null,512),[[F,r.value.description]])]),e("div",Se,[t[11]||(t[11]=e("label",{class:"block text-sm font-medium text-gray-700"},"Manager",-1)),$(e("select",{"onUpdate:modelValue":t[3]||(t[3]=s=>r.value.manager_id=s),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm"},[t[10]||(t[10]=e("option",{value:null},"No Manager",-1)),(o(!0),l(m,null,x(j.value,s=>(o(),l("option",{key:s.id,value:s.id},i(s.name)+" ("+i(s.email)+") ",9,De))),128))],512),[[R,r.value.manager_id]])]),e("div",{class:"flex justify-end space-x-3"},[e("button",{type:"button",onClick:C,class:"rounded-md border border-gray-300 px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50"}," Cancel "),t[12]||(t[12]=e("button",{type:"submit",class:"rounded-md bg-indigo-600 px-4 py-2 text-sm font-medium text-white hover:bg-indigo-700"}," Save ",-1))])],32)])])])])):p("",!0),M.value?(o(),l("div",Ve,[e("div",Ae,[e("div",{class:"fixed inset-0 transition-opacity bg-gray-500 bg-opacity-75","aria-hidden":"true",onClick:T}),e("div",Fe,[e("div",Ue,[e("h3",ze," Manage Team Members: "+i((d=y.value)==null?void 0:d.name),1),e("div",Be,[e("div",Ie,[(o(!0),l(m,null,x(E.value,s=>{var b;return o(),l("div",{key:s.id,onClick:n=>G(s.id),class:X(["flex items-center justify-between p-3 rounded cursor-pointer transition",u.value.selectedMembers.includes(s.id)?"bg-indigo-50 border-2 border-indigo-500":"bg-gray-50 border-2 border-transparent hover:bg-gray-100"])},[e("div",null,[e("div",Oe,i(s.name),1),e("div",qe,i(s.email),1),s.team&&s.team.id!==((b=y.value)==null?void 0:b.id)?(o(),l("div",We," Currently in: "+i(s.team.name),1)):p("",!0)]),e("div",Ge,[u.value.selectedMembers.includes(s.id)?(o(),l("div",He,[...t[13]||(t[13]=[e("svg",{class:"w-3 h-3 text-white",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z","clip-rule":"evenodd"})],-1)])])):(o(),l("div",Je))])],10,Le)}),128))])]),e("div",{class:"mt-6 flex justify-end space-x-3"},[e("button",{type:"button",onClick:T,class:"rounded-md border border-gray-300 px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50"}," Cancel "),e("button",{onClick:W,class:"rounded-md bg-indigo-600 px-4 py-2 text-sm font-medium text-white hover:bg-indigo-700"}," Save ")])])])])])):p("",!0)]}),_:1})],64))}});export{Xe as default};
