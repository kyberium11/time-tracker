import{d as et,r,q as st,o as lt,c as d,a as q,u as at,h as ot,w as G,b as e,e as g,f as i,t as o,g as m,j as p,F as C,i as A,v as J,k as U}from"./app-DYc0vyc1.js";import{_ as nt}from"./AuthenticatedLayout.vue_vue_type_script_setup_true_lang-IOgP29JS.js";import{a as _}from"./api-DTwInEyq.js";const dt={class:"py-12"},it={class:"mx-auto max-w-7xl sm:px-6 lg:px-8"},rt={key:0,class:"mb-4 rounded-md bg-green-50 p-4"},ut={class:"flex"},mt={class:"ml-3"},ct={class:"text-sm font-medium text-green-800"},gt={key:1,class:"mb-4 rounded-md bg-red-50 p-4"},pt={class:"flex"},vt={class:"ml-3"},xt={class:"text-sm font-medium text-red-800"},ft={class:"overflow-hidden bg-white shadow sm:rounded-lg"},yt={class:"p-6"},bt={class:"mb-6 grid grid-cols-1 gap-4 md:grid-cols-4"},kt=["value"],wt={class:"overflow-x-auto"},_t={class:"min-w-full divide-y divide-gray-200"},ht={class:"divide-y divide-gray-200 bg-white"},Tt={key:0},Dt={key:1},St={class:"whitespace-nowrap px-6 py-4 text-sm text-gray-900"},Mt={class:"whitespace-nowrap px-6 py-4 text-sm text-gray-900"},Ct={class:"whitespace-nowrap px-6 py-4 text-sm text-gray-900"},Ut={class:"whitespace-nowrap px-6 py-4 text-sm text-gray-900"},Et={class:"whitespace-nowrap px-6 py-4 text-sm text-gray-900"},Yt={class:"whitespace-nowrap px-6 py-4 text-sm text-gray-900"},$t={class:"whitespace-nowrap px-6 py-4 text-sm font-medium text-gray-900"},Ft={class:"whitespace-nowrap px-6 py-4 text-sm font-medium"},Vt=["onClick"],Ht=["onClick"],Nt={key:0,class:"mt-4 flex items-center justify-between"},At={class:"text-sm text-gray-700"},It={class:"flex gap-2"},jt=["disabled"],Lt=["disabled"],Pt={key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50"},Bt={class:"w-full max-w-2xl rounded-lg bg-white p-6 shadow-xl"},Ot={key:0,class:"mb-4 rounded-md bg-red-50 p-4"},zt={class:"text-sm font-medium text-red-800"},qt={key:1,class:"space-y-4"},Gt=["value"],Jt={key:1,class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50"},Kt={class:"w-full max-w-md rounded-lg bg-white p-6 shadow-xl"},Qt={key:0,class:"mb-4 rounded-md bg-red-50 p-4"},Rt={class:"text-sm font-medium text-red-800"},Wt={key:1,class:"mb-4 rounded-md bg-gray-50 p-4"},Xt={class:"text-sm text-gray-700"},le=et({__name:"TimeEntryManagement",setup(Zt){const h=r([]),E=r(!1),a=r(null),Y=r(!1),$=r(!1),c=r(null),u=r(null),v=r(null),F=r(new Date().toISOString().split("T")[0]),V=r(new Date().toISOString().split("T")[0]),T=r(null),k=r([]),H=r([]),x=r(1),D=r(50),S=r(0),f=async()=>{var l,t;E.value=!0,u.value=null;try{const n={page:x.value,per_page:D.value,date_from:F.value,date_to:V.value};T.value&&(n.user_id=T.value);const s=await _.get("/admin/time-entries",{params:n});h.value=s.data.data||[],S.value=s.data.total||0}catch(n){u.value=((t=(l=n.response)==null?void 0:l.data)==null?void 0:t.message)||"Failed to load time entries",h.value=[]}finally{E.value=!1}},K=async()=>{var l;try{const t=await _.get("/admin/users",{params:{per_page:1e3}});(l=t.data)!=null&&l.data?k.value=t.data.data:Array.isArray(t.data)?k.value=t.data:k.value=[]}catch(t){console.error("Failed to load users",t),k.value=[]}},I=async l=>{try{const t={};l&&(t.user_id=l);const n=await _.get("/admin/tasks",{params:t});H.value=n.data||[]}catch(t){console.error("Failed to load tasks",t),H.value=[]}},y=l=>{if(!l)return"";const t=new Date(l),n=t.getFullYear(),s=String(t.getMonth()+1).padStart(2,"0"),w=String(t.getDate()).padStart(2,"0"),M=String(t.getHours()).padStart(2,"0"),N=String(t.getMinutes()).padStart(2,"0"),tt=String(t.getSeconds()).padStart(2,"0");return`${n}-${s}-${w}T${M}:${N}:${tt}`},Q=async l=>{a.value={...l,clock_in:l.clock_in?y(l.clock_in):null,clock_out:l.clock_out?y(l.clock_out):null,break_start:l.break_start?y(l.break_start):null,break_end:l.break_end?y(l.break_end):null,lunch_start:l.lunch_start?y(l.lunch_start):null,lunch_end:l.lunch_end?y(l.lunch_end):null},await I(l.user_id),Y.value=!0},j=()=>{a.value=null,Y.value=!1,u.value=null,v.value=null},b=l=>{if(!l)return null;let t=l;if(!t.includes(":"))return null;const n=t.split("T");return n.length===2&&n[1].split(":").length===2&&(t=`${n[0]}T${n[1]}:00`),new Date(t).toISOString()},R=async()=>{var l,t;if(a.value){u.value=null,v.value=null;try{await _.put(`/admin/time-entries/${a.value.id}`,{date:a.value.date,clock_in:b(a.value.clock_in),clock_out:b(a.value.clock_out),break_start:b(a.value.break_start),break_end:b(a.value.break_end),lunch_start:b(a.value.lunch_start),lunch_end:b(a.value.lunch_end),task_id:a.value.task_id}),v.value="Time entry updated successfully and synced to ClickUp",j(),await f(),setTimeout(()=>{v.value=null},3e3)}catch(n){u.value=((t=(l=n.response)==null?void 0:l.data)==null?void 0:t.message)||"Failed to update time entry"}}},W=l=>{c.value=l,$.value=!0},L=()=>{c.value=null,$.value=!1,u.value=null},X=async()=>{var l,t;if(c.value){u.value=null;try{await _.delete(`/admin/time-entries/${c.value.id}`),v.value="Time entry deleted successfully and synced to ClickUp",L(),await f(),setTimeout(()=>{v.value=null},3e3)}catch(n){u.value=((t=(l=n.response)==null?void 0:l.data)==null?void 0:t.message)||"Failed to delete time entry"}}},P=l=>new Date(l).toLocaleDateString("en-US",{year:"numeric",month:"2-digit",day:"2-digit"}),B=l=>l?new Date(l).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",second:"2-digit"}):"--",O=l=>{if(l==null)return"0.00h";const t=typeof l=="string"?parseFloat(l):l;return isNaN(t)?"0.00h":`${t.toFixed(2)}h`},z=st(()=>Math.ceil(S.value/D.value)),Z=()=>{x.value=1,f()};return lt(()=>{K(),f(),I()}),(l,t)=>(i(),d(C,null,[q(at(ot),{title:"Time Entry Management"}),q(nt,null,{header:G(()=>[...t[13]||(t[13]=[e("h2",{class:"text-xl font-semibold leading-tight text-gray-800"}," Time Entry Management ",-1)])]),default:G(()=>{var n;return[e("div",dt,[e("div",it,[v.value?(i(),d("div",rt,[e("div",ut,[e("div",mt,[e("p",ct,o(v.value),1)])])])):g("",!0),u.value?(i(),d("div",gt,[e("div",pt,[e("div",vt,[e("p",xt,o(u.value),1)])])])):g("",!0),e("div",ft,[e("div",yt,[e("div",bt,[e("div",null,[t[14]||(t[14]=e("label",{class:"block text-sm font-medium text-gray-700"},"Date From",-1)),m(e("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>F.value=s),type:"date",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},null,512),[[p,F.value]])]),e("div",null,[t[15]||(t[15]=e("label",{class:"block text-sm font-medium text-gray-700"},"Date To",-1)),m(e("input",{"onUpdate:modelValue":t[1]||(t[1]=s=>V.value=s),type:"date",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},null,512),[[p,V.value]])]),e("div",null,[t[17]||(t[17]=e("label",{class:"block text-sm font-medium text-gray-700"},"User",-1)),m(e("select",{"onUpdate:modelValue":t[2]||(t[2]=s=>T.value=s),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},[t[16]||(t[16]=e("option",{value:null},"All Users",-1)),(i(!0),d(C,null,A(k.value,s=>(i(),d("option",{key:s.id,value:s.id},o(s.name)+" ("+o(s.email)+") ",9,kt))),128))],512),[[J,T.value]])]),e("div",{class:"flex items-end"},[e("button",{onClick:Z,class:"w-full rounded-md bg-indigo-600 px-4 py-2 text-sm font-medium text-white hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2"}," Apply Filters ")])]),e("div",wt,[e("table",_t,[t[20]||(t[20]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"}," ID "),e("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"}," User "),e("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"}," Date "),e("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"}," Task "),e("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"}," Clock In "),e("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"}," Clock Out "),e("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"}," Total Hours "),e("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"}," Actions ")])],-1)),e("tbody",ht,[E.value?(i(),d("tr",Tt,[...t[18]||(t[18]=[e("td",{colspan:"8",class:"px-6 py-4 text-center"},[e("div",{class:"inline-block h-8 w-8 animate-spin rounded-full border-4 border-solid border-indigo-600 border-r-transparent"})],-1)])])):h.value.length===0?(i(),d("tr",Dt,[...t[19]||(t[19]=[e("td",{colspan:"8",class:"px-6 py-4 text-center text-sm text-gray-500"}," No time entries found ",-1)])])):(i(!0),d(C,{key:2},A(h.value,s=>{var w,M;return i(),d("tr",{key:s.id},[e("td",St,o(s.id),1),e("td",Mt,o(((w=s.user)==null?void 0:w.name)||"N/A"),1),e("td",Ct,o(P(s.date)),1),e("td",Ut,o(((M=s.task)==null?void 0:M.title)||"N/A"),1),e("td",Et,o(B(s.clock_in)),1),e("td",Yt,o(B(s.clock_out)),1),e("td",$t,o(O(s.total_hours)),1),e("td",Ft,[e("button",{onClick:N=>Q(s),class:"mr-2 text-indigo-600 hover:text-indigo-900"}," Edit ",8,Vt),e("button",{onClick:N=>W(s),class:"text-red-600 hover:text-red-900"}," Delete ",8,Ht)])])}),128))])])]),z.value>1?(i(),d("div",Nt,[e("div",At," Showing "+o((x.value-1)*D.value+1)+" to "+o(Math.min(x.value*D.value,S.value))+" of "+o(S.value)+" results ",1),e("div",It,[e("button",{onClick:t[3]||(t[3]=s=>{x.value--,f()}),disabled:x.value===1,class:"rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50 disabled:opacity-50"}," Previous ",8,jt),e("button",{onClick:t[4]||(t[4]=s=>{x.value++,f()}),disabled:x.value>=z.value,class:"rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50 disabled:opacity-50"}," Next ",8,Lt)])])):g("",!0)])])])]),Y.value?(i(),d("div",Pt,[e("div",Bt,[t[32]||(t[32]=e("h3",{class:"mb-4 text-lg font-medium text-gray-900"},"Edit Time Entry",-1)),u.value?(i(),d("div",Ot,[e("p",zt,o(u.value),1)])):g("",!0),a.value?(i(),d("div",qt,[e("div",null,[t[22]||(t[22]=e("label",{class:"block text-sm font-medium text-gray-700"},"Task",-1)),m(e("select",{"onUpdate:modelValue":t[5]||(t[5]=s=>a.value.task_id=s),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},[t[21]||(t[21]=e("option",{value:null},"No Task",-1)),(i(!0),d(C,null,A(H.value,s=>(i(),d("option",{key:s.id,value:s.id},o(s.title)+" "+o(s.user?`(${s.user.name})`:""),9,Gt))),128))],512),[[J,a.value.task_id]])]),e("div",null,[t[23]||(t[23]=e("label",{class:"block text-sm font-medium text-gray-700"},"Date",-1)),m(e("input",{"onUpdate:modelValue":t[6]||(t[6]=s=>a.value.date=s),type:"date",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},null,512),[[p,a.value.date]])]),e("div",null,[t[24]||(t[24]=e("label",{class:"block text-sm font-medium text-gray-700"},"Start Time",-1)),m(e("input",{"onUpdate:modelValue":t[7]||(t[7]=s=>a.value.clock_in=s),type:"text",pattern:"\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}",placeholder:"YYYY-MM-DDTHH:mm:ss",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},null,512),[[p,a.value.clock_in]]),t[25]||(t[25]=e("p",{class:"mt-1 text-xs text-gray-500"},"Format: YYYY-MM-DDTHH:mm:ss (e.g., 2025-11-10T11:26:30)",-1))]),e("div",null,[t[26]||(t[26]=e("label",{class:"block text-sm font-medium text-gray-700"},"End Time",-1)),m(e("input",{"onUpdate:modelValue":t[8]||(t[8]=s=>a.value.clock_out=s),type:"text",pattern:"\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}",placeholder:"YYYY-MM-DDTHH:mm:ss",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},null,512),[[p,a.value.clock_out]]),t[27]||(t[27]=e("p",{class:"mt-1 text-xs text-gray-500"},"Format: YYYY-MM-DDTHH:mm:ss (e.g., 2025-11-10T11:26:30)",-1))]),e("div",null,[t[28]||(t[28]=e("label",{class:"block text-sm font-medium text-gray-700"},"Break Start",-1)),m(e("input",{"onUpdate:modelValue":t[9]||(t[9]=s=>a.value.break_start=s),type:"datetime-local",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},null,512),[[p,a.value.break_start]])]),e("div",null,[t[29]||(t[29]=e("label",{class:"block text-sm font-medium text-gray-700"},"Break End",-1)),m(e("input",{"onUpdate:modelValue":t[10]||(t[10]=s=>a.value.break_end=s),type:"datetime-local",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},null,512),[[p,a.value.break_end]])]),e("div",null,[t[30]||(t[30]=e("label",{class:"block text-sm font-medium text-gray-700"},"Lunch Start",-1)),m(e("input",{"onUpdate:modelValue":t[11]||(t[11]=s=>a.value.lunch_start=s),type:"datetime-local",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},null,512),[[p,a.value.lunch_start]])]),e("div",null,[t[31]||(t[31]=e("label",{class:"block text-sm font-medium text-gray-700"},"Lunch End",-1)),m(e("input",{"onUpdate:modelValue":t[12]||(t[12]=s=>a.value.lunch_end=s),type:"datetime-local",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},null,512),[[p,a.value.lunch_end]])])])):g("",!0),e("div",{class:"mt-6 flex justify-end gap-3"},[e("button",{onClick:j,class:"rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50"}," Cancel "),e("button",{onClick:R,class:"rounded-md bg-indigo-600 px-4 py-2 text-sm font-medium text-white hover:bg-indigo-700"}," Save Changes ")])])])):g("",!0),$.value?(i(),d("div",Jt,[e("div",Kt,[t[40]||(t[40]=e("h3",{class:"mb-4 text-lg font-medium text-gray-900"},"Delete Time Entry",-1)),u.value?(i(),d("div",Qt,[e("p",Rt,o(u.value),1)])):g("",!0),t[41]||(t[41]=e("p",{class:"mb-4 text-sm text-gray-600"}," Are you sure you want to delete this time entry? This action cannot be undone and will sync to ClickUp. ",-1)),c.value?(i(),d("div",Wt,[e("p",Xt,[t[33]||(t[33]=e("strong",null,"ID:",-1)),U(" "+o(c.value.id),1),t[34]||(t[34]=e("br",null,null,-1)),t[35]||(t[35]=e("strong",null,"User:",-1)),U(" "+o(((n=c.value.user)==null?void 0:n.name)||"N/A"),1),t[36]||(t[36]=e("br",null,null,-1)),t[37]||(t[37]=e("strong",null,"Date:",-1)),U(" "+o(P(c.value.date)),1),t[38]||(t[38]=e("br",null,null,-1)),t[39]||(t[39]=e("strong",null,"Total Hours:",-1)),U(" "+o(O(c.value.total_hours)),1)])])):g("",!0),e("div",{class:"flex justify-end gap-3"},[e("button",{onClick:L,class:"rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50"}," Cancel "),e("button",{onClick:X,class:"rounded-md bg-red-600 px-4 py-2 text-sm font-medium text-white hover:bg-red-700"}," Delete ")])])])):g("",!0)]}),_:1})],64))}});export{le as default};
