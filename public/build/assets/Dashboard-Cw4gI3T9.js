import{d as oe,r as m,q as k,o as ne,z as le,c as r,a as Lt,u as ie,h as re,w as Bt,b as e,e as v,f as d,n as M,t as l,k as Ut,g as I,F as C,i as P,v as mt,j as xt}from"./app-CHCQ7s3Q.js";import{_ as de}from"./AuthenticatedLayout.vue_vue_type_script_setup_true_lang-HVYEc7Xh.js";import{a as h}from"./api-igMQufc0.js";const ue={class:"py-12"},ce={class:"mx-auto max-w-7xl sm:px-6 lg:px-8"},me={key:0,class:"border-b border-gray-200 mb-6"},xe={class:"-mb-px flex space-x-8"},pe={key:1},ge={key:0,class:"mb-6 grid gap-4 md:grid-cols-3"},ve={class:"overflow-hidden bg-white shadow sm:rounded-lg"},ye={class:"px-4 py-5 sm:p-6"},fe={class:"mt-2 text-3xl font-bold text-gray-900"},he={class:"text-xs text-gray-500"},ke={class:"mt-4 flex flex-wrap gap-2"},be=["disabled"],_e=["disabled"],we={class:"overflow-hidden bg-white shadow sm:rounded-lg"},Te={class:"px-4 py-5 sm:p-6"},De={key:0,class:"mt-2"},Se={class:"text-2xl font-bold text-gray-900 mt-1"},Me={key:0,class:"text-sm font-normal text-gray-500"},Ce={class:"mt-3"},$e=["disabled"],Ne={key:1,class:"mt-2"},Ee={class:"flex items-center gap-2 w-full"},Le=["value"],Be=["disabled"],Ue={key:0,class:"text-sm text-gray-500 mt-2"},Ie={class:"overflow-hidden bg-white shadow sm:rounded-lg"},Pe={class:"px-4 py-5 sm:p-6"},He={class:"mt-2 text-3xl font-bold text-gray-900"},We={key:1,class:"mb-6 overflow-hidden bg-white shadow sm:rounded-lg"},je={class:"px-4 py-5 sm:p-6"},Ae={class:"flex items-center justify-between mb-4"},Oe=["disabled"],Ve={class:"overflow-x-auto"},Fe={class:"min-w-full divide-y divide-gray-200"},ze={class:"divide-y divide-gray-200 bg-white"},Re={class:"px-4 py-4 text-sm text-gray-900"},qe={class:"px-4 py-4 text-sm text-gray-500"},Ze={class:"px-4 py-4 text-sm text-gray-500"},Ge={class:"px-4 py-4 text-sm text-gray-500"},Je={key:0},Ke={key:2,class:"mb-6 overflow-hidden bg-white shadow sm:rounded-lg"},Qe={class:"px-4 py-5 sm:p-6"},Xe={class:"flex items-center justify-between mb-3"},Ye={class:"flex items-center gap-2"},ts=["value"],es={class:"overflow-x-auto"},ss={class:"min-w-full divide-y divide-gray-200"},as={class:"divide-y divide-gray-200 bg-white"},os={class:"whitespace-nowrap px-6 py-4 text-sm text-indigo-600"},ns=["onClick"],ls={class:"whitespace-nowrap px-6 py-4 text-sm"},is={key:1,class:"text-sm text-gray-700"},rs={class:"whitespace-nowrap px-6 py-4 text-sm text-gray-900"},ds={class:"whitespace-nowrap px-6 py-4 text-sm text-gray-500"},us={class:"whitespace-nowrap px-6 py-4 text-sm"},cs={class:"whitespace-nowrap px-6 py-4 text-sm text-gray-900"},ms={class:"flex items-center space-x-2"},xs=["onClick","disabled","aria-label"],ps={key:0,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",class:"h-4 w-4"},gs={key:1,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",class:"h-4 w-4"},vs=["value","onChange"],ys=["value"],fs={key:0,value:"complete"},hs={key:1,value:"done"},ks={class:"flex items-center justify-between px-6 py-3 text-sm text-gray-600"},bs={class:"space-x-2"},_s=["disabled"],ws=["disabled"],Ts={class:"overflow-hidden bg-white shadow sm:rounded-lg"},Ds={class:"px-4 py-5 sm:p-6"},Ss={key:0,class:"text-center py-8 text-gray-500"},Ms={key:1,class:"overflow-x-auto"},Cs={class:"min-w-full divide-y divide-gray-200"},$s={class:"divide-y divide-gray-200"},Ns={class:"px-4 py-4 text-sm text-gray-900"},Es={class:"px-4 py-4 text-sm text-gray-500"},Ls={class:"px-4 py-4 text-sm text-gray-500"},Bs={class:"px-4 py-4 text-sm text-gray-900 font-semibold"},Us={class:"px-4 py-4 text-sm text-gray-500"},Is={class:"px-4 py-4 text-sm text-gray-500"},Ps={key:2,class:"space-y-6"},Hs={class:"bg-white shadow rounded-lg p-4"},Ws={class:"grid gap-4 sm:grid-cols-2"},js={class:"bg-white shadow rounded-lg p-5"},As={class:"grid gap-4 sm:grid-cols-3 lg:grid-cols-5 text-sm"},Os={class:"font-semibold"},Vs={class:"font-semibold"},Fs={class:"font-semibold"},zs={class:"font-semibold"},Rs={class:"bg-white shadow rounded-lg"},qs={class:"overflow-x-auto"},Zs={class:"min-w-full divide-y divide-gray-200"},Gs={class:"divide-y divide-gray-200"},Js={class:"px-4 py-4 text-sm text-gray-900"},Ks={class:"px-4 py-4 text-sm text-gray-500"},Qs={class:"px-4 py-4 text-sm text-gray-500"},Xs={class:"px-4 py-4 text-sm text-gray-900 font-semibold"},Ys={class:"px-4 py-4 text-sm text-gray-500"},ta={class:"px-4 py-4 text-sm text-gray-500"},ea={key:0},sa={key:0,class:"text-center py-8"},aa={key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50"},oa={class:"w-full max-w-2xl rounded-lg bg-white shadow-lg"},na={class:"flex items-center justify-between border-b px-4 py-3"},la={class:"p-4"},ia={key:0,class:"text-gray-500 text-sm"},ra={key:1,class:"overflow-x-auto"},da={class:"min-w-full divide-y divide-gray-200"},ua={class:"divide-y divide-gray-200 bg-white"},ca={class:"px-4 py-2 text-sm text-gray-900"},ma={class:"px-4 py-2 text-sm text-gray-700"},xa={class:"px-4 py-2 text-sm text-gray-700"},pa={class:"px-4 py-2 text-sm text-gray-700 font-semibold"},ga={class:"px-4 py-2 text-sm text-gray-700"},va={class:"px-4 py-2 text-sm text-gray-700"},ya={key:1,class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50"},fa={class:"w-full max-w-3xl max-h-[90vh] rounded-lg bg-white shadow-lg flex flex-col"},ha={class:"flex items-center justify-between border-b px-4 py-3 flex-shrink-0"},ka={key:0,class:"p-6 text-sm text-gray-700 overflow-y-auto flex-1"},ba={class:"mb-4 pb-4 border-b"},_a={class:"font-semibold text-lg text-gray-900 mb-2"},wa={class:"flex items-center gap-3 flex-wrap"},Ta={key:0,class:"text-sm"},Da={key:1,class:"ml-1 text-gray-700"},Sa={key:1},Ma=["href"],Ca={key:0,class:"task-content"},$a=["innerHTML"],Na={key:1,class:"text-gray-500 italic"},Ia=oe({__name:"Dashboard",setup(Ea){const g=m(null),f=m(!1),A=m(""),O=m(new Date),$=m("employee"),N=m([]),Z=m(null),y=m(null),Q=m(!1),kt=m([]),G=m([]),b=m(null),X=m(!1),V=m("dashboard"),F=m(""),bt=m([]),Y=m(!1),_=m({workSeconds:0,breakSeconds:0,lunchSeconds:0,tasksCount:0,status:"No Entry",overtimeSeconds:0}),w=m([]),pt=m(""),H=m(1),J=m(10),tt=m("all"),et=k(()=>{const s=new Set;return(N.value||[]).forEach(t=>{const o=(t.status||"").toString().trim();o&&s.add(o)}),Array.from(s).sort((t,o)=>t.localeCompare(o))}),st=m("all"),at=m(""),ot=m(""),gt=k(()=>{const s=pt.value.trim().toLowerCase();let t=N.value;if(tt.value!=="all"){const o=tt.value.toLowerCase();t=t.filter(n=>(n.status||"").toLowerCase()===o)}if(st.value!=="all"){const o=st.value;t=t.filter(n=>(n.priority||"none").toLowerCase()===o)}if(at.value){const o=new Date(at.value).getTime();t=t.filter(n=>n.due_date?new Date(n.due_date).getTime()>=o:!1)}if(ot.value){const o=new Date(ot.value).getTime();t=t.filter(n=>n.due_date?new Date(n.due_date).getTime()<=o:!1)}return s?t.filter(o=>(o.title||"").toLowerCase().includes(s)):t}),nt=k(()=>Math.max(1,Math.ceil(gt.value.length/J.value))),It=k(()=>{const t=(Math.min(H.value,nt.value)-1)*J.value;return gt.value.slice(t,t+J.value)}),E=s=>{const t=Math.max(1,Math.min(s,nt.value));H.value=t},lt=m([]),it=m(!1),vt=async()=>{var s;it.value=!0;try{const t=await h.get("/admin/analytics/activity-logs",{params:{limit:100}});lt.value=((s=t.data)==null?void 0:s.data)||[]}catch{lt.value=[]}finally{it.value=!1}};let yt=null;const W=k(()=>{var s,t;return!!((s=g.value)!=null&&s.clock_in)&&!((t=g.value)!=null&&t.clock_out)}),L=k(()=>{var s,t;return!!((s=g.value)!=null&&s.break_start)&&!((t=g.value)!=null&&t.break_end)}),Pt=k(()=>{var s,t;return((s=g.value)==null?void 0:s.lunch_start)&&!((t=g.value)!=null&&t.lunch_end)}),rt=k(()=>{const s=[];if(!g.value)return s;const t=g.value;if(t.clock_in&&t.clock_out){const o=Math.max(0,Math.floor((new Date(t.clock_out).getTime()-new Date(t.clock_in).getTime())/1e3)),n=t.break_start?new Date(t.break_start):null,i=t.break_end?new Date(t.break_end):null;let u=0;n&&i&&(u=Math.max(0,Math.floor((i.getTime()-n.getTime())/1e3)));const x=Math.max(0,o-u);s.push({name:"Work Hours",start:t.clock_in,end:t.clock_out,durationSeconds:x,breakDurationSeconds:u,notes:"-"})}if(t.break_start&&t.break_end){const o=Math.max(0,Math.floor((new Date(t.break_end).getTime()-new Date(t.break_start).getTime())/1e3));s.push({name:"Break",start:t.break_start,end:t.break_end,durationSeconds:o,breakDurationSeconds:o,notes:"-"})}return G.value.forEach(o=>{var n;if(o.clock_in&&o.clock_out){const i=Math.max(0,Math.floor((new Date(o.clock_out).getTime()-new Date(o.clock_in).getTime())/1e3));s.push({name:((n=o.task)==null?void 0:n.title)||`Task #${o.task_id}`,start:o.clock_in,end:o.clock_out,durationSeconds:i,breakDurationSeconds:0,notes:"-"})}}),s.sort((o,n)=>{const i=new Date(o.start).getTime(),u=new Date(n.start).getTime();return(isNaN(u)?0:u)-(isNaN(i)?0:i)}),s});ne(()=>{const s=new Date;F.value=s.toISOString().split("T")[0],K(),Ht(),B(),ht(),yt=window.setInterval(()=>{O.value=new Date},1e3)}),le(()=>{yt&&window.clearInterval(yt)});const K=async()=>{try{const s=await h.get("/time-entries/current");g.value=s.data,Jt()}catch(s){g.value=null,A.value="No entry today",console.error("Error fetching current entry:",s)}},Ht=async()=>{var s;try{const o=(((s=(await h.get("/admin/users")).data)==null?void 0:s.data)||[]).find(n=>(n==null?void 0:n.id)&&(n==null?void 0:n.email));o!=null&&o.role&&($.value=o.role),$.value==="admin"&&(await vt(),setInterval(()=>{vt()},5e3))}catch{}},B=async()=>{try{const s=await h.get("/my/tasks");N.value=s.data}catch{}},Wt=async()=>{var s,t,o;try{const i=((s=(await h.post("/my/clickup/sync-tasks")).data)==null?void 0:s.count)??0;await B(),alert(`Synced ${i} task(s) from ClickUp.`)}catch(n){alert(((o=(t=n==null?void 0:n.response)==null?void 0:t.data)==null?void 0:o.error)||"Failed to sync tasks from ClickUp")}},_t=async()=>{try{await Kt()}catch{}},jt=async()=>{try{await Qt()}catch{}},At=async()=>{try{await Xt()}catch{}},ft=async()=>{try{await Yt()}catch{}},ht=async()=>{try{const s=await h.get("/tasks/today-entries");G.value=s.data||[];const t=(G.value||[]).find(o=>o.clock_in&&!o.clock_out);y.value=t?t.task_id:null}catch{G.value=[]}},wt=async s=>{try{const t=await h.get(`/tasks/${s}/sync`);b.value=t.data,X.value=!0}catch{X.value=!1}},Ot=async()=>{if(L.value){await ft();return}W.value?await jt():await _t()},Vt=async()=>{if(y.value){alert("Pause or stop the running task first.");return}L.value?await ft():(W.value||await _t(),await At())},z=s=>s<10?`0${s}`:`${s}`,Ft=k(()=>{var s,t;return L.value&&((s=g.value)!=null&&s.break_start)?new Date(g.value.break_start):W.value&&((t=g.value)!=null&&t.clock_in)?new Date(g.value.clock_in):null}),zt=k(()=>{const s=G.value.find(t=>t.clock_in&&!t.clock_out);return s?new Date(s.clock_in):null}),Rt=k(()=>{const s=Ft.value;if(!s)return"00:00:00";const t=O.value.getTime()-s.getTime(),o=Math.max(0,Math.floor(t/1e3)),n=Math.floor(o/3600),i=Math.floor(o%3600/60),u=o%60;return`${z(n)}:${z(i)}:${z(u)}`}),qt=k(()=>{const s=zt.value;if(!s)return"00:00:00";const t=O.value.getTime()-s.getTime(),o=Math.max(0,Math.floor(t/1e3)),n=Math.floor(o/3600),i=Math.floor(o%3600/60),u=o%60;return`${z(n)}:${z(i)}:${z(u)}`}),Zt=k(()=>{const s=g.value;if(!s||!s.clock_in)return 0;const t=new Date(s.clock_in),o=s.clock_out?new Date(s.clock_out):O.value;let n=Math.max(0,Math.floor((o.getTime()-t.getTime())/6e4));if(s.break_start&&s.break_end){const i=new Date(s.break_start),u=new Date(s.break_end);n-=Math.max(0,Math.floor((u.getTime()-i.getTime())/6e4))}else if(s.break_start&&!s.break_end){const i=new Date(s.break_start);n-=Math.max(0,Math.floor((O.value.getTime()-i.getTime())/6e4))}if(s.lunch_start&&s.lunch_end){const i=new Date(s.lunch_start),u=new Date(s.lunch_end);n-=Math.max(0,Math.floor((u.getTime()-i.getTime())/6e4))}else if(s.lunch_start&&!s.lunch_end){const i=new Date(s.lunch_start);n-=Math.max(0,Math.floor((O.value.getTime()-i.getTime())/6e4))}return(Math.max(0,n)/60).toFixed(2)}),Gt=async()=>{try{Q.value=!0,kt.value=[g.value].filter(Boolean)}catch{Q.value=!0,kt.value=[]}},Jt=()=>{!g.value||!g.value.clock_in?A.value="Not clocked in":g.value.clock_out?A.value="Clocked out":Pt.value?A.value="On lunch":L.value?A.value="On break":A.value="Clocked in"},Kt=async s=>{var t,o;f.value=!0;try{const n={};await h.post("/time-entries/clock-in",n),await K(),await B()}catch(n){alert(((o=(t=n.response)==null?void 0:t.data)==null?void 0:o.message)||"Error clocking in")}finally{f.value=!1}},Qt=async()=>{var s,t;f.value=!0;try{if(y.value){alert("Pause or stop the running task first."),f.value=!1;return}await h.post("/time-entries/clock-out"),await K(),await B()}catch(o){alert(((t=(s=o.response)==null?void 0:s.data)==null?void 0:t.message)||"Error clocking out")}finally{f.value=!1}},Xt=async()=>{var s,t;f.value=!0;try{await h.post("/time-entries/break-start"),await K(),await B()}catch(o){alert(((t=(s=o.response)==null?void 0:s.data)==null?void 0:t.message)||"Error starting break")}finally{f.value=!1}},Yt=async()=>{var s,t;f.value=!0;try{await h.post("/time-entries/break-end"),await K(),await B()}catch(o){alert(((t=(s=o.response)==null?void 0:s.data)==null?void 0:t.message)||"Error ending break")}finally{f.value=!1}},Tt=async s=>{var t,o;if(!W.value){alert("Please Time In first before starting a task.");return}if(L.value&&await ft(),y.value&&y.value!==s)try{await h.post("/tasks/stop")}catch{}try{await h.post("/tasks/start",{task_id:s}),y.value=s,await ht()}catch(n){alert(((o=(t=n==null?void 0:n.response)==null?void 0:t.data)==null?void 0:o.message)||"Failed to start task")}},Dt=async()=>{try{await h.post("/tasks/stop")}catch{}y.value=null,await ht()},te=async(s,t)=>{var n,i;if(!t)return;if(!confirm(`Are you sure you want to set this task to "${t}"?`)){await B();return}f.value=!0;try{await h.post(`/tasks/${s}/status`,{status:t}),await B()}catch(u){alert(((i=(n=u==null?void 0:u.response)==null?void 0:n.data)==null?void 0:i.message)||"Failed to update task status")}finally{f.value=!1}},St=async()=>{var s,t;if(F.value){Y.value=!0;try{const o=await h.get("/my/time-entries",{params:{start_date:F.value,end_date:F.value}}),n=((s=o.data)==null?void 0:s.entries)||[];bt.value=n,w.value=[];let i=0,u=0,x=null,p=null;n.forEach(a=>{const c=R(a.clock_in),S=R(a.clock_out);c&&(!x||c<x)&&(x=c,p=a.clock_in_formatted||a.clock_in);const U=a.task&&(a.task.title||a.task.name);if(c&&S&&!U){const j=Math.max(0,Math.floor((S.getTime()-c.getTime())/1e3));i+=j;const ut=R(a.break_start),Et=R(a.break_end);let ct=0;ut&&Et&&(ct=Math.max(0,Math.floor((Et.getTime()-ut.getTime())/1e3)),u+=ct);const ae=Math.max(0,j-ct);w.value.push({name:"Work Hours",start:a.clock_in_formatted||a.clock_in,end:a.clock_out_formatted||a.clock_out,durationSeconds:ae,breakDurationSeconds:ct,notes:"-"})}if(U){const j=a.task.title||a.task.name;if(c&&S){const ut=Math.max(0,Math.floor((S.getTime()-c.getTime())/1e3));w.value.push({name:j,start:a.clock_in_formatted||a.clock_in,end:a.clock_out_formatted||a.clock_out,durationSeconds:ut,breakDurationSeconds:0,notes:"-"})}}const dt=R(a.break_start),Nt=R(a.break_end);if(dt&&Nt){const j=Math.max(0,Math.floor((Nt.getTime()-dt.getTime())/1e3));w.value.push({name:"Break",start:a.break_start_formatted||a.break_start,end:a.break_end_formatted||a.break_end,durationSeconds:j,breakDurationSeconds:j,notes:"-"})}}),w.value.sort((a,c)=>{const S=new Date(a.start).getTime(),U=new Date(c.start).getTime();return(isNaN(U)?0:U)-(isNaN(S)?0:S)});const D=w.value.filter(a=>a.name==="Work Hours").reduce((a,c)=>a+(c.durationSeconds||0),0);if((t=o.data)!=null&&t.daily_totals)_.value={workSeconds:D,breakSeconds:o.data.daily_totals.break_seconds||0,lunchSeconds:o.data.daily_totals.lunch_seconds||0,tasksCount:o.data.daily_totals.tasks_count||0,status:o.data.daily_totals.status||"No Entry",overtimeSeconds:o.data.daily_totals.overtime_seconds||0};else{const c=Math.max(0,D-28800);let S="No Entry";if(x){const U=(x.getUTCHours()+8)%24,dt=x.getUTCMinutes();S=U<8||U===8&&dt<=30?"Perfect":"Late"}_.value={workSeconds:D,breakSeconds:u,lunchSeconds:0,tasksCount:w.value.length,status:S,overtimeSeconds:c}}}catch(o){console.error("Error loading time entries",o),bt.value=[],w.value=[],_.value={workSeconds:0,breakSeconds:0,lunchSeconds:0,tasksCount:0,status:"No Entry",overtimeSeconds:0}}finally{Y.value=!1}}},R=s=>{if(!s)return null;const t=s.match(/^(\d{4})-(\d{2})-(\d{2})[ T](\d{2}):(\d{2})(?::(\d{2}))?/);if(t){const i=Number(t[1]),u=Number(t[2])-1,x=Number(t[3]),p=Number(t[4]),D=Number(t[5]),a=Number(t[6]||"0");return new Date(Date.UTC(i,u,x,p-8,D,a))}const o=s.includes("T")?s:s.replace(" ","T"),n=new Date(o);return isNaN(n.getTime())?null:n},q=s=>{if(!s)return"--";try{const o=new Date(s);if(!isNaN(o.getTime()))return o.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!0,timeZone:"Asia/Manila"})}catch{}const t=s.match(/\b(\d{1,2}):(\d{2})(?::(\d{2}))?/);if(t){let o=parseInt(t[1],10);const n=t[2],i=o>=12?"PM":"AM";return o=o%12,o===0&&(o=12),`${o}:${n} ${i}`}return"--"},T=s=>{const t=typeof s=="number"&&isFinite(s)?Math.max(0,Math.floor(s)):0,o=Math.floor(t/3600),n=Math.floor(t%3600/60),i=t%60,u=x=>x<10?`0${x}`:`${x}`;return`${u(o)}:${u(n)}:${u(i)}`},Mt=s=>{if(!s||s===0)return"--";const t=Math.floor(s/1e3);return T(t)},Ct=s=>{if(!s)return"";const t=s.toLowerCase().trim();return t==="to do"||t==="todo"?"text-gray-700":t.includes("complete")||t.includes("done")||t.includes("finished")?"bg-green-100 text-green-800":t.includes("progress")||t.includes("doing")||t.includes("in progress")||t.includes("working")?"bg-blue-100 text-blue-800":t.includes("pending")||t.includes("waiting")?"bg-yellow-100 text-yellow-800":t.includes("blocked")||t.includes("stuck")?"bg-red-100 text-red-800":t.includes("review")||t.includes("testing")?"bg-purple-100 text-purple-800":t.includes("cancel")||t.includes("closed")?"bg-gray-100 text-gray-800":"bg-indigo-100 text-indigo-800"},ee=s=>{if(!s)return"bg-gray-100 text-gray-800";const t=s.toLowerCase().trim();return t==="urgent"||t==="critical"?"bg-red-100 text-red-800":t==="high"?"bg-orange-100 text-orange-800":t==="normal"||t==="medium"?"bg-yellow-100 text-yellow-800":t==="low"?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"},$t=s=>{if(!s)return!1;const t=s.toLowerCase().trim();return t!=="to do"&&t!=="todo"},se=s=>{if(!s)return"";const t=s.split(`
`),o=[];let n=!1,i=[];for(let x=0;x<t.length;x++){const p=t[x].trim();if(!p){n&&i.length>0&&(o.push(`<ul class="list-disc ml-6 mb-3 space-y-1">${i.join("")}</ul>`),i=[],n=!1),o.length>0&&!o[o.length-1].startsWith("<")&&o.push('</p><p class="mb-2">');continue}if(p.match(/^#{1,3}\s+/)){n&&i.length>0&&(o.push(`<ul class="list-disc ml-6 mb-3 space-y-1">${i.join("")}</ul>`),i=[],n=!1),p.startsWith("###")?o.push(`<h3 class="font-semibold text-gray-900 mt-4 mb-2 text-base">${p.replace(/^###\s+/,"")}</h3>`):p.startsWith("##")?o.push(`<h2 class="font-bold text-gray-900 mt-5 mb-3 text-lg">${p.replace(/^##\s+/,"")}</h2>`):p.startsWith("#")&&o.push(`<h1 class="font-bold text-gray-900 mt-6 mb-4 text-xl">${p.replace(/^#\s+/,"")}</h1>`);continue}if(p.match(/^[\-\*â€¢]\s+/)){n||(n=!0);const a=p.replace(/^[\-\*â€¢]\s+/,"").trim();i.push(`<li class="mb-1">${a}</li>`);continue}if(p.match(/^\d+\.\s+/)){n||(n=!0);const a=p.replace(/^\d+\.\s+/,"").trim();i.push(`<li class="mb-1 list-decimal">${a}</li>`);continue}n&&i.length>0&&(o.push(`<ul class="list-disc ml-6 mb-3 space-y-1">${i.join("")}</ul>`),i=[],n=!1);let D=p.replace(/\*\*(.+?)\*\*/g,'<strong class="font-semibold">$1</strong>').replace(/\*(.+?)\*/g,'<em class="italic">$1</em>');o.push(D)}n&&i.length>0&&o.push(`<ul class="list-disc ml-6 mb-3 space-y-1">${i.join("")}</ul>`);let u=o.join("<br>");return u.startsWith("<")||(u='<p class="mb-2">'+u),u.endsWith(">")||(u=u+"</p>"),u};return(s,t)=>(d(),r(C,null,[Lt(ie(re),{title:"Dashboard"}),Lt(de,null,{header:Bt(()=>[...t[23]||(t[23]=[e("h2",{class:"text-xl font-semibold leading-tight text-gray-800"}," Time Tracker Dashboard ",-1)])]),default:Bt(()=>{var o,n,i,u,x,p,D;return[e("div",ue,[e("div",ce,[$.value!=="admin"?(d(),r("div",me,[e("nav",xe,[e("button",{onClick:t[0]||(t[0]=a=>V.value="dashboard"),class:M(["whitespace-nowrap border-b-2 py-4 px-1 text-sm font-medium",V.value==="dashboard"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700"])}," Dashboard ",2),e("button",{onClick:t[1]||(t[1]=a=>{V.value="time-entries",St()}),class:M(["whitespace-nowrap border-b-2 py-4 px-1 text-sm font-medium",V.value==="time-entries"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700"])}," Time Entries ",2)])])):v("",!0),V.value==="dashboard"||$.value==="admin"?(d(),r("div",pe,[$.value!=="admin"?(d(),r("div",ge,[e("div",ve,[e("div",ye,[t[24]||(t[24]=e("h3",{class:"text-xs font-semibold uppercase tracking-wide text-gray-500"},"Work Day Timer",-1)),e("p",fe,l(Rt.value),1),e("p",he,l(L.value?"On Break":W.value?"Working":"Idle"),1),e("div",ke,[e("button",{onClick:Ot,disabled:f.value,class:M(["rounded-md px-3 py-1.5 text-xs font-semibold text-white",W.value?"bg-red-600 hover:bg-red-700":"bg-green-600 hover:bg-green-700"])},l(W.value?"Time Out":"Time In"),11,be),e("button",{onClick:Vt,disabled:f.value,class:M(["rounded-md px-3 py-1.5 text-xs font-semibold text-white",L.value?"bg-orange-600 hover:bg-orange-700":"bg-yellow-600 hover:bg-yellow-700"])},l(L.value?"Break Out":"Break In"),11,_e)])])]),e("div",we,[e("div",Te,[t[26]||(t[26]=e("h3",{class:"text-xs font-semibold uppercase tracking-wide text-gray-500"},"Running Task",-1)),y.value?(d(),r("div",De,[e("button",{onClick:t[2]||(t[2]=a=>wt(y.value)),class:"text-indigo-600 hover:underline text-sm"},l(((o=N.value.find(a=>a.id===y.value))==null?void 0:o.title)||"#"+y.value),1),e("p",Se,[Ut(l(qt.value),1),(n=N.value.find(a=>a.id===y.value))!=null&&n.estimated_time?(d(),r("span",Me," / "+l(Mt((i=N.value.find(a=>a.id===y.value))==null?void 0:i.estimated_time)),1)):v("",!0)]),e("div",Ce,[e("button",{onClick:t[3]||(t[3]=a=>Dt()),disabled:f.value,class:"rounded-md bg-yellow-600 px-3 py-1.5 text-xs font-semibold text-white hover:bg-yellow-700"},"Pause",8,$e)])])):(d(),r("div",Ne,[e("div",Ee,[I(e("select",{"onUpdate:modelValue":t[4]||(t[4]=a=>Z.value=a),class:"w-full rounded-md border-gray-300 text-sm shadow-sm"},[t[25]||(t[25]=e("option",{value:null},"Select a task",-1)),(d(!0),r(C,null,P(N.value,a=>(d(),r("option",{key:a.id,value:a.id},l(a.title),9,Le))),128))],512),[[mt,Z.value]]),e("button",{onClick:t[5]||(t[5]=a=>Z.value?Tt(Z.value):void 0),disabled:f.value||!Z.value,class:"rounded-md bg-green-600 px-3 py-1.5 text-xs font-semibold text-white hover:bg-green-700 disabled:opacity-50"},"Start",8,Be)]),N.value.length?v("",!0):(d(),r("p",Ue,"No tasks available."))]))])]),e("div",Ie,[e("div",Pe,[t[28]||(t[28]=e("h3",{class:"text-xs font-semibold uppercase tracking-wide text-gray-500"},"Daily Logs",-1)),e("p",He,[Ut(l(Zt.value),1),t[27]||(t[27]=e("span",{class:"text-sm font-normal text-gray-500"}," / 8 Hours",-1))]),e("div",{class:"mt-4 flex space-x-2"},[e("button",{onClick:Gt,class:"rounded-md bg-indigo-600 px-3 py-1.5 text-xs font-semibold text-white hover:bg-indigo-700"},"Daily Logs")])])])])):v("",!0),$.value==="admin"?(d(),r("div",We,[e("div",je,[e("div",Ae,[t[29]||(t[29]=e("h3",{class:"text-lg font-medium leading-6 text-gray-900"},"Real-Time Activity Log",-1)),e("button",{onClick:vt,disabled:it.value,class:"rounded-md bg-indigo-600 px-3 py-1.5 text-xs font-semibold text-white hover:bg-indigo-500"},"Refresh",8,Oe)]),e("div",Ve,[e("table",Fe,[t[31]||(t[31]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"User"),e("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Action"),e("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Description"),e("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Time")])],-1)),e("tbody",ze,[(d(!0),r(C,null,P(lt.value,a=>{var c;return d(),r("tr",{key:a.id},[e("td",Re,l(((c=a.user)==null?void 0:c.name)||"Unknown"),1),e("td",qe,l(a.action),1),e("td",Ze,l(a.description),1),e("td",Ge,l(new Date(a.created_at).toLocaleString()),1)])}),128)),lt.value.length===0&&!it.value?(d(),r("tr",Je,[...t[30]||(t[30]=[e("td",{colspan:"4",class:"px-4 py-4 text-center text-sm text-gray-500"},"No activity logs found",-1)])])):v("",!0)])])])])])):v("",!0),$.value!=="admin"?(d(),r("div",Ke,[e("div",Qe,[e("div",Xe,[t[35]||(t[35]=e("h3",{class:"text-lg font-medium leading-6 text-gray-900"},"My Tasks",-1)),e("div",Ye,[e("button",{onClick:Wt,class:"rounded-md bg-green-600 px-3 py-1.5 text-xs font-semibold text-white hover:bg-green-700"},"Refresh from ClickUp"),I(e("input",{"onUpdate:modelValue":t[6]||(t[6]=a=>pt.value=a),onInput:t[7]||(t[7]=a=>E(1)),type:"text",placeholder:"Search tasks",class:"rounded-md border-gray-300 text-sm shadow-sm"},null,544),[[xt,pt.value]]),I(e("select",{"onUpdate:modelValue":t[8]||(t[8]=a=>tt.value=a),onChange:t[9]||(t[9]=a=>E(1)),class:"rounded-md border-gray-300 text-sm shadow-sm"},[t[32]||(t[32]=e("option",{value:"all"},"All",-1)),(d(!0),r(C,null,P(et.value,a=>(d(),r("option",{key:a,value:a},l(a),9,ts))),128))],544),[[mt,tt.value]]),I(e("select",{"onUpdate:modelValue":t[10]||(t[10]=a=>st.value=a),onChange:t[11]||(t[11]=a=>E(1)),class:"rounded-md border-gray-300 text-sm shadow-sm"},[...t[33]||(t[33]=[e("option",{value:"all"},"All priorities",-1),e("option",{value:"urgent"},"Urgent",-1),e("option",{value:"high"},"High",-1),e("option",{value:"normal"},"Normal",-1),e("option",{value:"low"},"Low",-1),e("option",{value:"none"},"None",-1)])],544),[[mt,st.value]]),I(e("input",{"onUpdate:modelValue":t[12]||(t[12]=a=>at.value=a),onChange:t[13]||(t[13]=a=>E(1)),type:"date",class:"rounded-md border-gray-300 text-sm shadow-sm"},null,544),[[xt,at.value]]),I(e("input",{"onUpdate:modelValue":t[14]||(t[14]=a=>ot.value=a),onChange:t[15]||(t[15]=a=>E(1)),type:"date",class:"rounded-md border-gray-300 text-sm shadow-sm"},null,544),[[xt,ot.value]]),I(e("select",{"onUpdate:modelValue":t[16]||(t[16]=a=>J.value=a),onChange:t[17]||(t[17]=a=>E(1)),class:"rounded-md border-gray-300 text-sm shadow-sm"},[...t[34]||(t[34]=[e("option",{value:5},"5",-1),e("option",{value:10},"10",-1),e("option",{value:20},"20",-1),e("option",{value:50},"50",-1)])],544),[[mt,J.value,void 0,{number:!0}]])])]),e("div",es,[e("table",ss,[t[39]||(t[39]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Task"),e("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Status"),e("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Due Date"),e("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Estimated Time"),e("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Priority"),e("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Actions")])],-1)),e("tbody",as,[(d(!0),r(C,null,P(It.value,a=>(d(),r("tr",{key:a.id},[e("td",os,[e("button",{onClick:c=>wt(a.id),class:"hover:underline"},l(a.title),9,ns)]),e("td",ls,[$t(a.status)?(d(),r("span",{key:0,class:M(["inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-semibold",Ct(a.status)])},l(a.status||"â€”"),3)):(d(),r("span",is,l(a.status||"â€”"),1))]),e("td",rs,l(a.due_date?new Date(a.due_date).toLocaleDateString():"--"),1),e("td",ds,l(Mt(a.estimated_time)),1),e("td",us,[e("span",{class:M(["inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-semibold",ee(a.priority||null)])},l(a.priority||"None"),3)]),e("td",cs,[e("div",ms,[e("button",{onClick:c=>y.value===a.id?Dt():Tt(a.id),disabled:f.value,class:M(["rounded-full p-2 text-white",y.value===a.id?"bg-yellow-600 hover:bg-yellow-700":"bg-green-600 hover:bg-green-700"]),"aria-label":y.value===a.id?"Pause":"Play"},[y.value!==a.id?(d(),r("svg",ps,[...t[36]||(t[36]=[e("path",{d:"M8 5v14l11-7z"},null,-1)])])):(d(),r("svg",gs,[...t[37]||(t[37]=[e("path",{d:"M6 5h4v14H6zM14 5h4v14h-4z"},null,-1)])]))],10,xs),e("select",{value:a.status||"",onChange:c=>te(a.id,c.target.value),class:"rounded-md border-gray-300 text-xs shadow-sm"},[t[38]||(t[38]=e("option",{disabled:"",value:""},"Set statusâ€¦",-1)),(d(!0),r(C,null,P(et.value,c=>(d(),r("option",{key:c+a.id,value:c},l(c),9,ys))),128)),et.value.includes("complete")?v("",!0):(d(),r("option",fs,"complete")),et.value.includes("done")?v("",!0):(d(),r("option",hs,"done"))],40,vs)])])]))),128))])]),e("div",ks,[e("div",null," Page "+l(H.value)+" of "+l(nt.value)+" â€¢ "+l(gt.value.length)+" total ",1),e("div",bs,[e("button",{onClick:t[18]||(t[18]=a=>E(H.value-1)),disabled:H.value<=1,class:"rounded-md border px-3 py-1 disabled:opacity-50"},"Prev",8,_s),e("button",{onClick:t[19]||(t[19]=a=>E(H.value+1)),disabled:H.value>=nt.value,class:"rounded-md border px-3 py-1 disabled:opacity-50"},"Next",8,ws)])])])])])):v("",!0),e("div",Ts,[e("div",Ds,[t[41]||(t[41]=e("h3",{class:"text-lg font-medium leading-6 text-gray-900 mb-4"},"Today's Time Events",-1)),rt.value.length===0?(d(),r("div",Ss," No time entries recorded today. Clock in to start tracking time. ")):(d(),r("div",Ms,[e("table",Cs,[t[40]||(t[40]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Task"),e("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Start Time"),e("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"End Time"),e("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Duration"),e("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Break Duration"),e("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Notes")])],-1)),e("tbody",$s,[(d(!0),r(C,null,P(rt.value,(a,c)=>(d(),r("tr",{key:c},[e("td",Ns,l(a.name),1),e("td",Es,l(q(a.start)),1),e("td",Ls,l(q(a.end)),1),e("td",Bs,l(T(a.durationSeconds)),1),e("td",Us,l(T(a.breakDurationSeconds||0)),1),e("td",Is,l(a.notes||"-"),1)]))),128))])])]))])])])):v("",!0),V.value==="time-entries"&&$.value!=="admin"?(d(),r("div",Ps,[e("div",Hs,[e("div",Ws,[e("div",null,[t[42]||(t[42]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Date",-1)),I(e("input",{"onUpdate:modelValue":t[20]||(t[20]=a=>F.value=a),onChange:St,type:"date",class:"w-full rounded-md border-gray-300 shadow-sm"},null,544),[[xt,F.value]])])])]),e("div",js,[t[48]||(t[48]=e("h3",{class:"text-lg font-medium leading-6 text-gray-900 mb-4"},"Daily Summary",-1)),e("div",As,[e("div",null,[t[43]||(t[43]=e("div",{class:"text-gray-500"},"ðŸ•’ Time In Hours",-1)),e("div",Os,l(T(_.value.workSeconds)),1)]),e("div",null,[t[44]||(t[44]=e("div",{class:"text-gray-500"},"â˜• Total Breaks",-1)),e("div",Vs,l(T(_.value.breakSeconds)),1)]),e("div",null,[t[45]||(t[45]=e("div",{class:"text-gray-500"},"ðŸ“‹ Entries",-1)),e("div",Fs,l(_.value.tasksCount),1)]),e("div",null,[t[46]||(t[46]=e("div",{class:"text-gray-500"},"â° Status",-1)),e("div",{class:M(["font-semibold",{"text-green-700":_.value.status==="Perfect","text-yellow-700":_.value.status==="Late","text-gray-700":_.value.status==="No Entry"}])},l(_.value.status),3)]),e("div",null,[t[47]||(t[47]=e("div",{class:"text-gray-500"},"âš¡ Overtime",-1)),e("div",zs,l(T(_.value.overtimeSeconds)),1)])])]),e("div",Rs,[e("div",qs,[e("table",Zs,[t[50]||(t[50]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Task"),e("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Start Time"),e("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"End Time"),e("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Duration"),e("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Break Duration"),e("th",{class:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Notes")])],-1)),e("tbody",Gs,[(d(!0),r(C,null,P(w.value,(a,c)=>(d(),r("tr",{key:c},[e("td",Js,l(a.name),1),e("td",Ks,l(q(a.start)),1),e("td",Qs,l(q(a.end)),1),e("td",Xs,l(T(a.durationSeconds)),1),e("td",Ys,l(T(a.breakDurationSeconds||0)),1),e("td",ta,l(a.notes||"-"),1)]))),128)),w.value.length===0&&!Y.value?(d(),r("tr",ea,[...t[49]||(t[49]=[e("td",{colspan:"6",class:"px-4 py-4 text-center text-sm text-gray-500"},"No entries for selected day",-1)])])):v("",!0)])])]),Y.value?(d(),r("div",sa,[...t[51]||(t[51]=[e("div",{class:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600"},null,-1),e("p",{class:"mt-2 text-sm text-gray-500"},"Loading...",-1)])])):v("",!0)])])):v("",!0)]),Q.value?(d(),r("div",aa,[e("div",oa,[e("div",na,[t[52]||(t[52]=e("h4",{class:"text-md font-semibold"},"Daily Logs",-1)),e("button",{onClick:t[21]||(t[21]=a=>Q.value=!1),class:"rounded-md bg-gray-100 px-2 py-1 text-xs"},"Close")]),e("div",la,[rt.value.length===0?(d(),r("div",ia,"No entry today.")):(d(),r("div",ra,[e("table",da,[t[53]||(t[53]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-4 py-2 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Task"),e("th",{class:"px-4 py-2 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Start Time"),e("th",{class:"px-4 py-2 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"End Time"),e("th",{class:"px-4 py-2 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Duration"),e("th",{class:"px-4 py-2 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Break Duration"),e("th",{class:"px-4 py-2 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Notes")])],-1)),e("tbody",ua,[(d(!0),r(C,null,P(rt.value,(a,c)=>(d(),r("tr",{key:c},[e("td",ca,l(a.name),1),e("td",ma,l(q(a.start)),1),e("td",xa,l(q(a.end)),1),e("td",pa,l(T(a.durationSeconds)),1),e("td",ga,l(T(a.breakDurationSeconds||0)),1),e("td",va,l(a.notes||"-"),1)]))),128))])])]))])])])):v("",!0),X.value?(d(),r("div",ya,[e("div",fa,[e("div",ha,[t[54]||(t[54]=e("h4",{class:"text-md font-semibold"},"Task Details",-1)),e("button",{onClick:t[22]||(t[22]=a=>X.value=!1),class:"rounded-md bg-gray-100 px-2 py-1 text-xs hover:bg-gray-200"},"Close")]),b.value?(d(),r("div",ka,[e("div",ba,[e("h2",_a,l((u=b.value.task)==null?void 0:u.title),1),e("div",wa,[(x=b.value.task)!=null&&x.status?(d(),r("span",Ta,[t[55]||(t[55]=e("span",{class:"text-gray-600"},"Status:",-1)),$t(b.value.task.status)?(d(),r("span",{key:0,class:M(["inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-semibold ml-1",Ct(b.value.task.status)])},l(b.value.task.status),3)):(d(),r("span",Da,l(b.value.task.status),1))])):v("",!0),(p=b.value.clickup)!=null&&p.url?(d(),r("span",Sa,[e("a",{href:b.value.clickup.url,target:"_blank",class:"text-indigo-600 hover:underline text-sm font-medium"},"Open in ClickUp â†’",8,Ma)])):v("",!0)])]),(D=b.value.clickup)!=null&&D.text_content?(d(),r("div",Ca,[e("div",{innerHTML:se(b.value.clickup.text_content),class:"prose prose-sm max-w-none"},null,8,$a)])):(d(),r("div",Na," No additional details available. "))])):v("",!0)])])):v("",!0)])]}),_:1})],64))}});export{Ia as default};
